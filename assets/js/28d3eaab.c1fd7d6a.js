"use strict";(self.webpackChunknotebook=self.webpackChunknotebook||[]).push([[6889],{4117:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>o,contentTitle:()=>c,default:()=>j,frontMatter:()=>r,metadata:()=>d,toc:()=>h});var i=s(4848),l=s(8453);const r={sidebar_label:"11. Docker"},c="Docker",d={id:"bjpowernode/\u5fae\u670d\u52a1\u7ed3\u6784/Docker",title:"Docker",description:"1 \u6982\u8ff0",source:"@site/docs/bjpowernode/06-\u5fae\u670d\u52a1\u7ed3\u6784/11-Docker.md",sourceDirName:"bjpowernode/06-\u5fae\u670d\u52a1\u7ed3\u6784",slug:"/bjpowernode/\u5fae\u670d\u52a1\u7ed3\u6784/Docker",permalink:"/ZHENGnotes/bjpowernode/\u5fae\u670d\u52a1\u7ed3\u6784/Docker",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:11,frontMatter:{sidebar_label:"11. Docker"},sidebar:"defaultSidebar",previous:{title:"10. RocketMQ",permalink:"/ZHENGnotes/bjpowernode/\u5fae\u670d\u52a1\u7ed3\u6784/RocketMQ"},next:{title:"12. Kubernetes_k8s",permalink:"/ZHENGnotes/bjpowernode/\u5fae\u670d\u52a1\u7ed3\u6784/Kubernetes_k8s"}},o={},h=[{value:"1 \u6982\u8ff0",id:"1-\u6982\u8ff0",level:2},{value:"2 Docker\u5f15\u64ce",id:"2-docker\u5f15\u64ce",level:2},{value:"2.1 \u7248\u672c\u53d1\u5c55\u5386\u7a0b",id:"21-\u7248\u672c\u53d1\u5c55\u5386\u7a0b",level:3},{value:"2.2 \u6982\u8ff0",id:"22-\u6982\u8ff0",level:3},{value:"2.3 \u5b89\u88c5",id:"23-\u5b89\u88c5",level:3},{value:"2.4 \u5378\u8f7d",id:"24-\u5378\u8f7d",level:3},{value:"3 Docker\u955c\u50cf",id:"3-docker\u955c\u50cf",level:2},{value:"3.1 \u6982\u8ff0",id:"31-\u6982\u8ff0",level:3},{value:"3.2 \u547d\u4ee4",id:"32-\u547d\u4ee4",level:3},{value:"3.3 \u955c\u50cf\u5206\u5c42",id:"33-\u955c\u50cf\u5206\u5c42",level:3},{value:"3.4 \u955c\u50cf\u6458\u8981",id:"34-\u955c\u50cf\u6458\u8981",level:3},{value:"3.5 \u591a\u67b6\u6784\u955c\u50cf",id:"35-\u591a\u67b6\u6784\u955c\u50cf",level:3},{value:"4 Docker\u5bb9\u5668",id:"4-docker\u5bb9\u5668",level:2},{value:"4.1 \u6982\u8ff0",id:"41-\u6982\u8ff0",level:3},{value:"4.2 \u547d\u4ee4",id:"42-\u547d\u4ee4",level:3},{value:"5 Dockerfile",id:"5-dockerfile",level:2},{value:"5.1 \u6982\u8ff0",id:"51-\u6982\u8ff0",level:3},{value:"5.2 \u6307\u4ee4",id:"52-\u6307\u4ee4",level:3},{value:"5.3 \u5b9e\u9645\u5e94\u7528",id:"53-\u5b9e\u9645\u5e94\u7528",level:3},{value:"5.4 build cache",id:"54-build-cache",level:3},{value:"6 \u6570\u636e\u6301\u4e45\u5316",id:"6-\u6570\u636e\u6301\u4e45\u5316",level:2},{value:"6.1 \u5b9a\u5236\u955c\u50cf\u6301\u4e45\u5316",id:"61-\u5b9a\u5236\u955c\u50cf\u6301\u4e45\u5316",level:3},{value:"6.2 \u6570\u636e\u5377\u6301\u4e45\u5316",id:"62-\u6570\u636e\u5377\u6301\u4e45\u5316",level:3},{value:"6.3 Dockerfile\u6301\u4e45\u5316",id:"63-dockerfile\u6301\u4e45\u5316",level:3},{value:"7 Docker\u7f51\u7edc",id:"7-docker\u7f51\u7edc",level:2},{value:"7.1 \u6982\u8ff0",id:"71-\u6982\u8ff0",level:3},{value:"7.2 \u7f51\u7edc\u7c7b\u578b",id:"72-\u7f51\u7edc\u7c7b\u578b",level:3},{value:"8 \u5e38\u7528\u670d\u52a1\u5668\u5b89\u88c5",id:"8-\u5e38\u7528\u670d\u52a1\u5668\u5b89\u88c5",level:2},{value:"8.1 MySQL\u5b89\u88c5",id:"81-mysql\u5b89\u88c5",level:3},{value:"8.2 Redis\u5b89\u88c5",id:"82-redis\u5b89\u88c5",level:3},{value:"9 Docker Compose",id:"9-docker-compose",level:2},{value:"9.1 \u6982\u8ff0",id:"91-\u6982\u8ff0",level:3},{value:"9.2 \u547d\u4ee4",id:"92-\u547d\u4ee4",level:3},{value:"10 Docker\u7ba1\u7406\u76d1\u63a7\u5e73\u53f0",id:"10-docker\u7ba1\u7406\u76d1\u63a7\u5e73\u53f0",level:2},{value:"10.1 \u6982\u8ff0",id:"101-\u6982\u8ff0",level:3},{value:"11 \u955c\u50cf\u4e2d\u5fc3",id:"11-\u955c\u50cf\u4e2d\u5fc3",level:2},{value:"11.1 \u6982\u8ff0",id:"111-\u6982\u8ff0",level:3},{value:"11.2 HTTPS",id:"112-https",level:3},{value:"11.3 distribution\u79c1\u6709\u955c\u50cf\u4e2d\u5fc3",id:"113-distribution\u79c1\u6709\u955c\u50cf\u4e2d\u5fc3",level:3},{value:"11.4 registry\u79c1\u6709\u955c\u50cf\u4e2d\u5fc3",id:"114-registry\u79c1\u6709\u955c\u50cf\u4e2d\u5fc3",level:3},{value:"11.4.1 HTTP",id:"1141-http",level:4},{value:"11.4.2 HTTPS",id:"1142-https",level:4},{value:"11.5 harbor\u79c1\u6709\u955c\u50cf\u4e2d\u5fc3",id:"115-harbor\u79c1\u6709\u955c\u50cf\u4e2d\u5fc3",level:3},{value:"11.5.1 \u6982\u8ff0",id:"1151-\u6982\u8ff0",level:4},{value:"11.5.2 HTTP",id:"1152-http",level:4},{value:"11.5.3 HTTPS",id:"1153-https",level:4},{value:"12 Docker Swarm",id:"12-docker-swarm",level:2},{value:"12.1 \u6982\u8ff0",id:"121-\u6982\u8ff0",level:3},{value:"12.2 \u64cd\u4f5cSwarm\u96c6\u7fa4",id:"122-\u64cd\u4f5cswarm\u96c6\u7fa4",level:3},{value:"12.3 service",id:"123-service",level:3},{value:"12.4 overlay\u7f51\u7edc",id:"124-overlay\u7f51\u7edc",level:3},{value:"13 CI/CD\u4e0eJenkins",id:"13-cicd\u4e0ejenkins",level:2},{value:"13.1 \u6982\u8ff0",id:"131-\u6982\u8ff0",level:3},{value:"13.2 \u5e94\u7528\u5b9e\u73b0",id:"132-\u5e94\u7528\u5b9e\u73b0",level:3}];function x(n){const e={a:"a",admonition:"admonition",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",hr:"hr",img:"img",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.h1,{id:"docker",children:"Docker"}),"\n",(0,i.jsx)(e.h2,{id:"1-\u6982\u8ff0",children:"1 \u6982\u8ff0"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:(0,i.jsx)("font",{color:"red",children:"Docker"})}),"\uff1a\u5f00\u6e90\u7684\u5e94\u7528\u5bb9\u5668\u5f15\u64ce\uff0c\u53ef\u5c06\u5e94\u7528\u53ca\u5176\u8fd0\u884c\u73af\u5883\u6253\u5305\u5230\u8f7b\u91cf\u7ea7\u3001\u53ef\u79fb\u690d\u7684\u955c\u50cf\u4e2d\uff0c\u53d1\u5e03\u5230\u4efb\u4f55\u6d41\u884c\u7684Linux\u3001Windows\u673a\u5668\u4e0a"]}),"\n",(0,i.jsxs)(e.li,{children:["Docker\u7684\u7528\u9014\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"\u63d0\u4f9b\u7edf\u4e00\u7684\u8fd0\u884c\u73af\u5883\uff1a\u786e\u4fdd\u5728\u4efb\u4f55\u5bbf\u4e3b\u673a\u4e0a\u90fd\u8f93\u51fa\u76f8\u540c\u7684\u7ed3\u679c"}),"\n",(0,i.jsx)(e.li,{children:"\u4fbf\u6377\u7684\u5e94\u7528\u8fc1\u79fb\uff1a\u65e0\u9700\u62c5\u5fc3\u8fd0\u884c\u73af\u5883\u7684\u53d8\u5316\u5bfc\u81f4\u5e94\u7528\u65e0\u6cd5\u6b63\u5e38\u8fd0\u884c"}),"\n",(0,i.jsx)(e.li,{children:"\u8d85\u5feb\u7684\u542f\u52a8\u65f6\u95f4\uff1a\u7531\u4e8e\u76f4\u63a5\u8fd0\u884c\u5728\u5bbf\u4e3b\u673a\u7cfb\u7edf\u4e2d\uff0c\u65e0\u9700\u542f\u52a8\u64cd\u4f5c\u7cfb\u7edf"}),"\n",(0,i.jsx)(e.li,{children:"\u66f4\u8f7b\u677e\u7684\u7ef4\u62a4\u548c\u6269\u5c55\uff1a\u5b58\u5728\u9ad8\u8d28\u91cf\u7684\u5b98\u65b9\u955c\u50cf\uff0c\u65e2\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\uff0c\u53c8\u53ef\u4ee5\u4f5c\u4e3a\u57fa\u7840\u955c\u50cf\u8fdb\u4e00\u6b65\u5b9a\u5236"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u5bb9\u5668\u4e0e\u865a\u62df\u673a\u7684\u533a\u522b\uff1a",(0,i.jsx)(e.img,{alt:"Different System",src:s(2151).A+"",width:"1538",height:"574"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"\u5bbf\u4e3b\u673a\u7cfb\u7edf\uff1a\u5e94\u7528\u7a0b\u5e8f\u662f\u4e00\u4e2a\u5bf9\u8ba1\u7b97\u673a\u786c\u4ef6\u8d44\u6e90\u8c03\u5ea6\u4f7f\u7528\u7684\u6307\u4ee4\u5e8f\u5217"}),"\n",(0,i.jsx)(e.li,{children:"\u865a\u62df\u673a\u7cfb\u7edf\uff1a\u82e5\u4e24\u4e2a\u76f8\u540c\u7684\u5e94\u7528\u8fd0\u884c\u5728\u4e24\u53f0\u865a\u62df\u673a\u4e0a\u65f6\uff0c\u9700\u8981\u4e24\u5957\u76f8\u540c\u7684\u8d44\u6e90 \u2192 \u9020\u6210\u8d44\u6e90\u6d6a\u8d39"}),"\n",(0,i.jsx)(e.li,{children:"\u5bb9\u5668\uff1a\u5171\u4eab\u5bbf\u4e3b\u673a\u7684\u64cd\u4f5c\u7cfb\u7edf\u548c\u786c\u4ef6\uff0c\u4e14\u5bf9\u7cfb\u7edf\u8d44\u6e90\u7684\u4f7f\u7528\u7edf\u4e00\u7531Docker\u5f15\u64ce\u8fdb\u884c\u7ba1\u7406"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["Windows\u7cfb\u7edf\uff1a",(0,i.jsx)(e.img,{alt:"Windows",src:s(2205).A+"",width:"419",height:"328"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"Hypervisor"})," /\u865a\u62df\u673a\u76d1\u89c6\u5668VMM\uff08Virtual Machine Monitor\uff09\uff1a\u4e00\u79cd\u8fd0\u884c\u5728\u57fa\u7840\u7269\u7406\u670d\u52a1\u5668\u548c\u64cd\u4f5c\u7cfb\u7edf\u4e4b\u95f4\u7684\u4e2d\u95f4\u8f6f\u4ef6\u5c42\uff0c\u5141\u8bb8\u591a\u4e2a\u64cd\u4f5c\u7cfb\u7edf\u548c\u5e94\u7528\u5171\u4eab\u786c\u4ef6","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"Hyper-V"}),"\uff1aWindows\u7cfb\u7edf\u7684 ",(0,i.jsx)(e.code,{children:"Hypervisor"})]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"KVM"})," \u548c ",(0,i.jsx)(e.code,{children:"Xen"}),"\uff1aLinux\u7cfb\u7edf\u7684 ",(0,i.jsx)(e.code,{children:"Hypervisor"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u542f\u52a8\u8fc7\u7a0b\uff1a","\n",(0,i.jsx)(e.mermaid,{value:"graph TB\n\u5f00\u542f\u7269\u7406\u673a\u7684\u540c\u65f6\u542f\u52a8Hyper-V\u670d\u52a1 --\x3e Hyper-V\u83b7\u53d6\u5230\u4e3b\u673a\u4e2d\u7684\u5168\u90e8\u7269\u7406\u8d44\u6e90\u7684\u63a7\u5236\u6743 --\x3e \u64cd\u4f5c\u7cfb\u7edf\u865a\u62df\u673a\u5f00\u59cb\u542f\u52a8 --\x3e \u5e94\u7528\u5c42\u865a\u62df\u673a\u5f00\u59cb\u542f\u52a8 --\x3e Hyper-V\u6839\u636e\u865a\u62df\u673a\u7684\u914d\u7f6e\u5bf9\u7269\u7406\u8d44\u6e90\u865a\u62df\u5316 --\x3e Hyper-V\u5c06\u5bf9\u5e94\u7684\u865a\u62df\u5316\u8d44\u6e90\u6253\u5305\u5206\u914d\u7ed9\u865a\u62df\u673a --\x3e \u64cd\u4f5c\u7cfb\u7edf\u865a\u62df\u673a\u4e0e\u5e94\u7528\u5c42\u865a\u62df\u673a\u542f\u52a8\u5b8c\u6bd5 --\x3e Windows\u7cfb\u7edf\u542f\u52a8\u5b8c\u6bd5"}),"\n"]}),"\n",(0,i.jsx)(e.li,{children:"VMware\u4f7f\u752815.5.5\u53ca\u4ee5\u4e0a\u7684\u7248\u672c\uff0cWindows\u4f7f\u752810\u53ca\u4ee5\u4e0a\u7684\u7248\u672c\uff0c\u5426\u5219\u4f1a\u51fa\u73b0VMware\u548cHyper-V\u4e0d\u517c\u5bb9\u7684\u95ee\u9898\uff08VMware\u4f5c\u4e3a\u5e94\u7528\uff0c\u65e0\u6cd5\u76f4\u63a5\u8bbf\u95eeCPU\u786c\u4ef6\u865a\u62df\u5316\u529f\u80fd\uff09"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["Docker\u7684\u7cfb\u7edf\u67b6\u6784\uff1a",(0,i.jsx)(e.img,{alt:"Docker Structure",src:s(4068).A+"",width:"1233",height:"651"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u5b88\u62a4\u8fdb\u7a0b ",(0,i.jsx)(e.code,{children:"Daemon"}),"\uff1a\u76d1\u542cDocker\u7684API\u8bf7\u6c42\u5e76\u7ba1\u7406Docker\u5bf9\u8c61\uff08\u955c\u50cf\u3001\u5bb9\u5668\u3001\u7f51\u7edc\u3001\u6570\u636e\u5377\u7b49\uff09"]}),"\n",(0,i.jsxs)(e.li,{children:["\u955c\u50cf ",(0,i.jsx)(e.code,{children:"Image"}),"\uff1a\u7528\u4e8e\u521b\u5efaDocker\u5bb9\u5668\u7684 ",(0,i.jsx)(e.strong,{children:"\u6a21\u677f"})]}),"\n",(0,i.jsxs)(e.li,{children:["\u5bb9\u5668 ",(0,i.jsx)(e.code,{children:"Container"}),"\uff1a\u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2a\u5e94\u7528\u7a0b\u5e8f\uff0c\u4e14\u4e0e\u5176\u5b83\u5bb9\u5668\u4e4b\u95f4\u76f8\u4e92\u9694\u79bb"]}),"\n",(0,i.jsxs)(e.li,{children:["\u4ed3\u5e93 ",(0,i.jsx)(e.code,{children:"Repository"}),"\uff1a\u4fdd\u5b58\u4e00\u7ec4\u5177\u6709\u76f8\u540c\u540d\u79f0\u7684\u955c\u50cf\uff0c\u4e14\u8be5\u540d\u79f0\u4e0e\u4ed3\u5e93\u540d\u79f0\u76f8\u540c"]}),"\n",(0,i.jsxs)(e.li,{children:["\u6807\u7b7e ",(0,i.jsx)(e.code,{children:"Tag"}),"\uff1a\u955c\u50cf\u7684\u4e00\u79cd\u6807\u8bc6\uff0c\u901a\u8fc7 ",(0,i.jsx)(e.code,{children:"<repository>:<tag>"})," \u6765\u5b9a\u4f4d"]}),"\n",(0,i.jsxs)(e.li,{children:["\u955c\u50cf\u4e2d\u5fc3 ",(0,i.jsx)(e.code,{children:"Registry"}),"\uff1a\u5b58\u653e\u7740\u7531\u5b98\u65b9\u3001\u673a\u6784\u6216\u4e2a\u4eba\u521b\u5efa\u7684Docker\u4ed3\u5e93"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"2-docker\u5f15\u64ce",children:"2 Docker\u5f15\u64ce"}),"\n",(0,i.jsx)(e.h3,{id:"21-\u7248\u672c\u53d1\u5c55\u5386\u7a0b",children:"2.1 \u7248\u672c\u53d1\u5c55\u5386\u7a0b"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u53d1\u5c55\u5386\u7a0b\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u9996\u53d1\u7248\u672c\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"\u7531LXC\uff08Linux Container\uff09\u548cDocker Daemon\u7ec4\u6210"}),"\n",(0,i.jsxs)(e.li,{children:["\u5b58\u5728\u7684\u95ee\u9898\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"\u4f9d\u8d56\u4e8eLXC"}),"\n",(0,i.jsx)(e.li,{children:"\u7248\u672c\u66f4\u65b0\u96be\uff0c\u53ef\u6269\u5c55\u6027\u67e5"}),"\n",(0,i.jsx)(e.li,{children:"\u8fd0\u884c\u6162\uff0c\u5b58\u5728\u6027\u80fd\u95ee\u9898"}),"\n",(0,i.jsx)(e.li,{children:"Docker Daemon\u8fd0\u884c\u51fa\u73b0\u95ee\u9898\uff0c\u76f4\u63a5\u5f71\u54cd\u5bb9\u5668\u7684\u8fd0\u884c"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.li,{children:"0.9\u7248\u672c\uff1a\u7528\u81ea\u7814\u7684Libcontainer\u5de5\u5177\u66ff\u6362LXC"}),"\n",(0,i.jsx)(e.li,{children:"1.1\u7248\u672c\uff1a\u9075\u5faaOCI\u89c4\u8303\uff0c\u5c06\u5bb9\u5668\u8fd0\u884c\u65f6\u4ee3\u7801\u72ec\u7acb\u51fa\u6765"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u7248\u672c\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u5927\u7248\u672c\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"Moby"}),"\n",(0,i.jsx)(e.li,{children:"\u793e\u533a\u7248Docker-CE\uff08Community Edition\uff09"}),"\n",(0,i.jsx)(e.li,{children:"\u4f01\u4e1a\u7248Docker-EE\uff08Enterprise Edition\uff09"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u5c0f\u7248\u672c\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"Edge\u6708\u7248\uff1a\u4e00\u4e2a\u6708\u53d1\u5e03\u4e00\u6b21\uff0c\u7ef4\u62a4\u671f\u4e3a\u4e00\u4e2a\u6708"}),"\n",(0,i.jsx)(e.li,{children:"Stable\u5b63\u7248\uff1a\u4e00\u4e2a\u5b63\u5ea6\u53d1\u5e03\u4e00\u6b21\uff0c\u7ef4\u62a4\u671f\u4e3a\u56db\u4e2a\u6708"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"22-\u6982\u8ff0",children:"2.2 \u6982\u8ff0"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:(0,i.jsx)("font",{color:"red",children:"Docker\u5f15\u64ce"})}),"\uff1a\u7528\u6765\u8fd0\u884c\u548c\u7ba1\u7406\u5bb9\u5668\u7684\u6838\u5fc3\u8f6f\u4ef6"]}),"\n",(0,i.jsxs)(e.li,{children:["\u67b6\u6784\uff1a",(0,i.jsx)(e.img,{alt:"Docker Engine Structure",src:s(4387).A+"",width:"698",height:"702"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u5ba2\u6237\u7aef ",(0,i.jsx)(e.code,{children:"Client"}),"\uff1a\u7528\u6237\u5411Docker\u63d0\u4ea4\u547d\u4ee4\u8bf7\u6c42"]}),"\n",(0,i.jsxs)(e.li,{children:["Docker\u5b88\u62a4\u8fdb\u7a0b ",(0,i.jsx)(e.code,{children:"Dockerd"}),"\uff1a\u955c\u50cf\u6784\u5efa\u3001\u955c\u50cf\u7ba1\u7406\u3001REST API\u3001\u6838\u5fc3\u7f51\u7edc\u3001\u7f16\u6392\u7b49\uff0c\u901a\u8fc7gRPC\u4e0e ",(0,i.jsx)(e.code,{children:"Containerd"})," \u901a\u4fe1"]}),"\n",(0,i.jsxs)(e.li,{children:["Contain\u5b88\u62a4\u8fdb\u7a0b ",(0,i.jsx)(e.code,{children:"Containerd"}),"\uff1a\u7ba1\u7406\u5bb9\u5668\u7684\u751f\u547d\u5468\u671f\uff0cfork\u51fa ",(0,i.jsx)(e.code,{children:"Runc"})," \u8fdb\u7a0b\uff08\u521b\u5efa\u5bb9\u5668\uff09\u548c ",(0,i.jsx)(e.code,{children:"Shim"})," \u8fdb\u7a0b\uff08\u5bb9\u5668\u7684\u7236\u8fdb\u7a0b\uff09"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"Runc"}),"\uff08Run Container\uff09/OCI\uff08\u5f00\u653e\u5bb9\u5668\u5021\u8bae\u57fa\u91d1\u4f1a\uff09\u5c42\uff1afork\u5e76\u542f\u52a8\u5bb9\u5668\u5b50\u8fdb\u7a0b\uff0c\u5bb9\u5668\u5b50\u8fdb\u7a0b\u542f\u52a8\u5b8c\u6bd5\u540e ",(0,i.jsx)(e.code,{children:"Runc"})," \u8fdb\u7a0b\u81ea\u52a8\u9000\u51fa"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"Shim"}),"\uff1a\u4f5c\u4e3a\u5bb9\u5668\u8fdb\u7a0b\u7684\u65b0\u7236\u8fdb\u7a0b\uff0c\u5b9e\u73b0Daemonless Container\uff08\u65e0Docker Daemon\u548cContainer Daemon\u5bb9\u5668\uff09\uff0c\u4f7f\u5f97Runc\u548cDockerd\u89e3\u8026","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"\u4fdd\u6301\u6240\u6709STDIN\u548cSTDOUT\u6d41\u7684\u5f00\u542f\u72b6\u6001\uff08\u5f53Docker Daemon\u91cd\u542f\u65f6\uff0c\u5bb9\u5668\u4e0d\u4f1a\u56e0\u4e3aPipe\u7684\u5173\u95ed\u800c\u7ec8\u6b62\uff09"}),"\n",(0,i.jsx)(e.li,{children:"\u5c06\u5bb9\u5668\u7684\u9000\u51fa\u72b6\u6001\u53cd\u9988\u7ed9Docker Daemon"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"23-\u5b89\u88c5",children:"2.3 \u5b89\u88c5"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u5b98\u65b9\u6587\u6863\uff1a",(0,i.jsx)(e.a,{href:"https://docs.docker.com/engine/install/centos/#installation-methods",children:"Install Docker Engine on CentOS - Installation methods"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["Docker\u4ed3\u5e93\u7684\u56fd\u5185\u955c\u50cf\u6e90\uff1a",(0,i.jsx)(e.code,{children:"https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u5e38\u7528\u547d\u4ee4\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker version"}),"\uff1a\u67e5\u770bDocker\u7248\u672c \u2192 \u9a8c\u8bc1\u662f\u5426\u5b89\u88c5\u6210\u529f"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"systemctl start docker"}),"\uff1a\u542f\u52a8Docker"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker run <image-name>"}),"\uff1a\u8fd0\u884c\u955c\u50cf","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"\u67e5\u627e\u672c\u5730\u955c\u50cf\uff08\u82e5\u672c\u5730\u4e0d\u5b58\u5728\uff0c\u5219\u4ece\u4ed3\u5e93\u62c9\u53d6\uff09"}),"\n",(0,i.jsx)(e.li,{children:"\u8fd0\u884c\u955c\u50cf"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"systemctl restart docker"}),"\uff1a\u91cd\u542fDocker"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"systemctl stop docker"}),"\uff1a\u505c\u6b62Docker"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"systemctl status docker"}),"\uff1a\u67e5\u770bDocker\u72b6\u6001"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"systemctl enable docker"}),"\uff1a\u5f00\u673a\u81ea\u542f\u52a8Docker"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u914d\u7f6e\u56fd\u5185\u955c\u50cf\u4e2d\u5fc3\uff1a","\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",metastring:"showLineNumbers",children:'# \u521b\u5efaDocker\u6587\u4ef6\u5939\nsudo mkdir -p /etc/docker\n\n# \u5728daemon.json\u4e2d\u52a0\u4e0a\u963f\u91cc\u4e91\u955c\u50cf\u4e2d\u5fc3\u7684\u5730\u5740\nsudo tee /etc/docker/daemon.json <<-\'EOF\'\n{\n"registry-mirrors": ["https://fj48qfx2.mirror.aliyuncs.com"]\n}\nEOF\n\n# \u91cd\u65b0\u52a0\u8f7d\u670d\u52a1\u6587\u4ef6\nsudo systemctl daemon-reload\n\n# \u91cd\u542fDocker\nsudo systemctl restart docker\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"24-\u5378\u8f7d",children:"2.4 \u5378\u8f7d"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u5b98\u65b9\u6587\u6863\uff1a",(0,i.jsx)(e.a,{href:"https://docs.docker.com/engine/install/centos/#uninstall-docker-engine",children:"Install Docker Engine on CentOS - Uninstall Docker Engine"})]}),"\n",(0,i.jsx)(e.li,{children:"\u624b\u52a8\u5220\u9664\u81ea\u5b9a\u4e49\u7684\u914d\u7f6e\u6587\u4ef6"}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"3-docker\u955c\u50cf",children:"3 Docker\u955c\u50cf"}),"\n",(0,i.jsx)(e.h3,{id:"31-\u6982\u8ff0",children:"3.1 \u6982\u8ff0"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:(0,i.jsx)("font",{color:"red",children:"\u955c\u50cf"})}),"\uff1a\u8f7b\u91cf\u7ea7\u3001\u53ef\u6267\u884c\u7684\u72ec\u7acb\u8f6f\u4ef6\u5305\uff0c\u5305\u542b\u8fd0\u884c\u8f6f\u4ef6\u9700\u8981\u7684\u6240\u6709\u5185\u5bb9\uff08\u4ee3\u7801\u3001\u5e93\u3001\u73af\u5883\u53d8\u91cf\u3001\u914d\u7f6e\u6587\u4ef6\u7b49\uff09"]}),"\n",(0,i.jsxs)(e.li,{children:["\u955c\u50cf\u4ed3\u5e93\u7684\u5206\u7c7b\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"Docker Official Image"}),"\uff1aDocker\u5b98\u65b9\u955c\u50cf\u4ed3\u5e93"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"Verified Publisher"}),"\uff1a\u5df2\u9a8c\u8bc1\u53d1\u5e03\u8005\u7684\u955c\u50cf\u4ed3\u5e93"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"Sponsored OSS"}),"\uff1a\u7531Docker\u516c\u53f8\u8d5e\u52a9\u5f00\u53d1\u7684\u955c\u50cf\u4ed3\u5e93"]}),"\n",(0,i.jsx)(e.li,{children:"\u65e0\u8ba4\u8bc1\u6807\u8bc6"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u955c\u50cf\u5b9a\u4f4d\u6807\u8bc6\uff1a",(0,i.jsx)(e.code,{children:"<repository>:<tag>"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"<repository>"}),"\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"<software-name>"}),"\uff1a\u5b98\u65b9\u7684\u955c\u50cf\u540d\u79f0"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"<username>/<software-name>"}),"\uff1a\uff1a\u5df2\u9a8c\u8bc1\u53d1\u5e03\u8005\u7684\u955c\u50cf\u540d\u79f0"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"<domain-name>/<username>/<software-name>"}),"\uff1a\u7b2c\u4e09\u65b9\u955c\u50cf\u4e2d\u5fc3\uff08IP\u6216\u57df\u540d\uff09\u7684\u955c\u50cf\u540d\u79f0"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"<tag>"}),"\uff1a\u9ed8\u8ba4\u4e3a\u6700\u65b0\u7248\u672c ",(0,i.jsx)(e.code,{children:"latest"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"32-\u547d\u4ee4",children:"3.2 \u547d\u4ee4"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker pull"}),"\uff1a\u5c06\u6307\u5b9a\u955c\u50cf\u4eceDockerhub\u62c9\u53d6\u5230\u672c\u5730","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"-q"}),"\uff1a\u7b80\u5316\u62c9\u53d6\u8fc7\u7a0b\u4e2d\u7684\u65e5\u5fd7\u8f93\u51fa"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker pull <repository>@<digest>"}),"\uff1a\u901a\u8fc7\u955c\u50cf\u7684 ",(0,i.jsx)(e.code,{children:"digest"}),"\uff08\u955c\u50cf\u5185\u5bb9\u7684Hash\u503c\uff09\u62c9\u53d6\u5230\u672c\u5730"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker images"}),"\uff1a\u67e5\u770b\u672c\u5730\u6240\u6709\u955c\u50cf\u8d44\u6e90\u4fe1\u606f","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"--no-trunc"}),"\uff1a\u663e\u793a\u5b8c\u6574\u7684\u955c\u50cfID"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"--digests"}),"\uff1a\u663e\u793adigest\u4fe1\u606f"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"-q"}),"\uff1a\u4ec5\u663e\u793a\u955c\u50cfID"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"-f"}),"\uff1a\u8fc7\u6ee4\u4e0d\u7b26\u5408\u6307\u5b9a\u6761\u4ef6\u7684\u955c\u50cf"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker search"}),"\uff1a\u4eceDockerhub\u4e0a\u67e5\u770b\u955c\u50cf","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"AUTOMATED"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u81ea\u52a8\u5316\u955c\u50cf"}),"\uff0c\u8ba9Dockerhub\u8fde\u63a5\u4e00\u4e2a\u5305\u542b ",(0,i.jsx)(e.code,{children:"Dockerfile"})," \u6587\u4ef6\u7684\u6e90\u7801\u6258\u7ba1\u5e73\u53f0\uff0c\u4f1a\u81ea\u52a8\u6784\u5efa\u955c\u50cf","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"Dockerfile"})," \u6587\u4ef6\uff1a\u4e13\u95e8\u6784\u5efa\u955c\u50cf\u7684\u6587\u4ef6"]}),"\n",(0,i.jsxs)(e.li,{children:["\u53d7\u4fe1\u6784\u5efa\uff08Trusted Build\uff09\uff1a\u6839\u636e ",(0,i.jsx)(e.code,{children:"Dockerfile"})," \u6587\u4ef6\u5185\u5bb9\u81ea\u52a8\u6784\u5efa\u955c\u50cf"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"--filter"}),"\uff1a\u8fc7\u6ee4\u67e5\u8be2\u7ed3\u679c"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"--limit"}),"\uff1a\u6307\u5b9a\u663e\u793a\u7684\u7ed3\u679c\u6570\u91cf"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker rmi"}),"\uff08remove images\uff09\uff1a\u5220\u9664\u672c\u5730\u955c\u50cf","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u7a7a\u683c\u5206\u9694\uff1a\u4e00\u6b21\u5220\u9664\u591a\u4e2a\u955c\u50cf"}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"-f"}),"\uff1a\u5f3a\u5236\u5220\u9664\u955c\u50cf\uff08\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8fd0\u884c\u4e86\u5bb9\u5668\u7684\u955c\u50cf\u4e0d\u80fd\u88ab\u5220\u9664\uff09"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"$(docker images -q)"}),"\uff1a\u5f15\u7528\u547d\u4ee4\u83b7\u53d6\u955c\u50cfID\uff0c\u901a\u8fc7\u955c\u50cfID\u5220\u9664\u955c\u50cf"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker save"}),"\uff1a\u5c06\u4e00\u4e2a\u6216\u591a\u4e2a\u955c\u50cf\u5bfc\u51fa\u4e3a ",(0,i.jsx)(e.code,{children:".tar"})," \u6587\u4ef6"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker load"}),"\uff1a\u5c06 ",(0,i.jsx)(e.code,{children:".tar"})," \u6587\u4ef6\u5bfc\u5165\u5e76\u52a0\u8f7d\u4e3a\u4e00\u4e2a\u6216\u591a\u4e2a\u955c\u50cf"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker inspect"}),"\uff1a\u67e5\u770b\u955c\u50cf\u7684\u76f8\u5173\u5c5e\u6027"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"33-\u955c\u50cf\u5206\u5c42",children:"3.3 \u955c\u50cf\u5206\u5c42"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u5206\u5c42\uff1a\u955c\u50cf\u4e2d\u677e\u8026\u5408\u7684\u53ea\u8bfb\u955c\u50cf\u5c42\uff0c\u7531Docker Daemon\u5806\u53e0\u800c\u6210","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u5206\u5c42 ",(0,i.jsx)(e.strong,{children:"\u53ea\u8bfb"}),"\uff0c\u5bf9\u5206\u5c42\u7684\u4fee\u6539\u4ee5\u65b0\u5206\u5c42\u7684\u5f62\u5f0f\u51fa\u73b0"]}),"\n",(0,i.jsxs)(e.li,{children:["\u5728\u4e0d\u540c\u955c\u50cf\u95f4\u5b9e\u73b0 ",(0,i.jsx)(e.strong,{children:"\u8d44\u6e90\u5171\u4eab"}),"\uff0c\u5373\u4e0d\u540c\u955c\u50cf\u5bf9\u76f8\u540c\u4e0b\u5c42\u955c\u50cf\u7684\u590d\u7528"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"Image Layer",src:s(7810).A+"",width:"969",height:"368"})}),"\n",(0,i.jsxs)(e.ol,{start:"2",children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u955c\u50cf\u5c42"}),"\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u955c\u50cf\u6587\u4ef6\u7cfb\u7edfFS\uff1a\u5bf9\u955c\u50cf\u5360\u6709\u7684\u78c1\u76d8\u7a7a\u95f4\u8fdb\u884c\u7ba1\u7406\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u5305\u542b\u6570\u636e\u5185\u5bb9","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u57fa\u7840\u955c\u50cf\u5c42\uff1a\u5176\u6587\u4ef6\u7cfb\u7edf\u4e3a\u6839\u6587\u4ef6\u7cfb\u7edf ",(0,i.jsx)(e.code,{children:"rootfs"}),"\uff08\u5efa\u7acb\u5728\u5f15\u5bfc\u6587\u4ef6\u7cfb\u7edf ",(0,i.jsx)(e.code,{children:"bootfs"})," \u4e4b\u4e0a\uff09"]}),"\n",(0,i.jsxs)(e.li,{children:["\u6269\u5c55\u955c\u50cf\u5c42\uff1a\u5bf9\u57fa\u7840\u955c\u50cf\u5c42\u7684\u6269\u5c55\uff1b\u5728 ",(0,i.jsx)(e.code,{children:"Dockerfile"})," \u6587\u4ef6\u4e2d\u7684\u6bcf\u4e00\u6761\u6307\u4ee4\u90fd\u4f1a\u751f\u6210\u4e00\u4e2a\u6269\u5c55\u955c\u50cf\u5c42"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.li,{children:"\u955c\u50cfjson\u6587\u4ef6\uff1a\u63cf\u8ff0\u955c\u50cf\u7684\u76f8\u5173\u5c5e\u6027\u7684\u96c6\u5408"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u5bb9\u5668\u5c42"}),"/\u8054\u5408\u6587\u4ef6\u7cfb\u7edfUnion File System\uff1a\u53ef\u8bfb\u5199\uff0c\u5bf9\u6587\u4ef6\u7684\u4efb\u4f55\u4fee\u6539\u90fd ",(0,i.jsx)(e.strong,{children:"\u53ea\u5b58\u5728\u4e8e\u5bb9\u5668\u5c42"})]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"34-\u955c\u50cf\u6458\u8981",children:"3.4 \u955c\u50cf\u6458\u8981"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"\u6458\u8981Digest\uff1a\u5373\u5185\u5bb9\u6563\u5217Content Hash\uff0c\u53ea\u8981\u5185\u5bb9\u53d1\u751f\u4e86\u53d8\u66f4\uff0c\u6458\u8981\u503c\u4e00\u5b9a\u4f1a\u53d8\u66f4"}),"\n",(0,i.jsx)(e.li,{children:"\u7b97\u6cd5\uff1aSHA256\uff0c\u957f\u5ea6\u4e3a256\u4f4d\u7684\u4e8c\u8fdb\u5236\u5b57\u7b26\u4e32 = \u957f\u5ea6\u4e3a64\u4f4d\u768416\u8fdb\u5236\u5b57\u7b26\u4e32"}),"\n",(0,i.jsxs)(e.li,{children:["\u4e3b\u8981\u4f5c\u7528\uff1a\u533a\u5206\u76f8\u540c ",(0,i.jsx)(e.code,{children:"<repository>:<tag>"})," \u7684\u4e0d\u540c\u955c\u50cf\uff08\u7248\u672c\u76f8\u540c\uff0c\u4f46\u5185\u5bb9\u4e0d\u540c\uff09"]}),"\n",(0,i.jsxs)(e.li,{children:["\u5206\u53d1\u6563\u5217\u503cDistribution Hash\uff1a","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u53d1\u9001\u65b9\uff1a\u7531\u4e8epush\u6216pull\u955c\u50cf\u65f6\uff0c\u7f51\u7edc\u4f1a\u5bf9\u955c\u50cf\u8fdb\u884c\u538b\u7f29\uff0c\u538b\u7f29\u540eDocker\u7acb\u5373\u8ba1\u7b97\u5206\u53d1\u6563\u5217\u503c"}),"\n",(0,i.jsx)(e.li,{children:"\u63a5\u6536\u65b9\uff1a\u63a5\u6536\u540e\u7acb\u5373\u8ba1\u7b97\u5206\u53d1\u6563\u5217\u503c"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"35-\u591a\u67b6\u6784\u955c\u50cf",children:"3.5 \u591a\u67b6\u6784\u955c\u50cf"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u591a\u67b6\u6784\u955c\u50cfMulti-architecture Image\uff1a\u76f8\u540c ",(0,i.jsx)(e.code,{children:"<repository>:<tag>"})," \u7684\u955c\u50cf\u9002\u7528\u4e8e\u4e0d\u540c\u64cd\u4f5c\u7cfb\u7edf/\u7cfb\u7edf\u67b6\u6784"]}),"\n",(0,i.jsxs)(e.li,{children:["\u539f\u7406\uff1a\u901a\u8fc7 ",(0,i.jsx)(e.code,{children:"docker pull"})," \u547d\u4ee4\u62c9\u53d6\u5230\u7684\u662f\u4e0e\u5f53\u524d\u64cd\u4f5c\u7cfb\u7edf/\u7cfb\u7edf\u67b6\u6784\u76f8\u5339\u914d\u7684\u955c\u50cf","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u955c\u50cf\u7684\u591a\u67b6\u6784\u4fe1\u606f\u4fdd\u5b58\u5728 ",(0,i.jsx)(e.code,{children:"Manifest"})," \u6587\u4ef6\u4e2d"]}),"\n",(0,i.jsxs)(e.li,{children:["\u5b8c\u6574\u5750\u6807\u5b9a\u4f4d ",(0,i.jsx)(e.code,{children:"<os/arch>:<repository>:<tag>"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"4-docker\u5bb9\u5668",children:"4 Docker\u5bb9\u5668"}),"\n",(0,i.jsx)(e.h3,{id:"41-\u6982\u8ff0",children:"4.1 \u6982\u8ff0"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u542f\u52a8\u6d41\u7a0b\uff1a","\n",(0,i.jsx)(e.mermaid,{value:"graph TB\nstart[docker run] --\x3e \u5728\u672c\u5730\u67e5\u627e\u6307\u5b9a\u955c\u50cf --\x3e local_if{\u662f\u5426\u627e\u5230\u8be5\u955c\u50cf\uff1f}\nlocal_if --\u627e\u5230--\x3e create[\u521b\u5efa\u5e76\u542f\u52a8\u955c\u50cf\u7684\u5bb9\u5668]\nlocal_if --\u6ca1\u627e\u5230--\x3e remote[\u5230Docker Hub\u67e5\u627e\u8be5\u955c\u50cf] --\x3e remote_if{\u662f\u5426\u627e\u5230\u8be5\u955c\u50cf\uff1f}\nremote_if --\u627e\u5230--\x3e \u4e0b\u8f7d\u8be5\u955c\u50cf\u5230\u672c\u5730 --\x3e create\nremote_if --\u6ca1\u627e\u5230--\x3e error[\u62a5\u9519\uff1a\u627e\u4e0d\u5230\u6307\u5b9a\u955c\u50cf]"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u5bb9\u5668\u8fd0\u884c\uff0c\u672c\u8d28\u662f\u4e3a\u4e86\u542f\u52a8\u5e76\u8fd0\u884c\u5bb9\u5668\u4e2d\u7684\u5e94\u7528 \u2192 \u5e94\u7528\u8fd0\u884c\u5b8c\u6bd5\u540e\uff0c\u5bb9\u5668\u4f1a\u81ea\u52a8\u7ec8\u6b62","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u4f7f\u5e94\u7528\u5904\u4e8e\u4e0e\u7528\u6237\u4ea4\u4e92\u7684\u72b6\u6001\u6216\u7b49\u5f85\u72b6\u6001 \u2192 \u907f\u514d\u5bb9\u5668\u7ec8\u6b62"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"42-\u547d\u4ee4",children:"4.2 \u547d\u4ee4"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"docker run"}),"\uff1a\u521b\u5efa\u5e76\u542f\u52a8\u5bb9\u5668"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"--name"}),"\uff1a\u6307\u5b9a\u5f53\u524d\u5bb9\u5668\u540d\u79f0"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"-it"}),"\uff1a\u4ee5 ",(0,i.jsx)(e.strong,{children:"\u4ea4\u4e92\u6a21\u5f0f\uff08Interactive mode\uff09"})," \u6765\u8fd0\u884c\u5bb9\u5668\uff0c\u5e76\u6839\u636e ",(0,i.jsx)(e.code,{children:"/bin/bash"})," \u547d\u4ee4\u542f\u52a8bash\u7ec8\u7aef","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["bash\u7ec8\u7aef\u7684\u547d\u4ee4\u884c\u524d\u7f00\uff1a",(0,i.jsx)(e.code,{children:"root@<docker-id>:</path>#"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"-p <\u5bbf\u4e3b\u673a\u7aef\u53e3>:<\u5bb9\u5668\u7aef\u53e3>"}),"\uff1a\u6307\u5b9a\u7aef\u53e3\u6620\u5c04"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"-d"}),"\uff1a\u4ee5 ",(0,i.jsx)(e.strong,{children:"\u5206\u79bb\u6a21\u5f0f\uff08Detached mode\uff09"})," \u6765\u8fd0\u884c\u5bb9\u5668\uff0c\u5373\u547d\u4ee4\u5728\u540e\u53f0\u8fd0\u884c"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"docker create"}),"\uff1a\u521b\u5efa\u5bb9\u5668"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u7528\u6cd5\u4e0e ",(0,i.jsx)(e.code,{children:"docker run"})," \u7c7b\u4f3c\uff0c\u4f46\u6ca1\u6709 ",(0,i.jsx)(e.code,{children:"-d"})," \u9009\u9879"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u9000\u51fa\u5bb9\u5668\uff1a"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u5bb9\u5668\u547d\u4ee4\u884c\u4e2d\u6267\u884c ",(0,i.jsx)(e.code,{children:"exit"})," \u547d\u4ee4\uff1a\u9000\u51fa\u5e76\u505c\u6b62\u5bb9\u5668"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"ctrl + p + q"}),"\uff1a\u9000\u51fa\u4f46\u4e0d\u505c\u6b62\u5bb9\u5668"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"docker ps"}),"\uff1a\u67e5\u770b\u6240\u6709\u6b63\u5728\u8fd0\u884c\u7684\u5bb9\u5668"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"-a"}),"\uff1a\u67e5\u770b\u6240\u6709\u5bb9\u5668\uff0c\u65e0\u8bba\u5bb9\u5668\u662f\u5426\u5904\u4e8e\u8fd0\u884c\u72b6\u6001"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"-q"}),"\uff1a\u67e5\u770b\u6240\u6709\u6b63\u5728\u8fd0\u884c\u7684\u5bb9\u5668ID"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"-l"}),"\uff1a\u67e5\u770b\u6700\u540e\u521b\u5efa\u7684\u5bb9\u5668\uff0c\u65e0\u8bba\u5bb9\u5668\u662f\u5426\u5904\u4e8e\u8fd0\u884c\u72b6\u6001"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"-n <number>"}),"\uff1a\u67e5\u770b\u6700\u540e\u521b\u5efa\u7684\u6307\u5b9a\u4e2a\u6570\u7684\u5bb9\u5668\uff0c\u65e0\u8bba\u5bb9\u5668\u662f\u5426\u5904\u4e8e\u8fd0\u884c\u72b6\u6001"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"docker exec"}),"\uff1a\u5bf9\u6b63\u5728\u8fd0\u884c\u7684\u5bb9\u5668\u8fdb\u884c\u64cd\u4f5c"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"-it"}),"\uff1a\u4ee5\u4ea4\u4e92\u6a21\u5f0f\uff08Interactive mode\uff09\u6765\u8fd0\u884c\u5bb9\u5668","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"/bin/bash"}),"\uff1a\u8fdb\u5165\u5bb9\u5668\u5185\u90e8\u8fdb\u884c\u64cd\u4f5c\uff0c",(0,i.jsx)(e.code,{children:"exit"})," \u547d\u4ee4\u53ef\u9000\u51fa\uff08",(0,i.jsx)(e.code,{children:"exec"})," \u547d\u4ee4\u65b0\u5efa\u8fdb\u7a0b \u2192 \u4e0d\u5f71\u54cd\u5bb9\u5668\u8fd0\u884c\uff09"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"<command>"}),"\uff1a\u8981\u6267\u884c\u7684\u547d\u4ee4\uff0c\u53ef\u5728\u5916\u90e8\u76f4\u63a5\u6267\u884c"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"docker attach"}),"\uff1a\u5bf9\u6b63\u5728\u8fd0\u884c\u7684\u5bb9\u5668\u8fdb\u884c\u64cd\u4f5c"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u4ea4\u4e92\u6a21\u5f0f\uff1a",(0,i.jsx)(e.code,{children:"exit"})," \u547d\u4ee4\u9000\u51fa\u5bb9\u5668\uff08",(0,i.jsx)(e.code,{children:"attach"})," \u547d\u4ee4\u4e0d\u4f1a\u65b0\u5efa\u8fdb\u7a0b \u2192 \u5f71\u54cd\u5bb9\u5668\u8fd0\u884c\uff0c\u4f7f\u5bb9\u5668\u505c\u6b62\u8fd0\u884c\uff09"]}),"\n",(0,i.jsxs)(e.li,{children:["\u5206\u79bb\u6a21\u5f0f\uff1a",(0,i.jsx)(e.code,{children:"ctrl + c"})," \u9000\u51fa\u5e76\u505c\u6b62\u5bb9\u5668"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"docker top"}),"\uff1a\u67e5\u770b\u6b63\u5728\u8fd0\u884c\u7684\u5bb9\u5668\u5185\u6b63\u5728\u8fd0\u884c\u7684\u8fdb\u7a0b\u8be6\u60c5"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"docker logs"}),"\uff1a\u67e5\u770b\u5bb9\u5668\u4e2d\u5e94\u7528\u7684\u8fd0\u884c\u65e5\u5fd7\uff0c\u65e0\u8bba\u5bb9\u5668\u662f\u5426\u5904\u4e8e\u8fd0\u884c\u72b6\u6001"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"<contain-name>"}),"\uff1a\u67e5\u770b\u6307\u5b9a\u5bb9\u5668\u4e2d\u5e94\u7528\u7684\u8fd0\u884c\u65e5\u5fd7"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"-n <number>"})," / ",(0,i.jsx)(e.code,{children:"--tail=<number>"}),"\uff1a\u663e\u793a\u6307\u5b9a\u884c\u6570\u7684\u5c3e\u90e8\u65e5\u5fd7"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"--since="}),"\uff1a\u4ece\u6307\u5b9a\u65f6\u95f4\u5f00\u59cb\u663e\u793a\u65e5\u5fd7","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:'"<yyyy-MM-dd>"'}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u7edd\u5bf9"})," \u65f6\u95f4\uff08\u6307\u5b9a\u65e5\u671f\uff09"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"<number>h/m/s"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u76f8\u5bf9"})," \u65f6\u95f4\uff08\u6307\u5b9a\u5c0f\u65f6/\u5206\u949f/\u79d2\u949f\uff09"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"--until="}),"\uff1a\u663e\u793a\u5230\u6307\u5b9a\u65f6\u95f4\u4e4b\u524d\u7684\u65e5\u5fd7","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:'"<yyyy-MM-dd>"'}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u7edd\u5bf9"})," \u65f6\u95f4\uff08\u6307\u5b9a\u65e5\u671f\uff09"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"<number>h/m/s"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u76f8\u5bf9"})," \u65f6\u95f4\uff08\u6307\u5b9a\u5c0f\u65f6/\u5206\u949f/\u79d2\u949f\uff09"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"-t"}),"\uff1a\u67e5\u770b\u65e5\u5fd7\u7684\u65f6\u95f4\u6233"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"-f"}),"\uff1a\u67e5\u770b\u8fd0\u884c\u5bb9\u5668\u4e2d\u7684\u52a8\u6001\u65e5\u5fd7"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"docker start"}),"\uff1a\u542f\u52a8\u5bb9\u5668"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"docker restart"}),"\uff1a\u91cd\u542f\u5904\u4e8e\u8fd0\u884c\u72b6\u6001\u7684\u5bb9\u5668"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"docker stop"}),"\uff1a\u505c\u6b62\u5bb9\u5668\uff0c\u82e5\u6709\u5176\u5b83\u8fdb\u7a0b\u6b63\u5728\u8bbf\u95ee\uff0c\u5219\u5728\u8bbf\u95ee\u7ed3\u675f\u540e\u518d\u505c\u6b62"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"docker kill"}),"\uff1a\u5f3a\u5236\u505c\u6b62\u5bb9\u5668"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"docker pause"}),"\uff1a\u6682\u505c\u5bb9\u5668\u5bf9\u5916\u63d0\u4f9b\u7684\u670d\u52a1"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"docker unpause"}),"\uff1a\u89e3\u9664\u5bb9\u5668\u7684\u6682\u505c\u670d\u52a1\u72b6\u6001"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"docker rm"}),"\uff1a\u5220\u9664\u5bb9\u5668\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5220\u9664\u505c\u6b62\u72b6\u6001\u7684\u5bb9\u5668"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"-f"}),"\uff1a\u5f3a\u5236\u5220\u9664\u5bb9\u5668\uff0c\u65e0\u8bba\u5bb9\u5668\u662f\u5426\u5904\u4e8e\u505c\u6b62\u72b6\u6001"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"docker cp"}),"\uff1a\u5b8c\u6210\u5bbf\u4e3b\u673a\u4e0e\u5bb9\u5668\u4e4b\u95f4\u7684\u6587\u4ef6\u6216\u76ee\u5f55\u7684\u76f8\u4e92\u590d\u5236\uff0c\u65e0\u8bba\u5bb9\u5668\u662f\u5426\u5904\u4e8e\u8fd0\u884c\u72b6\u6001"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"<source> <destination>"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:"<\u5bbf\u4e3b\u673a\u7684\u6587\u4ef6\u6216\u76ee\u5f55\u8def\u5f84>"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:"<contain-name>:<\u5bb9\u5668\u7684\u6587\u4ef6\u6216\u76ee\u5f55\u8def\u5f84>"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.li,{children:"\u4e0d\u652f\u6301\u5bb9\u5668\u95f4\u7684\u76f8\u4e92\u590d\u5236"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"docker commit"}),"\uff1a\u4e3a\u5bb9\u5668\u7684\u5f53\u524d\u5feb\u7167\u751f\u6210\u4e00\u4e2a\u65b0\u955c\u50cf"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"-a"}),"\uff1a\u63d0\u4ea4\u8005"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"-m"}),"\uff1a\u63d0\u4ea4\u4fe1\u606f"]}),"\n"]}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{style:{textAlign:"center"}}),(0,i.jsxs)(e.th,{style:{textAlign:"center"},children:[(0,i.jsx)(e.code,{children:"docker export"})," + ",(0,i.jsx)(e.code,{children:"docker import"})]}),(0,i.jsx)(e.th,{style:{textAlign:"center"},children:(0,i.jsx)(e.code,{children:"docker commit"})})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"center"},children:"\u76f8\u540c\u70b9"}),(0,i.jsx)(e.td,{style:{textAlign:"center"},children:"\u5c06\u4e00\u4e2a\u5bb9\u5668\u53d8\u6210\u4e00\u4e2a\u955c\u50cf"}),(0,i.jsx)(e.td,{style:{textAlign:"center"},children:"\u5c06\u4e00\u4e2a\u5bb9\u5668\u53d8\u6210\u4e00\u4e2a\u955c\u50cf"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"center"},children:"\u4e0d\u540c\u70b9"}),(0,i.jsx)(e.td,{style:{textAlign:"center"},children:"\u65b0\u955c\u50cf\u4ec5\u5305\u542b\u539f\u5bb9\u5668\u751f\u6210\u7684\u4e00\u5c42\u5206\u5c42"}),(0,i.jsx)(e.td,{style:{textAlign:"center"},children:"\u65b0\u955c\u50cf\u5305\u542b\u539f\u955c\u50cf\u4e2d\u7684\u6240\u6709\u5206\u5c42"})]})]})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"docker export"}),"\uff1a\u5c06\u5bb9\u5668\u5bfc\u51fa\u4e3a ",(0,i.jsx)(e.code,{children:".tar"})," \u6587\u4ef6"]}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{style:{textAlign:"center"},children:"\u5bf9\u6bd4\u5b57\u6bb5"}),(0,i.jsx)(e.th,{style:{textAlign:"center"},children:(0,i.jsx)(e.code,{children:"docker export"})}),(0,i.jsx)(e.th,{style:{textAlign:"center"},children:(0,i.jsx)(e.code,{children:"docker save"})})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"center"},children:"\u4f5c\u7528\u5bf9\u8c61"}),(0,i.jsx)(e.td,{style:{textAlign:"center"},children:"\u5bb9\u5668"}),(0,i.jsx)(e.td,{style:{textAlign:"center"},children:"\u955c\u50cf"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"center"},children:"\u5bfc\u51fa\u6570\u91cf"}),(0,i.jsx)(e.td,{style:{textAlign:"center"},children:"\u4e00\u6b21\u53ea\u80fd\u5bf9\u4e00\u4e2a\u5bb9\u5668\u5bfc\u51fa"}),(0,i.jsx)(e.td,{style:{textAlign:"center"},children:"\u4e00\u6b21\u53ef\u4ee5\u5bf9\u591a\u4e2a\u955c\u50cf\u5bfc\u51fa"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"center"},children:"\u539f\u955c\u50cf\u7684\u4fe1\u606f"}),(0,i.jsx)(e.td,{style:{textAlign:"center"},children:"\u4f1a\u4e22\u5f03\u539f\u955c\u50cf\u7684\u90e8\u5206\u8bb0\u5f55\uff08\u5386\u53f2\u8bb0\u5f55\u548c\u5143\u6570\u636e\u4fe1\u606f\uff09"}),(0,i.jsx)(e.td,{style:{textAlign:"center"},children:"\u4fdd\u5b58\u4e86\u539f\u955c\u50cf\u7684\u5b8c\u6574\u8bb0\u5f55"})]})]})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"docker import"}),"\uff1a\u5c06 ",(0,i.jsx)(e.code,{children:".tar"})," \u6587\u4ef6\u5bfc\u5165\u5e76\u6784\u5efa\u4e00\u4e2a\u65b0\u7684\u955c\u50cf"]}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{style:{textAlign:"center"},children:"\u5bf9\u6bd4\u5b57\u6bb5"}),(0,i.jsx)(e.th,{style:{textAlign:"center"},children:(0,i.jsx)(e.code,{children:"docker import"})}),(0,i.jsx)(e.th,{style:{textAlign:"center"},children:(0,i.jsx)(e.code,{children:"docker load"})})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"center"},children:"\u4f5c\u7528\u5bf9\u8c61"}),(0,i.jsx)(e.td,{style:{textAlign:"center"},children:"\u5bb9\u5668"}),(0,i.jsx)(e.td,{style:{textAlign:"center"},children:"\u955c\u50cf"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"center"},children:"\u6062\u590d\u7684\u955c\u50cf"}),(0,i.jsx)(e.td,{style:{textAlign:"center"},children:"\u53ea\u5305\u542b\u5f53\u524d\u955c\u50cf\u5c42"}),(0,i.jsx)(e.td,{style:{textAlign:"center"},children:"\u4e0e\u539f\u955c\u50cf\u7684\u5206\u5c42\u4fdd\u6301\u76f8\u540c"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"center"},children:"\u6062\u590d\u7684\u955c\u50cf"}),(0,i.jsx)(e.td,{style:{textAlign:"center"},children:"\u65b0\u6784\u5efa\u7684\u955c\u50cf\uff0c\u4e0e\u539f\u955c\u50cf\u7684imageID\u4e0d\u540c"}),(0,i.jsx)(e.td,{style:{textAlign:"center"},children:"\u4e0e\u539f\u955c\u50cf\u7684imageID\u4fdd\u6301\u76f8\u540c"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"center"},children:"\u5b9a\u4f4d"}),(0,i.jsxs)(e.td,{style:{textAlign:"center"},children:["\u53ef\u4ee5\u6307\u5b9a ",(0,i.jsx)(e.code,{children:"<repository>:<tag>"})]}),(0,i.jsxs)(e.td,{style:{textAlign:"center"},children:["\u4e0e\u539f\u955c\u50cf\u7684 ",(0,i.jsx)(e.code,{children:"<repository>:<tag>"})," \u4fdd\u6301\u76f8\u540c"]})]})]})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"docker system"})," \u547d\u4ee4\u96c6\uff1a"]}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker system df"}),"\uff1a\u67e5\u770bdocker\u5404\u90e8\u5206\u7684\u5360\u7528\u60c5\u51b5","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"-v"}),"\uff1a\u83b7\u53d6\u66f4\u8be6\u7ec6\u7684\u5360\u7528\u60c5\u51b5"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker system events"}),"\uff1a\u67e5\u770b\u6307\u5b9a\u65e5\u671f\u8303\u56f4\u4e4b\u95f4\u53d1\u751f\u7684\u6240\u6709\u4e8b\u4ef6","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:"--since"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:"--until"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker system info"}),"\uff1a\u67e5\u770b\u5f53\u524ddocker\u7684\u8be6\u60c5","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"docker client\u7684\u8be6\u60c5"}),"\n",(0,i.jsx)(e.li,{children:"docker server\u7684\u8be6\u60c5\uff1a\u955c\u50cf\u60c5\u51b5\u3001\u5bb9\u5668\u60c5\u51b5\u3001docker\u6240\u5728\u7cfb\u7edf\u7684\u8f6f\u786c\u4ef6\u60c5\u51b5"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker system prune"}),"\uff1a\u5220\u9664docker\u4e2d\u7684\u65e0\u7528\u6570\u636e","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5df2\u7ecf\u505c\u6b62\u7684\u5bb9\u5668"}),"\n",(0,i.jsx)(e.li,{children:"\u6ca1\u6709\u8fde\u63a5\u4efb\u4f55\u5bb9\u5668\u7684\u7f51\u7edc\u3001\u60ac\u865a\u955c\u50cf\uff08dangling image\uff09"}),"\n",(0,i.jsx)(e.li,{children:"\u60ac\u865a\u955c\u50cf\u7684\u6784\u5efa\u7f13\u5b58\uff08dangling build cache\uff09"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"5-dockerfile",children:"5 Dockerfile"}),"\n",(0,i.jsx)(e.h3,{id:"51-\u6982\u8ff0",children:"5.1 \u6982\u8ff0"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"Dockerfile"}),"\uff1a\u7531\u4e00\u7cfb\u5217\u6307\u4ee4\u6784\u6210\u7684\u3001\u7528\u6765\u6784\u5efaDocker\u955c\u50cf\u7684\u811a\u672c\u6587\u4ef6","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u7531\u4e0a\u5230\u4e0b\u4f9d\u6b21\u6267\u884c\u6307\u4ee4"}),"\n",(0,i.jsx)(e.li,{children:"\u6bcf\u6761\u6307\u4ee4\u90fd\u4f1a\u6784\u5efa\u51fa\u4e00\u4e2a\u955c\u50cf"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u6307\u4ee4\uff1a","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5927\u5c0f\u5199\u4e0d\u654f\u611f\uff08\u60ef\u4f8b\u662f\u5168\u5927\u5199\uff09"}),"\n",(0,i.jsx)(e.li,{children:"\u6307\u4ee4\u540e\u9762\u81f3\u5c11\u4f1a\u643a\u5e26\u4e00\u4e2a\u53c2\u6570"}),"\n",(0,i.jsxs)(e.li,{children:["\u6ce8\u91ca\u7b26\u53f7\uff1a",(0,i.jsx)(e.code,{children:"#"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"52-\u6307\u4ee4",children:"5.2 \u6307\u4ee4"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"FROM <image>[:<tag>]"}),"\uff1a\u6307\u5b9a\u57fa\u7840\u955c\u50cf\uff0c\u4e14 ",(0,i.jsx)(e.strong,{children:"\u5fc5\u987b\u662f\u7b2c\u4e00\u6761"})," \u6307\u4ee4"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"MAINTAINER <name>"}),"\uff1a\uff08\u5df2\u8fc7\u65f6\uff0c\u7528 ",(0,i.jsx)(e.code,{children:"LABEL"})," \u6307\u4ee4\u4ee3\u66ff\uff09\u586b\u5199\u7ef4\u62a4\u8005\u59d3\u540d\u548c\u90ae\u7bb1"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"LABEL <key>=<value> <key>=<value> \u2026"}),"\uff1a\u4ee5\u952e\u503c\u5bf9\u7684\u65b9\u5f0f\u5305\u542b\u955c\u50cf\u7684\u5143\u6570\u636e\u4fe1\u606f\uff0c\u4fee\u6539\u955c\u50cf\u7684json\u6587\u4ef6"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"ENV"}),"\uff1a\u6307\u5b9a\u73af\u5883\u53d8\u91cf","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:"ENV <key> <value>"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:"ENV <key>=<value> <key>=<value> \u2026"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"WORKDIR <path>"}),"\uff1a\u5bb9\u5668\u7684\u9ed8\u8ba4\u76ee\u5f55\uff0c\u5373\u540e\u7eed\u6307\u4ee4\u7684\u5de5\u4f5c\u76ee\u5f55","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u8bbe\u7f6e\u591a\u4e2a ",(0,i.jsx)(e.code,{children:"WORKDIR"})," \u6307\u4ee4\u65f6\uff0c\u82e5\u6709\u7528\u5230\u76f8\u5bf9\u8def\u5f84\uff0c\u5219\u4f1a\u57fa\u4e8e\u4e4b\u524d\u5df2\u7ecf\u6307\u5b9a\u8fc7\u7684\u8def\u5f84"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"RUN"}),"\uff1a",(0,i.jsx)(e.code,{children:"docker build"})," \u547d\u4ee4\u6267\u884c\u8fc7\u7a0b\u4e2d","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:'RUN ["executable", "param1", "param2", \u2026]'}),"\uff1a\u7528\u6307\u5b9a\u7684\u5e94\u7528\u7a0b\u5e8f ",(0,i.jsx)(e.code,{children:"executable"})," \u8fd0\u884c\uff0c\u5e76\u4f7f\u7528 ",(0,i.jsx)(e.code,{children:"param1"}),"\u3001",(0,i.jsx)(e.code,{children:"param2"})," \u7b49\u4f5c\u4e3a\u8fd0\u884c\u53c2\u6570"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"RUN <command>"}),"\uff1a\u6267\u884cshell\u547d\u4ee4"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"CMD"}),"\uff1a\u5bb9\u5668\u542f\u52a8\u540e\uff0c\u5373 ",(0,i.jsxs)(e.strong,{children:["\u6267\u884c\u5b8c ",(0,i.jsx)(e.code,{children:"docker run"})," \u547d\u4ee4\u540e"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:'CMD ["executable", "param1", "param2", \u2026]'}),"\uff1a\u7528\u6307\u5b9a\u7684\u5e94\u7528\u7a0b\u5e8f ",(0,i.jsx)(e.code,{children:"executable"})," \u8fd0\u884c\uff0c\u5e76\u4f7f\u7528 ",(0,i.jsx)(e.code,{children:"param1"}),"\u3001",(0,i.jsx)(e.code,{children:"param2"})," \u7b49\u4f5c\u4e3a\u8fd0\u884c\u53c2\u6570","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u547d\u4ee4 ",(0,i.jsx)(e.strong,{children:"\u4f1a\u88ab"})," ",(0,i.jsx)(e.code,{children:"docker run"})," \u547d\u4ee4\u540e\u7684 ",(0,i.jsx)(e.code,{children:"<command>"})," ",(0,i.jsx)(e.strong,{children:"\u4ee3\u66ff"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"CMD <command> <param1> <param2> \u2026"}),"\uff1a\u6267\u884cshell\u547d\u4ee4","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u547d\u4ee4 ",(0,i.jsx)(e.strong,{children:"\u4f1a\u88ab"})," ",(0,i.jsx)(e.code,{children:"docker run"})," \u547d\u4ee4\u540e\u7684 ",(0,i.jsx)(e.code,{children:"<command>"})," ",(0,i.jsx)(e.strong,{children:"\u4ee3\u66ff"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:'CMD ["param1", "param2", \u2026]'}),"\uff1a\u63d0\u4f9b\u7ed9 ",(0,i.jsx)(e.code,{children:"ENTRYPOINT"})," \u6307\u4ee4\u7684\u53c2\u6570","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u642d\u914d ",(0,i.jsx)(e.code,{children:"ENTRYPOINT"})," \u6307\u4ee4\u4f7f\u7528"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"ENTRYPOINT"}),"\uff1a\u5bb9\u5668\u542f\u52a8\u8fc7\u7a0b\u4e2d\uff0c\u5373 ",(0,i.jsx)(e.code,{children:"docker run"})," ",(0,i.jsx)(e.strong,{children:"\u547d\u4ee4\u6267\u884c\u8fc7\u7a0b\u4e2d"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:'ENTRYPOINT ["executable", "param1", "param2", \u2026]'}),"\uff1a\u7528\u6307\u5b9a\u7684\u5e94\u7528\u7a0b\u5e8f ",(0,i.jsx)(e.code,{children:"executable"})," \u8fd0\u884c\uff0c\u5e76\u4f7f\u7528 ",(0,i.jsx)(e.code,{children:"param1"}),"\u3001",(0,i.jsx)(e.code,{children:"param2"})," \u7b49\u4f5c\u4e3a\u8fd0\u884c\u53c2\u6570","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u547d\u4ee4 ",(0,i.jsx)(e.strong,{children:"\u4e0d\u4f1a\u88ab"})," ",(0,i.jsx)(e.code,{children:"docker run"})," \u547d\u4ee4\u540e\u7684 ",(0,i.jsx)(e.code,{children:"<command>"})," ",(0,i.jsx)(e.strong,{children:"\u4ee3\u66ff"})," \u2192 ",(0,i.jsx)(e.code,{children:"docker run"})," \u547d\u4ee4\u540e\u7684\u5185\u5bb9\u4f5c\u4e3a\u53c2\u6570 ",(0,i.jsx)(e.code,{children:"<ARG>"})," \u4f7f\u7528"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"ENTRYPOINT <command> <param1> <param2> \u2026"}),"\uff1a\u6267\u884cshell\u547d\u4ee4","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u4e0d\u652f\u6301"})," \u5c06 ",(0,i.jsx)(e.code,{children:"docker run"})," \u547d\u4ee4\u540e\u7684\u5185\u5bb9\u4f5c\u4e3a\u53c2\u6570 ",(0,i.jsx)(e.code,{children:"<ARG>"})," \u4f7f\u7528"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"EXPOSE <port> [<port> \u2026]"}),"\uff1a\u6307\u5b9a\u5bb9\u5668\u51c6\u5907\u5bf9\u5916\u66b4\u9732\u7684\u7aef\u53e3\u53f7","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u5b9e\u9645\u66b4\u9732\u7684\u7aef\u53e3\u4ecd\u7531 ",(0,i.jsx)(e.code,{children:"-p"})," \u6307\u5b9a"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"ARG <varname>[=<default value>]"}),"\uff1a\u5b9a\u4e49\u5355\u4e2a\u7528\u4e8e\u955c\u50cf\u6784\u5efa\u8fd0\u884c\u65f6\u7684\u53d8\u91cf","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u82e5\u8981\u5b9a\u4e49\u591a\u4e2a\uff0c\u5219\u9700\u8981\u58f0\u660e\u591a\u4e2a ",(0,i.jsx)(e.code,{children:"ARG"})," \u6307\u4ee4"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"ADD"}),"\uff1a\u590d\u5236\u5bbf\u4e3b\u673a\u4e2d\u7684\u6307\u5b9a\u6587\u4ef6 ",(0,i.jsx)(e.code,{children:"src"})," \u5230\u5bb9\u5668\u4e2d\u7684\u6307\u5b9a\u76ee\u5f55 ",(0,i.jsx)(e.code,{children:"dest"})," \u4e2d","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u8bed\u6cd5\uff1a","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:"ADD <src> <dest>"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:'ADD ["<src>", "<dest>"]'})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"<src>"}),"\uff1a\u652f\u6301\u5bbf\u4e3b\u673a\u4e2d\u7684\u7edd\u5bf9\u8def\u5f84\u3001\u76f8\u5bf9\u4e8e ",(0,i.jsx)(e.code,{children:"docker build"})," \u547d\u4ee4\u6307\u5b9a\u7684\u8def\u5f84\u4e0b\u7684\u76f8\u5bf9\u8def\u5f84\u3001\u538b\u7f29\u6587\u4ef6\uff08\u590d\u5236\u5230\u5bb9\u5668\u540e\u81ea\u52a8\u89e3\u538b\uff09\u3001URL\uff08\u76f8\u5f53\u4e8e ",(0,i.jsx)(e.code,{children:"wget"})," \u547d\u4ee4\uff09"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"<dest>"}),"\uff1a\u4ec5\u652f\u6301\u7edd\u5bf9\u8def\u5f84\uff0c\u8def\u5f84\u672b\u5c3e\u5fc5\u987b\u52a0\u4e0a\u659c\u6760\uff08\u5426\u5219\u4f1a\u88ab\u5f53\u6210\u4e00\u4e2a\u6587\u4ef6\uff09"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"COPY"}),"\uff1a\u529f\u80fd\u548c ",(0,i.jsx)(e.code,{children:"ADD"})," \u6307\u4ee4\u76f8\u540c","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"<src>"})," \u4e0d\u652f\u6301URL"]}),"\n",(0,i.jsxs)(e.li,{children:["\u82e5 ",(0,i.jsx)(e.code,{children:"<src>"})," \u662f\u538b\u7f29\u6587\u4ef6\uff0c\u5219\u590d\u5236\u5230\u5bb9\u5668\u540e\u4e0d\u4f1a\u81ea\u52a8\u89e3\u538b"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"ONBUILD [INSTRUCTION]"}),"\uff1a\u6307\u5b9a\u5f53\u524d\u955c\u50cf\u7684\u5b50\u955c\u50cf\u8fdb\u884c\u6784\u5efa\u65f6\u8981\u6267\u884c\u7684\u6307\u4ee4"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:'VOLUME ["dir1", "dir2", \u2026]'}),"\uff1a\u5728\u5bb9\u5668\u91cc\u521b\u5efa\u53ef\u4ee5\u6302\u8f7d\u6570\u636e\u5377\u7684 ",(0,i.jsx)(e.strong,{children:"\u6302\u8f7d\u70b9"})]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"53-\u5b9e\u9645\u5e94\u7528",children:"5.3 \u5b9e\u9645\u5e94\u7528"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["scratch\u955c\u50cf\uff1a\u7a7a\u955c\u50cf\uff0c\u6240\u6709\u955c\u50cf\u7684 ",(0,i.jsx)(e.strong,{children:"Base Image"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"Docker\u7684\u4fdd\u7559\u5b57\uff0c\u4e0d\u80fd\u4f5c\u4e3a\u955c\u50cf\u540d\u79f0"}),"\n",(0,i.jsx)(e.li,{children:"\u53ea\u80fd\u5728Dockerfile\u4e2d\u88ab\u7ee7\u627f"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u60ac\u865a\u955c\u50cf\uff1a\u65e2\u6ca1\u6709 ",(0,i.jsx)(e.code,{children:"<repository>"})," \u53c8\u6ca1\u6709 ",(0,i.jsx)(e.code,{children:"<tag>"})," \u7684\u955c\u50cf","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker rmi <imageId>"}),"\uff1a\u5220\u9664\u6307\u5b9a\u955c\u50cfID\u7684\u955c\u50cf"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker image prune"}),"\uff1a\u5220\u9664\u672c\u5730\u6240\u6709\u7684\u60ac\u865a\u955c\u50cf"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker system prune"}),"\uff1a\u5220\u9664docker\u4e2d\u7684\u65e0\u7528\u6570\u636e"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"54-build-cache",children:"5.4 build cache"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u955c\u50cf\u6784\u5efa\u8fc7\u7a0b\uff1a\u4e0b\u5c42\u955c\u50cf\u4f5c\u4e3a\u4e0a\u5c42\u955c\u50cf\u7684 ",(0,i.jsx)(e.strong,{children:"\u7236\u955c\u50cf/\u8f93\u5165"})," \u2192 ",(0,i.jsx)(e.strong,{children:"\u955c\u50cf\u6587\u4ef6\u7cfb\u7edf\u6216json\u6587\u4ef6\u53d1\u751f\u53d8\u66f4\uff0c\u5c31\u4f1a\u751f\u6210\u4e00\u4e2a\u65b0\u7684\u955c\u50cf\u5c42"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"FROM centos:7"}),"\uff1a\u53ea\u8bbe\u5b9a\u4e00\u4e2a\u57fa\u7840\u955c\u50cf\uff0c\u4e0d\u4f1a\u505a\u4efb\u4f55\u64cd\u4f5c"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:'LABEL auth="bjpowernode"'}),"\uff1a\u4fee\u6539\u955c\u50cfjson\u6587\u4ef6 \u2192 \u751f\u6210\u4e00\u4e2a\u65b0\u7684\u955c\u50cf\u5c42"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"COPY helloworld.log /var/log"}),"\uff1a\u4fee\u6539\u955c\u50cf\u6587\u4ef6\u7cfb\u7edf \u2192 \u751f\u6210\u4e00\u4e2a\u65b0\u7684\u955c\u50cf\u5c42"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"RUN yum -y install vim"}),"\uff1a\u5b89\u88c5\u65b0\u5de5\u5177 \u2192 \u4fee\u6539\u955c\u50cf\u6587\u4ef6\u7cfb\u7edf \u2192 \u751f\u6210\u4e00\u4e2a\u65b0\u7684\u955c\u50cf\u5c42"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"CMD /bin/bash"}),"\uff1a\u542f\u52a8\u540e\u9700\u8981\u6267\u884c\u547d\u4ee4 \u2192 \u4fee\u6539\u955c\u50cfjson\u6587\u4ef6 \u2192 \u751f\u6210\u4e00\u4e2a\u65b0\u7684\u955c\u50cf\u5c42"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["build cache\u673a\u5236\uff1a\u53d1\u73b0\u5373\u5c06\u65b0\u6784\u5efa\u51fa\u7684\u955c\u50cf\uff08\u5c42\uff09\u4e0e\u672c\u5730\u5df2\u5b58\u5728\u7684\u67d0\u955c\u50cf\uff08\u5c42\uff09\u91cd\u590d\u65f6\uff0c\u9ed8\u8ba4 ",(0,i.jsx)(e.strong,{children:"\u590d\u7528"})]}),"\n",(0,i.jsxs)(e.li,{children:["build cache\u5931\u6548\uff1a\u4ece ",(0,i.jsx)(e.strong,{children:"\u53d1\u751f\u53d8\u5316\u7684\u6307\u4ee4\u5c42"})," \u5f00\u59cb\u7684\u955c\u50cf\u5c42\u7684cache\u5168\u90e8\u5931\u6548","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"Dockerfile\u6587\u4ef6\u4e2d\u7684\u6307\u4ee4\u53d1\u751f\u53d8\u5316"}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"ADD"})," \u6216 ",(0,i.jsx)(e.code,{children:"COPY"})," \u6307\u4ee4\u64cd\u4f5c\u7684\u6587\u4ef6\u5185\u5bb9\u53d1\u751f\u53d8\u5316"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"RUN"})," \u6307\u4ee4\u7684\u5916\u90e8\u4f9d\u8d56\u53d1\u751f\u53d8\u5316"]}),"\n",(0,i.jsxs)(e.li,{children:["build\u65f6\u6307\u5b9a ",(0,i.jsx)(e.code,{children:"--no-cache"}),"\uff1a\u5f53\u524d\u6784\u5efa\u65f6\u5747\u4e0d\u4f7f\u7528cache"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u6e05\u7406dangling build cache\uff1a",(0,i.jsx)(e.code,{children:"docker system prune"})]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"6-\u6570\u636e\u6301\u4e45\u5316",children:"6 \u6570\u636e\u6301\u4e45\u5316"}),"\n",(0,i.jsx)(e.h3,{id:"61-\u5b9a\u5236\u955c\u50cf\u6301\u4e45\u5316",children:"6.1 \u5b9a\u5236\u955c\u50cf\u6301\u4e45\u5316"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u5bf9\u955c\u50cf\u8fdb\u884c\u64cd\u4f5c\u540e\uff0c\u6267\u884c ",(0,i.jsx)(e.code,{children:"docker commit"})," \u547d\u4ee4\uff0c\u4ee5\u5f53\u524d\u8fd0\u884c\u7684\u5bb9\u5668\u4e3a ",(0,i.jsx)(e.strong,{children:"\u8303\u672c"})," \u751f\u6210\u955c\u50cf"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"62-\u6570\u636e\u5377\u6301\u4e45\u5316",children:"6.2 \u6570\u636e\u5377\u6301\u4e45\u5316"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["docker\u63d0\u4f9b\u7684\u5b9e\u65f6\u6570\u636e\u540c\u6b65\u65b9\u5f0f\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"\u6570\u636e\u5377"}),"\n",(0,i.jsx)(e.li,{children:"Bind mounts\uff08\u7ed1\u5b9a\u6302\u8f7d\uff09"}),"\n",(0,i.jsx)(e.li,{children:"tmpfs\uff08\u4e34\u65f6\u6587\u4ef6\u7cfb\u7edf\uff09"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:(0,i.jsx)("font",{color:"red",children:"\u6570\u636e\u5377"})}),"\uff1a\u5bbf\u4e3b\u673a\u4e2d\u7684\u7279\u6b8a\u6587\u4ef6/\u76ee\u5f55","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"\u5bb9\u5668/\u6302\u8f7d\u70b9\u7684\u5220\u9664\uff0c\u4e0d\u4f1a\u7ea7\u8054\u5220\u9664\u6570\u636e\u5377"}),"\n",(0,i.jsx)(e.li,{children:"\u82e5\u6570\u636e\u5377/\u6302\u8f7d\u70b9\u4e2d\u672c\u6765\u5c31\u6709\u5185\u5bb9\uff0c\u5bb9\u5668\u542f\u52a8\u540e\u4f1a\u81ea\u52a8\u540c\u6b65\u5230\u53e6\u4e00\u7aef"}),"\n",(0,i.jsx)(e.li,{children:"\u53ef\u76f4\u63a5\u4fee\u6539\u6570\u636e\u5377/\u6302\u8f7d\u70b9\u4e2d\u7684\u5185\u5bb9"}),"\n",(0,i.jsx)(e.li,{children:"\u6570\u636e\u5377\u53ef\u4ee5\u5728\u5bb9\u5668\u4e4b\u95f4\u5171\u4eab\u548c\u91cd\u7528"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:(0,i.jsx)("font",{color:"red",children:"\u6302\u8f7d\u70b9"})}),"\uff1a\u5bb9\u5668\u4e2d\u4e0e\u6570\u636e\u5377\u76f8\u5173\u8054\u7684\u6587\u4ef6/\u76ee\u5f55"]}),"\n",(0,i.jsxs)(e.li,{children:["\u547d\u4ee4\uff1a\u6307\u5b9a\u76ee\u5f55\u4e0d\u5b58\u5728\u65f6\uff0c\u4f1a\u81ea\u52a8\u521b\u5efa","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker run -it -v /<\u5bbf\u4e3b\u673a\u7edd\u5bf9\u8def\u5f84\u76ee\u5f55>:/<\u5bb9\u5668\u5185\u7edd\u5bf9\u8def\u5f84\u76ee\u5f55> image"}),"\uff1a\u521b\u5efa\u8bfb\u5199 ",(0,i.jsx)(e.code,{children:"rw"})," \u6570\u636e\u5377","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u5bb9\u5668 ",(0,i.jsx)(e.strong,{children:"\u8bfb\u5199"})," \u6302\u8f7d\u70b9"]}),"\n",(0,i.jsxs)(e.li,{children:["\u5bbf\u4e3b\u673a ",(0,i.jsx)(e.strong,{children:"\u8bfb\u5199"})," \u6570\u636e\u5377"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker run -it -v /<\u5bbf\u4e3b\u673a\u7edd\u5bf9\u8def\u5f84\u76ee\u5f55>:/<\u5bb9\u5668\u5185\u7edd\u5bf9\u8def\u5f84\u76ee\u5f55>:ro image"}),"\uff1a\u521b\u5efa\u53ea\u8bfb ",(0,i.jsx)(e.code,{children:"ro"})," \u6570\u636e\u5377","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u5bb9\u5668 ",(0,i.jsx)(e.strong,{children:"\u53ea\u8bfb"})," \u6302\u8f7d\u70b9"]}),"\n",(0,i.jsxs)(e.li,{children:["\u5bbf\u4e3b\u673a ",(0,i.jsx)(e.strong,{children:"\u8bfb\u5199"})," \u6570\u636e\u5377"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u6570\u636e\u5377\u5171\u4eab\uff1a\u9700\u8981\u4e00\u4e2a\u5bb9\u5668\u4f5c\u4e3a ",(0,i.jsx)(e.strong,{children:"\u6570\u636e\u5377\u5bb9\u5668"}),"\uff0c\u5176\u5b83\u9700\u8981\u5171\u4eab\u6570\u636e\u5377\u7684\u5bb9\u5668\u5728\u542f\u52a8\u65f6\u6307\u5b9a ",(0,i.jsx)(e.code,{children:"--volumes-from [\u6570\u636e\u5377\u5bb9\u5668]"})," \u5373\u53ef"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"63-dockerfile\u6301\u4e45\u5316",children:"6.3 Dockerfile\u6301\u4e45\u5316"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u901a\u8fc7Dockerfile\u4e2d\u7684 ",(0,i.jsx)(e.code,{children:"VOLUME"})," \u6307\u4ee4\u6765\u6307\u5b9a\u6302\u8f7d\u70b9","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u5bbf\u4e3b\u673a\u4e2d\u7684\u6570\u636e\u5377\u7531Docker Daemon\u81ea\u52a8\u5206\u914d\u540d\u79f0\u4e0e\u76ee\u5f55\uff08docker\u76ee\u5f55\u4e0b\u7684 ",(0,i.jsx)(e.code,{children:"/volumes/<name>/_data"}),"\uff09"]}),"\n",(0,i.jsx)(e.li,{children:"\u4ecd\u652f\u6301\u5728\u5bb9\u5668\u542f\u52a8\u65f6\u6307\u5b9a\u6570\u636e\u5377"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"7-docker\u7f51\u7edc",children:"7 Docker\u7f51\u7edc"}),"\n",(0,i.jsx)(e.h3,{id:"71-\u6982\u8ff0",children:"7.1 \u6982\u8ff0"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:(0,i.jsx)("font",{color:"red",children:"Network Namespace"})}),"\uff1aLinux\u63d0\u4f9b\u7684\u7528\u4e8e\u5b9e\u73b0\u7f51\u7edc\u865a\u62df\u5316\u7684\u529f\u80fd\uff0c\u521b\u5efa\u591a\u4e2a\u9694\u79bb\u7684\u7f51\u7edc\u7a7a\u95f4\uff08\u72ec\u7acb\u7684\u9632\u706b\u5899\u3001\u7f51\u5361\u3001\u8def\u7531\u8868\u3001\u90bb\u5c45\u8868\u3001\u534f\u8bae\u6808\uff09\n",(0,i.jsx)(e.img,{alt:"Network Namespace",src:s(5724).A+"",width:"775",height:"328"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"ip nets add <namespace>"}),"\uff1a\u521b\u5efa\u7f51\u7edc\u7a7a\u95f4\uff08\u9ed8\u8ba4\u6709\u4e00\u4e2a\u56de\u73af\u7f51\u7edc\u9002\u914d\u5668lo\uff09"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"ip link add <vethname1> type veth peer name <vethname2>"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u865a\u62df\u8bbe\u5907\u63a5\u53e3\u6280\u672fveth pair"}),"\uff0c\u521b\u5efa\u4e00\u5bf9\u76f8\u4e92\u8fde\u901a\u7684\u7f51\u7edc\u63a5\u53e3\uff08\u5177\u5907MAC\u5730\u5740\u3001DOWN\u72b6\u6001\u3001\u4e0d\u5177\u5907IP\uff09"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"ip link set <vethname1> netns <namespace1>"}),"\uff1a\u5c06\u7f51\u7edc\u63a5\u53e3\u5206\u914d\u7ed9\u7f51\u7edc\u7a7a\u95f4"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"ip netns exec <namespace1> ip addr add <ip> dev <vethname1>"}),"\uff1a\u7ed9\u7f51\u7edc\u63a5\u53e3\u5206\u914dIP"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"ip netns exec <namespace1> ip link set dev <vethname1> up"}),"\uff1a\u542f\u52a8\u7f51\u7edc\u63a5\u53e3"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["Docker\u7f51\u7edc\u67b6\u6784\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:(0,i.jsx)("font",{color:"red",children:"\u5bb9\u5668\u7f51\u7edc\u6a21\u578bCNM\uff08Container Network Model\uff09"})}),"\uff1a\u4e00\u79cd\u7f51\u7edc\u8fde\u63a5\u7684\u8bbe\u8ba1\u89c4\u8303","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u6c99\u76d2Sandbox"}),"\uff1a\u72ec\u7acb\u7684\u7f51\u7edc\u6808\uff0c\u5305\u542b\u4ee5\u592a\u7f51\u63a5\u53e3\u3001\u7aef\u53e3\u53f7\u3001\u8def\u7531\u8868\u3001DNS\u914d\u7f6e\u7b49\uff0c\u5982Linux Network Namespace"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u7ec8\u7aefEndpoint"}),"\uff1a\u865a\u62df\u7f51\u7edc\u63a5\u53e3\uff0c\u7528\u4e8e\u5c06\u6c99\u76d2\u8fde\u63a5\u5230\u7f51\u7edc\u4e0a\uff1b\u4e00\u4e2a\u7ec8\u7aef\u53ea\u80fd\u63a5\u5165\u4e00\u4e2a\u7f51\u7edc"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u7f51\u7edcNetwork"}),"\uff1a\u9700\u8981\u4ea4\u4e92\u7684\u7ec8\u7aef\u96c6\u5408"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:(0,i.jsx)("font",{color:"red",children:"Libnetwork"})}),"\uff1aCNM\u7684\u5f00\u6e90\u5b9e\u73b0\uff0c\u5e76\u989d\u5916\u5b9e\u73b0\u4e86\u672c\u5730\u670d\u52a1\u53d1\u73b0\u3001\u5bb9\u5668\u8d1f\u8f7d\u5747\u8861\u3001\u7f51\u7edc\u63a7\u5236\u5c42\u4e0e\u7ba1\u7406\u5c42\u7b49\u529f\u80fd"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:(0,i.jsx)("font",{color:"red",children:"\u7f51\u7edc\u9a71\u52a8Driver"})}),"\uff1a",(0,i.jsx)(e.img,{alt:"Driver",src:s(5519).A+"",width:"756",height:"313"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker network ls"}),"\uff1a\u67e5\u770b\u5f53\u524d\u4e3b\u673a\u6240\u8fde\u63a5\u7684\u7f51\u7edc\u53ca\u7f51\u7edc\u7c7b\u578b"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"72-\u7f51\u7edc\u7c7b\u578b",children:"7.2 \u7f51\u7edc\u7c7b\u578b"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"bridge"})," \u6865\u63a5\u7f51\u7edc\uff1adocker\u7684\u9ed8\u8ba4\u7f51\u7edc\u6a21\u5f0f\uff0c\u53ea\u80fd\u7528\u4e8e\u8fde\u63a5\u6240\u5728docker\u5bbf\u4e3b\u673a\u4e0a\u7684\u5bb9\u5668\uff1b\u5177\u6709\u72ec\u7acb\u7684namespace\u3001\u7f51\u7edc\u63a5\u53e3\u3001IP","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"docker0\u7f51\u6865"}),"\uff1a\u9ed8\u8ba4\u7684\u865a\u62df\u7f51\u6865\n",(0,i.jsx)(e.img,{alt:"docker0 Bridge",src:s(4954).A+"",width:"802",height:"456"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u5bb9\u5668\u548c\u7f51\u6865\u95f4\u901a\u8fc7 ",(0,i.jsx)(e.strong,{children:"veth pair\u6280\u672f"})," \u5b9e\u73b0\u8fde\u63a5"]}),"\n",(0,i.jsxs)(e.li,{children:["\u7f51\u6865\u548c\u5916\u7f51\u95f4\u901a\u8fc7 ",(0,i.jsx)(e.strong,{children:"\u7f51\u7edc\u5730\u5740\u8f6c\u6362NAT\u6280\u672f"})," \u5b9e\u73b0\u8fde\u63a5"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u547d\u4ee4\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker network inspect bridge"}),"\uff1a\u67e5\u770bbridge\u7f51\u7edc\u7684\u6574\u4f53\u8fde\u63a5\u60c5\u51b5"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"ip a"}),"\uff1a\u67e5\u770b\u5bbf\u4e3b\u673a\u7684\u7f51\u7edc\u63a5\u53e3"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker exec <container> ip a"}),"\uff1a\u67e5\u770b\u5bb9\u5668\u7684\u7f51\u7edc\u63a5\u53e3"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"brctl show"}),"\uff1a\u67e5\u770b\u5bbf\u4e3b\u673a\u7684\u6240\u6709\u7f51\u6865\u53ca\u5176\u8fde\u63a5\u60c5\u51b5","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u9700\u8981\u5b89\u88c5 ",(0,i.jsx)(e.code,{children:"bridge-utils"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker inspect <container>"}),"\uff1a\u67e5\u770b\u5bb9\u5668\u7684\u8be6\u60c5\uff08\u7f51\u5173Gateway\u7684ip\u5730\u5740 = docker0\u7f51\u6865\u7684\u5730\u5740\uff09"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker network create"}),"\uff1a\u521b\u5efa\u6307\u5b9a\u540d\u79f0\u4e0e\u7c7b\u578b\u7684\u7f51\u7edc","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"-d"}),"\uff1a\u6307\u5b9a\u521b\u5efa\u7f51\u7edc\u65f6\u4f7f\u7528\u7684\u9a71\u52a8\uff0c\u5373\u7f51\u7edc\u7c7b\u578b"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker run \u2026 --network <network>"}),"\uff1a\u6307\u5b9a\u8fde\u63a5\u7684\u7f51\u7edc\uff0c\u9ed8\u8ba4\u8fde\u63a5\u5230\u9ed8\u8ba4\u7684bridge\u7f51\u7edc"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker network connect <network> <container>"}),"\uff1a\u5c06\u5bb9\u5668\u8fde\u63a5\u5230\u6307\u5b9a\u7f51\u7edc\u4e0a"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker exec <container1> ping <container2/ip>"}),"\uff1a\u5efa\u8bae\u4f7f\u7528\u5bb9\u5668\u540d\u79f0 \u2190 ip\u53ef\u80fd\u4f1a\u53d8\u5316\uff0c\u5bb9\u5668\u540d\u56fa\u5b9a\u4e0d\u53d8","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u5728\u9ed8\u8ba4\u7684bridge\u7f51\u7edc\u4e0a\uff0c\u4e0d\u652f\u6301 ",(0,i.jsx)(e.code,{children:"ping <container2>"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker run \u2026 --link <container>"}),"\uff1a\u521b\u5efa\u4e00\u4e2a\u5b9a\u5411\u8fde\u63a5\u5230\u6307\u5b9a\u5bb9\u5668\u7684\u65b0\u5bb9\u5668 \u2192 \u65b0\u5bb9\u5668\u53ea\u80fdping\u901a\u6307\u5b9a\u5bb9\u5668"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker run \u2026 --network container:<container>"}),"\uff1a\u6307\u5b9a\u65b0\u5bb9\u5668\u4e0e\u5df2\u5b58\u5728\u7684\u5bb9\u5668\u5171\u4eab\u7f51\u7edc\u7a7a\u95f4\uff08\u5fc5\u987b\u662fbridge\u7f51\u7edc\u6a21\u5f0f\uff09","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5171\u4eab\u7f51\u7edc\u7a7a\u95f4 \u2192 \u65b0\u5bb9\u5668\u6ca1\u6709\u81ea\u8eab\u7684\u7f51\u7edc\u8bbe\u7f6e"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"none"})," \u6ca1\u6709\u7f51\u7edc\uff1a\u5177\u6709\u72ec\u7acb\u7684namespace\uff0c\u6ca1\u6709\u72ec\u7acb\u7684\u7f51\u7edc\u63a5\u53e3\u3001IP\uff1b\u53ea\u6709\u4e00\u4e2a\u56de\u73af\u5730\u5740lo","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker run \u2026 --network none"}),"\uff1a\u6307\u5b9a\u65b0\u5bb9\u5668\u6ca1\u6709\u7f51\u7edc\u529f\u80fd"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"host"})," \u5bbf\u4e3b\u673a\u7f51\u7edc\uff1a\u6ca1\u6709\u72ec\u7acb\u7684namespace\u3001\u7f51\u7edc\u63a5\u53e3\u3001IP\uff0c\u4e0e\u5bbf\u4e3b\u673a\u5171\u4eab","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker run \u2026 --network host"}),"\uff1a\u6307\u5b9a\u65b0\u5bb9\u5668\u4e3ahost\u7f51\u7edc"]}),"\n",(0,i.jsxs)(e.li,{children:["\u7aef\u53e3\u6620\u5c04 ",(0,i.jsx)(e.code,{children:"-p <host-port>:<container-port>"})," \u4e0d\u8d77\u4f5c\u7528"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"8-\u5e38\u7528\u670d\u52a1\u5668\u5b89\u88c5",children:"8 \u5e38\u7528\u670d\u52a1\u5668\u5b89\u88c5"}),"\n",(0,i.jsx)(e.h3,{id:"81-mysql\u5b89\u88c5",children:"8.1 MySQL\u5b89\u88c5"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u5355\u673a\u5b89\u88c5\u547d\u4ee4\uff1a",(0,i.jsx)(e.code,{children:"docker run --name <mysql-container-name> -e MYSQL_ROOT_PASSWORD=<password> -d mysql:<tag>"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u5b57\u7b26\u7f16\u7801\u95ee\u9898\uff1a",(0,i.jsx)(e.code,{children:"/etc/mysql/conf.d"})," \u76ee\u5f55\u4e0b\u65b0\u5efa ",(0,i.jsx)(e.code,{children:"<name>.cnf"})," \u6587\u4ef6","\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-properties",metastring:"showLineNumbers",children:"[client]\ndefault_character_set=utf8\n[mysql]\ndefault_character_set=utf8\n[mysqld]\ncharacter_set_server=utf8\n"})}),"\n"]}),"\n",(0,i.jsx)(e.li,{children:"\u6570\u636e\u5b89\u5168\u95ee\u9898\uff1a\u6307\u5b9a\u6570\u636e\u5377"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.li,{children:"\u96c6\u7fa4\u642d\u5efa\uff1a\u4e0e\u666e\u901a\u96c6\u7fa4\u642d\u5efa\u6b65\u9aa4\u4e00\u81f4"}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"82-redis\u5b89\u88c5",children:"8.2 Redis\u5b89\u88c5"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u5355\u673a\u5b89\u88c5\u547d\u4ee4\uff1a",(0,i.jsx)(e.code,{children:"docker run --name <redis-container-name> -d redis:<tag> redis-server"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u4fee\u6539 ",(0,i.jsx)(e.code,{children:"redis.conf"}),"\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u6ce8\u91ca ",(0,i.jsx)(e.code,{children:"bind 127.0.0.1 -::1"}),"\uff1a\u89e3\u9664IP\u7ed1\u5b9a"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"protected-mode no"}),"\uff1a\u5173\u95ed\u4fdd\u62a4\u6a21\u5f0f\uff08\u53ea\u5141\u8bb8\u672c\u673a\u8bbf\u95ee\uff09"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"darmonize no"}),"\uff1a\u5173\u95ed\u5b88\u62a4\u6a21\u5f0f\uff08docker\u4ee5\u5206\u79bb\u6a21\u5f0f\u8fd0\u884c\uff0c\u82e5redis\u518d\u4ee5\u6b64\u6a21\u5f0f\u8fd0\u884c\uff0c\u5c06\u65e0\u6cd5\u542f\u52a8\uff09"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"dir /data"}),"\uff1a\u6307\u5b9aRDB\u6216AOF\u7684\u6301\u4e45\u5316\u76ee\u5f55\uff0c\u5e76\u6307\u5b9a\u8be5\u76ee\u5f55\u4e3a\u6570\u636e\u5377"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u4e3b\u4ece\u96c6\u7fa4\u642d\u5efa\uff1a\u4e0e\u666e\u901a\u96c6\u7fa4\u642d\u5efa\u6b65\u9aa4\u4e00\u81f4\uff0c\u542f\u52a8\u4ece\u673a\u5bb9\u5668\u65f6\u9700\u6307\u5b9a ",(0,i.jsx)(e.code,{children:"--slaveof <master-ip> <master-port>"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u53ea\u652f\u6301\u51b7\u5904\u7406\u7684\u5bb9\u707e\u65b9\u6848"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u9ad8\u53ef\u7528\u96c6\u7fa4\u642d\u5efa\uff1a\u5728\u4e3b\u4ece\u96c6\u7fa4\u7684\u57fa\u7840\u4e0a\uff0c\u518d\u642d\u5efa\u54e8\u5175sentinel\u96c6\u7fa4","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u4fee\u6539 ",(0,i.jsx)(e.code,{children:"sentinel.conf"}),"\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"sentinel monitor <master-name> <master-ip> <master-port> <quorum>"}),"\uff1a\u6307\u5b9a\u8981\u76d1\u89c6\u7684\u4e3b\u673a\u4ee5\u53caquorum","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"<quorum>"}),"\uff1a\u8ba4\u5b9a\u4e3b\u673amaster\u6545\u969c\u7684\u6700\u5c11\u54e8\u5175\u4eba\u6570"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"sentinel announce-ip/port <host-ip/port>"}),"\uff1a\u6307\u5b9a\u5f53\u524d\u54e8\u5175\u5bf9\u5916\u5ba3\u5e03\u7684IP\uff08\u5373\u5bbf\u4e3b\u673aIP\uff09\u548c\u7aef\u53e3\u53f7\uff08\u5bb9\u5668\u5bf9\u5916\u66b4\u9732\u7684\u7aef\u53e3\u53f7\uff09"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u5206\u5e03\u5f0f\u642d\u5efa\uff1a\u8bf7\u6c42\u6570\u636e\u5199\u5165\u65f6\uff0c\u5206\u5e03\u5f0f\u7cfb\u7edf\u4f1a\u91c7\u7528\u865a\u62df\u69fd\u5206\u533a\u7b97\u6cd5\u5c06\u6570\u636e\u5199\u5165\u5230\u76f8\u5e94\u8282\u70b9\u4e2d","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u4e0e\u96c6\u7fa4\u7684\u533a\u522b\uff1a\u96c6\u7fa4\u8282\u70b9\u4e2d\u4fdd\u5b58 ",(0,i.jsx)(e.strong,{children:"\u76f8\u540c"})," \u7684\u6570\u636e\uff0c\u5206\u5e03\u5f0f\u8282\u70b9\u4e2d\u4fdd\u5b58 ",(0,i.jsx)(e.strong,{children:"\u4e0d\u540c"})," \u7684\u6570\u636e"]}),"\n",(0,i.jsxs)(e.li,{children:["\u4fee\u6539 ",(0,i.jsx)(e.code,{children:"redis.conf"}),"\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"cluster-enabled yes"}),"\uff1a\u5f00\u542f\u5206\u5e03\u5f0f\u7cfb\u7edf\u529f\u80fd"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"cluster-config-file <file-name>"}),"\uff1a\u6307\u5b9a\u4f7f\u7528\u7684\u914d\u7f6e\u6587\u4ef6"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u542f\u52a8\u540e\u6267\u884c ",(0,i.jsx)(e.code,{children:"redis-cli --cluster create --cluster-replicas <slave-num> <ip1> <ip2> \u2026"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"redis-cli cluster nodes"}),"\uff1a\u67e5\u770b\u7cfb\u7edf\u4e2d\u5404\u8282\u70b9\u7684\u5173\u7cfb\u4ee5\u53ca\u8fde\u63a5\u60c5\u51b5"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"9-docker-compose",children:"9 Docker Compose"}),"\n",(0,i.jsx)(e.h3,{id:"91-\u6982\u8ff0",children:"9.1 \u6982\u8ff0"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["Docker Compose\uff1aDocker\u5bb9\u5668\u7f16\u6392\u5de5\u5177\uff0c\u901a\u8fc7\u4e00\u4e2a ",(0,i.jsx)(e.strong,{children:"\u58f0\u660e\u5f0f\u7684\u914d\u7f6e\u6587\u4ef6"})," \u63cf\u8ff0\u6574\u4e2a\u5e94\u7528\uff0c\u6700\u7ec8\u4f7f\u7528\u4e00\u6761\u547d\u4ee4\u5b8c\u6210\u90e8\u7f72"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"compose.yml"})," / ",(0,i.jsx)(e.code,{children:"docker-compose.yml"}),"\uff1a6\u5927\u6a21\u5757","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"version"}),"\uff1a\uff08\u5df2\u8fc7\u65f6\uff09\u7248\u672c\u53f7"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"services"}),"\uff1a\u5b9a\u4e49\u548c\u521b\u5efa\u5e94\u7528\u4e2d\u65f6\u7528\u5230\u7684 ",(0,i.jsx)(e.strong,{children:"\u670d\u52a1"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yml",metastring:"showLineNumbers",children:'services:\n    <service-name>:\n        container_name: <service-real-name>\n        build:\n            context: <dockerfile-path>\n            dockerfile: <dockerfile-name>\n        image: <repository>:<tag>\n        ports:\n            - <host-port1>:<container-port1>\n            - <container-port2>\n            - \u2026\n        command:\n            - "<command>"\n        depends_on:\n            - <depend-service-name>\n        deploy:\n            mode: replicated\n            replicas: <container-number>\n        networks: <network-name>\n        volumes:\n            - <host-path1>:<container-path1>\n            - <volume-name>:<container-path2>\n            - \u2026\n'})}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"<service-name>"}),"\uff1a\u670d\u52a1\u6807\u8bc6/\u540d\u79f0"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"container_name"}),"\uff1a\u5bb9\u5668\u7684\u771f\u6b63\u540d\u79f0\uff0c\u7f3a\u7701\u751f\u6210\u4e3a ",(0,i.jsx)(e.code,{children:"<compose_dir>-<service-name>"})]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"build"}),"\uff1a\u6307\u5b9a\u521b\u5efa\u5f53\u524d\u670d\u52a1\u955c\u50cf\u7684Dockerfile\u8def\u5f84","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"context"}),"\uff1a\u6307\u5b9a\u7edd\u5bf9/\u76f8\u5bf9\u8def\u5f84"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"dockerfile"}),"\uff1a\u6307\u5b9a\u6587\u4ef6\u540d"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"image"}),"\uff1a\u6307\u5b9a\u5f53\u524d\u670d\u52a1\u6240\u9700\u8981\u4f7f\u7528\u7684\u955c\u50cf\uff08\u82e5\u8bbe\u7f6e\u4e86build\u5c5e\u6027\uff0c\u5219image\u5c5e\u6027\u4f1a\u8bbe\u5b9a\u6784\u5efa\u51fa\u7684\u955c\u50cf\u7684\u540d\u79f0\u4e0etag\uff09"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"ports"}),"\uff1a\u6620\u5c04\u7aef\u53e3\u5217\u8868\uff08\u82e5\u53ea\u8bbe\u7f6e\u4e86\u5bb9\u5668\u7aef\u53e3\uff0c\u5219\u66b4\u9732\u5230\u5bbf\u4e3b\u673a\u7684\u7aef\u53e3\u53f7\u4f1a\u88ab\u968f\u673a\u5206\u914d\uff09"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"command"}),"\uff1a\u542f\u52a8\u5bb9\u5668\u540e\u7acb\u5373\u8fd0\u884c\u7684\u547d\u4ee4\uff08\u4f1a\u8986\u76d6dockerfile\u4e2d\u7684 ",(0,i.jsx)(e.code,{children:"CMD"})," \u6307\u4ee4\uff09"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"depends_on"}),"\uff1a\u542f\u52a8\u6240\u4f9d\u8d56\u7684\u5e94\u7528\u5217\u8868"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"deploy"}),"\uff1a\u6307\u5b9a\u5f53\u524d\u670d\u52a1\u7684\u90e8\u7f72\u8bbe\u7f6e","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"mode"}),"\uff1a\u90e8\u7f72\u6a21\u5f0f"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"replicas"}),"\uff1a\u6307\u5b9a\u670d\u52a1\u542f\u52a8\u7684\u5bb9\u5668\u6570\u91cf\uff08\u6307\u5b9a\u8be5\u5c5e\u6027\u540e\uff0c\u4e0d\u80fd\u518d\u8bbe\u5b9a ",(0,i.jsx)(e.code,{children:"container_name"})," \u5c5e\u6027\uff09"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"networks"}),"\uff1a\u6307\u5b9a\u5f53\u524d\u670d\u52a1\u6240\u8981\u8fde\u63a5\u7684\u7f51\u7edc"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"volumes"}),"\uff1a\u6307\u5b9a\u5f53\u524d\u670d\u52a1\u7528\u5230\u7684\u6570\u636e\u5377\uff0c\u652f\u6301\u8def\u5f84\u548c\u6570\u636e\u5377\u6807\u8bc6\u4e24\u79cd\u5f62\u5f0f"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"networks"}),"\uff1a\u5b9a\u4e49\u548c\u521b\u5efa\u5e94\u7528\u4e2d\u65f6\u7528\u5230\u7684 ",(0,i.jsx)(e.strong,{children:"\u7f51\u7edc"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yml",metastring:"showLineNumbers",children:"networks:\n    <network-name>:\n        name: <network-real-name>\n        driver: bridge\n        attachable: false\n"})}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"<network-name>"}),"\uff1a\u7f51\u7edc\u6807\u8bc6/\u540d\u79f0"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"name"}),"\uff1a\u7f51\u7edc\u7684\u771f\u6b63\u540d\u79f0\uff0c\u7f3a\u7701\u751f\u6210\u4e3a ",(0,i.jsx)(e.code,{children:"<compose_dir>_<network-name>"})]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"driver"}),"\uff1a\u7f51\u7edc\u9a71\u52a8\uff0c\u7f3a\u7701\u4e3a ",(0,i.jsx)(e.code,{children:"bridge"})]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"attachable"}),"\uff1a\u662f\u5426\u5141\u8bb8\u5176\u5b83\u72ec\u7acb\u5bb9\u5668\u8fde\u63a5\u5230\u6b64\u7f51\u7edc\uff0c\u7f3a\u7701\u4e3a ",(0,i.jsx)(e.code,{children:"false"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"volumes"}),"\uff1a\u5b9a\u4e49\u548c\u521b\u5efa\u5e94\u7528\u4e2d\u65f6\u7528\u5230\u7684 ",(0,i.jsx)(e.strong,{children:"\u6570\u636e\u5377"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yml",metastring:"showLineNumbers",children:"volumes:\n    <volume-name>:\n        \u2026\n"})}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"<volume-name>"}),"\uff1a\u6570\u636e\u5377\u6807\u8bc6/\u540d\u79f0\uff08\u7cfb\u7edf\u4f1a\u81ea\u52a8\u5206\u914d\u5728docker\u5bb9\u5668\u4e2d\u7684\u5177\u4f53\u4f4d\u7f6e\uff09"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:"configs"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:"secrets"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"92-\u547d\u4ee4",children:"9.2 \u547d\u4ee4"}),"\n",(0,i.jsx)(e.admonition,{type:"tip",children:(0,i.jsxs)(e.p,{children:["\u5728\u547d\u4ee4\u540e\u52a0\u4e0a ",(0,i.jsx)(e.code,{children:"<service-name>"}),"\uff0c\u5373\u53ef\u5bf9\u6307\u5b9a\u670d\u52a1\u8fdb\u884c\u64cd\u4f5c"]})}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker-compose pull"}),"\uff1a\u62c9\u53d6compose\u4e2d\u9700\u8981\u7684\u6240\u6709\u955c\u50cf"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker-compose config"}),"\uff1a\u68c0\u67e5 ",(0,i.jsx)(e.code,{children:"docker-compose.yml"})," \u6587\u4ef6\u662f\u5426\u6b63\u786e","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"-q"}),"\uff1a\u5b58\u5728\u95ee\u9898\u65f6\u624d\u8f93\u51fa"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker-compose up"}),"\uff1a\u542f\u52a8compose\u4e2d\u7684\u6240\u6709\u670d\u52a1","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"-d"}),"\uff1a\u540e\u53f0\u542f\u52a8"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker-compose logs"}),"\uff1a\u67e5\u770bcompose\u4e2d\u6240\u6709\u670d\u52a1\u7684\u8fd0\u884c\u65e5\u5fd7\uff0c\u4e0d\u540c\u670d\u52a1\u7684\u65e5\u5fd7\u7528\u4e0d\u540c\u989c\u8272\u533a\u5206"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker-compose ps"}),"\uff1a\u67e5\u770bcompose\u4e2d\u7684\u6240\u6709\u670d\u52a1"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker-compose top"}),"\uff1a\u67e5\u770bcompose\u4e2d\u6240\u6709\u5f53\u524d\u6b63\u5728\u8fd0\u884c\u4e2d\u7684\u670d\u52a1"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker-compose images"}),"\uff1a\u67e5\u770bcompose\u4e2d\u6240\u6709\u670d\u52a1\u5bf9\u5e94\u7684\u955c\u50cf"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker-compose port"}),"\uff1a\u67e5\u770b\u6307\u5b9a\u670d\u52a1\u7684\u6620\u5c04\u7aef\u53e3"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker-compose run"}),"\uff1a\u5728\u6307\u5b9a\u670d\u52a1\u4e0a\u6267\u884c\u547d\u4ee4"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker-compose exec"}),"\uff1a\u8fdb\u5165\u6307\u5b9a\u670d\u52a1\u7684\u5bb9\u5668\u5185"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker-compose pause"}),"\uff1a\u6682\u505ccompose\u4e2d\u7684\u6240\u6709\u670d\u52a1\u7684\u5bb9\u5668"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker-compose unpause"}),"\uff1a\u6062\u590dcompose\u4e2d\u6240\u6709\u5904\u4e8e\u6682\u505c\u72b6\u6001\u7684\u670d\u52a1\u7684\u5bb9\u5668"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker-compose stop"}),"\uff1a\u505c\u6b62compose\u4e2d\u7684\u6240\u6709\u670d\u52a1"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker-compose restart"}),"\uff1a\u91cd\u542fcompose\u4e2d\u7684\u6240\u6709\u670d\u52a1"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker-compose start"}),"\uff1a\u542f\u52a8compose\u4e2d\u7684\u6240\u6709\u670d\u52a1"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker-compose kill"}),"\uff1a\u901a\u8fc7\u53d1\u9001 ",(0,i.jsx)(e.code,{children:"SIGKILL"})," \u4fe1\u53f7\u6765\u505c\u6b62\u6307\u5b9a\u670d\u52a1\u7684\u5bb9\u5668"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker-compose rm"}),"\uff1a\u5220\u9664compose\u4e2d\u6240\u6709\u5904\u4e8e\u505c\u6b62\u72b6\u6001\u7684\u670d\u52a1\u7684\u5bb9\u5668"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker-compose down"}),"\uff1a\u505c\u6b62\u5e76\u5220\u9664compose\u4e2d\u7684\u6240\u6709\u670d\u52a1\u5bb9\u5668\u3001\u7f51\u7edc\u3001\u955c\u50cf\u3001\u6570\u636e\u5377"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"10-docker\u7ba1\u7406\u76d1\u63a7\u5e73\u53f0",children:"10 Docker\u7ba1\u7406\u76d1\u63a7\u5e73\u53f0"}),"\n",(0,i.jsx)(e.h3,{id:"101-\u6982\u8ff0",children:"10.1 \u6982\u8ff0"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["Docker UI\uff1a\u57fa\u4e8eDocker API\u7684\u5f00\u6e90\u53ef\u89c6\u5316\u7ba1\u7406\u5de5\u5177\uff0c\u652f\u6301\u5bb9\u5668\u7ba1\u7406\u3001\u955c\u50cf\u7ba1\u7406\u3001\u6279\u91cf\u64cd\u4f5c\uff0c\u4e0d\u652f\u6301\u591a\u96c6\u7fa4\u7ba1\u7406","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u90e8\u7f72\u547d\u4ee4\uff1a",(0,i.jsx)(e.code,{children:"docker run -d uifd/ui-for-docker"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["Portainer\uff1a\u514d\u8d39\u7684\u53ef\u89c6\u5316\u7ba1\u7406\u5de5\u5177\uff0c\u57fa\u4e8e\u5bb9\u5668\u5316\u7684\u5b89\u88c5\u65b9\u5f0f\uff0c\u652f\u6301\u6784\u5efa\u3001\u7ba1\u7406\u548c\u7ef4\u62a4Docker\u73af\u5883","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u90e8\u7f72\u547d\u4ee4\uff1a",(0,i.jsx)(e.code,{children:"docker run -d portainer/portainer-ce"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["shipyard\uff1a\u5efa\u7acb\u5728docker\u96c6\u7fa4\u7ba1\u7406\u5de5\u5177Citadel\u4e4b\u4e0a\u7684\u53ef\u89c6\u5316\u7ba1\u7406\u5de5\u5177\uff0c\u652f\u6301\u955c\u50cf\u7ba1\u7406\u3001\u5bb9\u5668\u7ba1\u7406\u3001\u4e3b\u673a\u7ba1\u7406","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u7248\u672c\uff1a","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"core\uff1a\u7edf\u4e00\u7ba1\u7406\u591a\u4e2adocker host\u4e0a\u7684containers\uff0c\u652f\u6301\u8de8host"}),"\n",(0,i.jsx)(e.li,{children:"extension\uff1a\u65b0\u589e\u4e86\u5e94\u7528\u8def\u7531\u3001\u8d1f\u8f7d\u5747\u8861\u3001\u96c6\u4e2d\u5316\u65e5\u5fd7\u3001\u90e8\u7f72\u7b49"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.li,{children:"\u90e8\u7f72\uff1a\u6267\u884c\u81ea\u52a8\u90e8\u7f72\u811a\u672c\uff0c\u6309\u7167\u811a\u672c\u8fd0\u884c\u7ed3\u679c\u4e2d\u7ed9\u51fa\u7684\u8bbf\u95ee\u5730\u5740\u548c\u8d26\u5bc6\u8fdb\u884c\u64cd\u4f5c"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["CIG\u76d1\u63a7\u7cfb\u7edf\uff1a\u5305\u542bCAdvisor\uff08\u6536\u96c6\u76d1\u63a7\u6570\u636e\uff09\u3001InfluxDB\uff08\u5b58\u50a8\u6570\u636e\uff09\u3001Grafana\uff08\u5c55\u793a\u6570\u636e\uff09\u4e09\u4e2a\u5e94\u7528","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"CAdvisor\uff1a\u7528\u6765\u5206\u6790\u8fd0\u884c\u4e2d\u7684Docker\u5bb9\u5668\u7684\u8d44\u6e90\u5360\u7528\u4ee5\u53ca\u6027\u80fd\u7279\u6027\u7684\u5de5\u5177\uff0c\u76d1\u63a7\u5bb9\u5668\u7684\u5185\u5bb9\u3001CPU\u3001\u7f51\u7edc\u3001\u78c1\u76d8IO\u7b49\uff0c\u5e76\u6709web\u9875\u9762\u5c55\u793a\u76d1\u63a7\u6570\u636e"}),"\n",(0,i.jsx)(e.li,{children:"InfluxDB\uff1a\u57fa\u4e8eGO\u8bed\u8a00\u7684\u3001\u5f00\u6e90\u7684\u9ad8\u6027\u80fd\u3001\u65f6\u5e8f\u578b\u6570\u636e\u5e93\uff0c\u652f\u6301\u6d77\u91cf\u65f6\u5e8f\u6570\u636e\u7684\u9ad8\u6027\u80fd\u8bfb\u5199\u3001\u9ad8\u6548\u5b58\u50a8\u3001\u5b9e\u65f6\u5206\u6790\u7b49"}),"\n",(0,i.jsx)(e.li,{children:"Grafana\uff1a\u57fa\u4e8eGO\u8bed\u8a00\u7684\u3001\u5f00\u6e90\u7684\u65f6\u5e8f\u6570\u636e\u76d1\u63a7\u5206\u6790\u53ef\u89c6\u5316\u5e73\u53f0"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"11-\u955c\u50cf\u4e2d\u5fc3",children:"11 \u955c\u50cf\u4e2d\u5fc3"}),"\n",(0,i.jsx)(e.h3,{id:"111-\u6982\u8ff0",children:"11.1 \u6982\u8ff0"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u53d1\u5e03\u955c\u50cf\u5230Docker Hub\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["Docker Hub\u7aef\u64cd\u4f5c\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"\u6ce8\u518c\u8d26\u53f7"}),"\n",(0,i.jsx)(e.li,{children:"\u624b\u52a8\u521b\u5efa\u955c\u50cf\u4ed3\u5e93\uff08\u53ef\u8df3\u8fc7\uff09"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u670d\u52a1\u5668\u7aef\u64cd\u4f5c\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u767b\u5f55\uff1a",(0,i.jsx)(e.code,{children:"docker login --username=<username> --password=<password>"})]}),"\n",(0,i.jsxs)(e.li,{children:["\u5bf9\u8981\u53d1\u5e03\u7684\u955c\u50cf\u8fdb\u884c\u547d\u540d\uff08\u6839\u636e\u955c\u50cf\u4ed3\u5e93\u540d\u79f0\u81ea\u52a8\u521b\u5efa\uff09\uff1a",(0,i.jsx)(e.code,{children:"docker tag <image-name> <username>/<respository-name>:<tag>"})]}),"\n",(0,i.jsxs)(e.li,{children:["\u63a8\u9001\u955c\u50cf\u81f3Docker Hub\uff1a",(0,i.jsx)(e.code,{children:"docker push <username>/<respository-name>:<tag>"})]}),"\n",(0,i.jsxs)(e.li,{children:["\u767b\u51fa\uff1a",(0,i.jsx)(e.code,{children:"docker logout"})]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u53d1\u5e03\u955c\u50cf\u5230\u963f\u91cc\u4e91\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u963f\u91cc\u4e91\u7aef\u64cd\u4f5c\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"\u6ce8\u518c\u8d26\u53f7"}),"\n",(0,i.jsxs)(e.li,{children:["\u624b\u52a8\u521b\u5efa ",(0,i.jsx)(e.strong,{children:"\u547d\u540d\u7a7a\u95f4"}),"\uff08\u5bf9\u955c\u50cf\u4ed3\u5e93\u5206\u7c7b\uff09"]}),"\n",(0,i.jsx)(e.li,{children:"\u624b\u52a8\u521b\u5efa\u955c\u50cf\u4ed3\u5e93\uff08\u53ef\u8df3\u8fc7\uff09"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.li,{children:"\u670d\u52a1\u5668\u7aef\u64cd\u4f5c\uff1a\u540c\u4e0a"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u7f51\u7edc\u4f20\u8f93\u534f\u8bae\uff1a","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["HTTP\u534f\u8bae\uff1a\u9ed8\u8ba4\u4f7f\u7528 ",(0,i.jsx)(e.strong,{children:"80"})," \u7aef\u53e3","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u660e\u6587\u4f20\u8f93\uff1a\u76f4\u63a5\u4e0e\u4f20\u8f93\u5c42\u7684TCP\u8fdb\u884c\u901a\u4fe1"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["HTTPS\u534f\u8bae\uff1a\u9ed8\u8ba4\u4f7f\u7528 ",(0,i.jsx)(e.strong,{children:"443"})," \u7aef\u53e3"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u901a\u4fe1\u52a0\u5bc6\u7684\u4e0d\u540c\u65b9\u5f0f\u53ca\u5176\u539f\u7406\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u6570\u5b57\u7b7e\u540d"})," \u52a0\u5bc6\uff1a","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u5b58\u5728\u7684\u95ee\u9898\uff1a",(0,i.jsx)(e.code,{children:"1"})," \u548c ",(0,i.jsx)(e.code,{children:"3"})," \u8fc7\u7a0b\u4e2d\u4fe1\u606f\u53ef\u80fd\u4f1a\u88ab\u7a83\u53d6\u6216\u7be1\u6539","\n",(0,i.jsx)(e.mermaid,{value:"sequenceDiagram\nautonumber\nA->>B: \u53d1\u9001\u8bf7\u6c42\nB->>B: \u6309\u7167\u8bf7\u6c42\u64cd\u4f5c\nB--\x3e>A: \u8fd4\u56de\u54cd\u5e94\nA->>A: \u6309\u7167\u54cd\u5e94\u8c03\u6574"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u89e3\u51b3\u65b9\u6848\uff1a","\n",(0,i.jsx)(e.mermaid,{value:"sequenceDiagram\nautonumber\nalt \u5efa\u7acb\u901a\u4fe1\u5173\u7cfb\n    A->>B: \u7533\u8bf7\u5efa\u7acb\u901a\u4fe1\u5173\u7cfb\n    B->>B: \u751f\u6210\u516c\u79c1\u94a5\n    B--\x3e>A: \u53d1\u9001\u516c\u94a5\n    A->>A: \u4fdd\u5b58\u516c\u94a5\nend\nautonumber 1\nalt \u901a\u4fe1\n    A->>A: \u7528\u516c\u94a5\u52a0\u5bc6\u8bf7\u6c42\n    A->>B: \u53d1\u9001 \u52a0\u5bc6\u540e\u7684 \u8bf7\u6c42\n    B->>B: \u7528\u79c1\u94a5\u89e3\u5bc6\u8bf7\u6c42\n    B->>B: \u6309\u7167\u8bf7\u6c42\u64cd\u4f5c\n    B->>B: \u7528\u79c1\u94a5\u52a0\u5bc6\u54cd\u5e94\uff0c\u5f62\u6210\u6570\u5b57\u7b7e\u540d\n    B--\x3e>A: \u8fd4\u56de \u643a\u5e26\u6570\u5b57\u7b7e\u540d\u7684 \u54cd\u5e94\n    A->>+A: \u7528\u516c\u94a5\u89e3\u5bc6\u6570\u5b57\u7b7e\u540d\n    A->>-A: \u5c06\u7ed3\u679c\u4e0e\u54cd\u5e94\u660e\u6587\u5bf9\u6bd4\uff0c\u67e5\u770b\u54cd\u5e94\u662f\u5426\u88ab\u7be1\u6539\nend"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u6570\u5b57\u8bc1\u4e66"})," \u52a0\u5bc6\uff1a","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u5b58\u5728\u7684\u95ee\u9898\uff1a","\n",(0,i.jsx)(e.mermaid,{value:"sequenceDiagram\nparticipant A\nparticipant \u52ab\u6301\u8005\nparticipant B\nA-xB: \u53d1\u9001\u8bf7\u6c42\uff0c\u88ab\u52ab\u6301\n\u52ab\u6301\u8005->>+\u52ab\u6301\u8005: \u751f\u6210\u516c\u79c1\u94a5\u3001\u5730\u5740\n\u52ab\u6301\u8005->>-B: \u5c06A\u7684\u516c\u94a5\u548c\u5730\u5740\u6362\u6210\u81ea\u5df1\u7684\n\u52ab\u6301\u8005->>B: \u4f2a\u88c5\u6210A\uff0c\u53d1\u9001\u81ea\u5df1\u7684\u8bf7\u6c42\nB--\x3e>\u52ab\u6301\u8005: \u8ba4\u4e3a\u662fA\uff0c\u8fd4\u56de\u54cd\u5e94"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u89e3\u51b3\u65b9\u6848\uff1a","\n",(0,i.jsx)(e.mermaid,{value:"sequenceDiagram\nparticipant A\nparticipant B\nparticipant \u8bc1\u4e66\u4e2d\u5fc3CA\nautonumber\nalt \u6784\u5efa\u901a\u4fe1\u57fa\u7840 = \u83b7\u53d6\u6570\u5b57\u8bc1\u4e66\n    B->>B: \u751f\u6210\u516c\u79c1\u94a5\n    B->>\u8bc1\u4e66\u4e2d\u5fc3CA: \u53d1\u9001\u4e2a\u4eba\u4fe1\u606f\u548c\u516c\u94a5\n    \u8bc1\u4e66\u4e2d\u5fc3CA->>\u8bc1\u4e66\u4e2d\u5fc3CA: \u7528CA\u79c1\u94a5\u5bf9B\u7684\u4e2a\u4eba\u4fe1\u606f\u548c\u516c\u94a5\u8fdb\u884c\u52a0\u5bc6\uff0c\u5f62\u6210\u6570\u5b57\u8bc1\u4e66\n    \u8bc1\u4e66\u4e2d\u5fc3CA--\x3e>B: \u53d1\u9001\u6570\u5b57\u8bc1\u4e66\u548cCA\u516c\u94a5\n    B->>B: \u4fdd\u5b58\u6570\u5b57\u8bc1\u4e66\u548cCA\u516c\u94a5\nend\nautonumber 1\nalt \u5efa\u7acb\u901a\u4fe1\u5173\u7cfb\n    A->>B: \u7533\u8bf7\u5efa\u7acb\u901a\u4fe1\u5173\u7cfb\n    B--\x3e>A: \u53d1\u9001\u6570\u5b57\u8bc1\u4e66\u548cCA\u516c\u94a5\n    A->>A: \u7528CA\u516c\u94a5\u89e3\u5bc6\u6570\u5b57\u8bc1\u4e66\n    A->>A: \u4fdd\u5b58B\u7684\u4e2a\u4eba\u4fe1\u606f\u548c\u516c\u94a5\u3001CA\u516c\u94a5\nend\nautonumber 1\nalt \u63e1\u624b\n    A->>B: \u7533\u8bf7\u5efa\u7acb\u901a\u4fe1\u8fde\u63a5\n    B--\x3e>A: \u53d1\u9001\u6570\u5b57\u8bc1\u4e66\n    A->>A: \u7528\u672c\u5730\u4fdd\u5b58\u7684CA\u516c\u94a5\u89e3\u5bc6\u6570\u5b57\u8bc1\u4e66\n    A->>A: \u5c06\u7ed3\u679c\u4e0e\u672c\u5730\u4fdd\u5b58\u7684\u4fe1\u606f\u5bf9\u6bd4\uff0c\u9a8c\u8bc1\u901a\u4fe1\u5bf9\u65b9\u7684\u8eab\u4efd\nelse \u901a\u4fe1\n    A->>A: \u7528\u516c\u94a5\u52a0\u5bc6\u8bf7\u6c42\n    A->>B: \u53d1\u9001 \u52a0\u5bc6\u540e\u7684 \u8bf7\u6c42\n    B->>B: \u7528\u79c1\u94a5\u89e3\u5bc6\u8bf7\u6c42\n    B->>B: \u6309\u7167\u8bf7\u6c42\u64cd\u4f5c\n    B->>B: \u7528\u79c1\u94a5\u52a0\u5bc6\u54cd\u5e94\uff0c\u5f62\u6210\u6570\u5b57\u7b7e\u540d\n    B--\x3e>A: \u8fd4\u56de \u643a\u5e26\u6570\u5b57\u7b7e\u540d\u7684 \u54cd\u5e94\n    A->>+A: \u7528\u672c\u5730\u4fdd\u5b58\u7684CA\u516c\u94a5\u89e3\u5bc6\u6570\u5b57\u8bc1\u4e66\n    A->>-A: \u5c06\u7ed3\u679c\u4e0e\u672c\u5730\u4fdd\u5b58\u7684\u4fe1\u606f\u5bf9\u6bd4\uff0c\u8ba4\u8bc1\u901a\u4fe1\u5bf9\u65b9\n    A->>+A: \u7528\u516c\u94a5\u89e3\u5bc6\u6570\u5b57\u7b7e\u540d\n    A->>-A: \u5c06\u7ed3\u679c\u4e0e\u54cd\u5e94\u660e\u6587\u5bf9\u6bd4\uff0c\u67e5\u770b\u54cd\u5e94\u662f\u5426\u88ab\u7be1\u6539\nend"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"htpasswd"})," \u547d\u4ee4\uff1a\u901a\u8fc7\u8be5\u547d\u4ee4\u6765\u5b9e\u73b0 ",(0,i.jsx)(e.strong,{children:"Registry\u79c1\u6709\u955c\u50cf\u4e2d\u5fc3"})," \u7684\u7528\u6237\u8ba4\u8bc1","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u5b89\u88c5 ",(0,i.jsx)(e.code,{children:"httpd-tools"})," \u5de5\u5177\u5305\uff1a",(0,i.jsx)(e.code,{children:"yum install -y httpd-tools"})]}),"\n",(0,i.jsxs)(e.li,{children:["\u521b\u5efa\u8ba4\u8bc1\u6587\u4ef6\uff1a",(0,i.jsx)(e.code,{children:"htpasswd -c htpasswd.user"})]}),"\n",(0,i.jsxs)(e.li,{children:["\u6dfb\u52a0\u7528\u6237\uff1a",(0,i.jsx)(e.code,{children:"htpasswd -Bb <filename> <username> <password>"})]}),"\n",(0,i.jsxs)(e.li,{children:["\u5220\u9664\u7528\u6237\uff1a",(0,i.jsx)(e.code,{children:"htpasswd -D <filename> <username>"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u5bb9\u5668\u7684 ",(0,i.jsx)(e.strong,{children:"\u9000\u51fa\u72b6\u6001\u7801"}),"\uff1a\u7528\u6765\u53cd\u9988\u5bb9\u5668\u4e2d\u7684\u5e94\u7528\u7684\u9000\u51fa\u65b9\u5f0f\uff0c\u4f7f\u7528 ",(0,i.jsx)(e.code,{children:"docker ps -a"})," \u6216 ",(0,i.jsx)(e.code,{children:"docker inspect"})," \u547d\u4ee4\u6765\u67e5\u770b","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"0"}),"\uff1a\u5e94\u7528\u6b63\u5e38\u9000\u51fa\uff0c\u5982\u4f7f\u7528 ",(0,i.jsx)(e.code,{children:"docker stop"})," \u547d\u4ee4\uff0c\u6216\u5173\u95eddocker\u5f15\u64ce"]}),"\n",(0,i.jsxs)(e.li,{children:["[1, 128]\u8303\u56f4\uff1a",(0,i.jsx)("mark",{children:"\u5bb9\u5668\u5185\u90e8\u8fd0\u884c\u9519\u8bef\u6216\u5e94\u7528\u8fd0\u884c\u51fa\u9519"}),"\u5f15\u53d1\u7684\u5bb9\u5668\u65e0\u6cd5\u542f\u52a8\u7684\u975e\u6b63\u5e38\u9000\u51fa\u72b6\u6001","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"1"}),"\uff1a\u5e94\u7528\u7a0b\u5e8f\u5185\u90e8\u9519\u8bef\uff1bDockerfile\u4e2d\u7684\u65e0\u6548\u5f15\u7528"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"125"}),"\uff1aDockerfile\u4e2d\u5b9a\u4e49\u7684 ",(0,i.jsx)(e.code,{children:"command"})," \u7531\u4e8e\u5f15\u7528\u4e86\u672a\u5b9a\u4e49\u7684\u53d8\u91cf\u3001\u6216\u8005\u662f\u6267\u884c\u4e86\u6ca1\u6709\u6743\u9650\u7684\u547d\u4ee4\u800c\u6ca1\u6709\u8fd0\u884c\u6210\u529f"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"126"}),"\uff1aDockerfile\u4e2d\u5b9a\u4e49\u7684 ",(0,i.jsx)(e.code,{children:"command"})," \u7531\u4e8e\u7f3a\u5c11\u4f9d\u8d56\u800c\u6ca1\u6709\u8fd0\u884c\u6210\u529f"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"127"}),"\uff1aDockerfile\u4e2d\u5b9a\u4e49\u7684 ",(0,i.jsx)(e.code,{children:"command"})," \u7531\u4e8e\u5f15\u7528\u4e86\u4e0d\u5b58\u5728\u7684\u6587\u4ef6\u6216\u76ee\u5f55\u800c\u6ca1\u6709\u8fd0\u884c\u6210\u529f"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"128"}),"\uff1a\u81ea\u5df1\u5f00\u53d1\u7684\u5bb9\u5668\u5185\u89e6\u53d1\u4e86\u9000\u51fa\u547d\u4ee4\u5e76\u7ed9\u51fa\u4e86\u9000\u51fa\u72b6\u6001\u7801\uff0c\u4f46\u72b6\u6001\u7801\u4e0d\u57280-255\u8303\u56f4\u5185"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["[129, 255]\u8303\u56f4\uff1a",(0,i.jsx)("mark",{children:"\u5bb9\u5668\u63a5\u6536\u5230\u7ec8\u6b62\u4fe1\u53f7"}),"\u7684\u975e\u6b63\u5e38\u9000\u51fa\u72b6\u6001","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"130"}),"\uff1a\u6765\u81ea\u64cd\u4f5c\u7cfb\u7edf\u7684\u7ec8\u6b62\u4fe1\u53f7\uff0c\u5982 ",(0,i.jsx)(e.code,{children:"ctrl + c"})]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"137"}),"\uff1a\u6765\u81eadockerd\u7684\u5f3a\u5236\u7ec8\u6b62\u4fe1\u53f7\uff0c\u5982 ",(0,i.jsx)(e.code,{children:"docker kill"})]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"143"}),"\uff1a\u6765\u81eadockerd\u7684\u4f18\u96c5\u7ec8\u6b62\u4fe1\u53f7\uff0c\u5982 ",(0,i.jsx)(e.code,{children:"docker stop"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u82e5\u5f53\u524d\u6ca1\u6709\u7528\u6237\u8bbf\u95ee\uff0c\u5219\u5bb9\u5668\u7acb\u5373\u9000\u51fa \u2192 143"}),"\n",(0,i.jsx)(e.li,{children:"\u82e5\u5f53\u524d\u6709\u7528\u6237\u8bbf\u95ee\uff0c\u5219\u7b49\u5f8510\u79d2\u540e\u518dkill\u5bb9\u5668 \u2192 137"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u5bb9\u5668\u7684\u91cd\u542f\u7b56\u7565\uff1a\u5728\u521b\u5efa\u5bb9\u5668\u65f6\u6307\u5b9a ",(0,i.jsx)(e.code,{children:"--restart <policy>"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"no"}),"\uff1a\uff08\u9ed8\u8ba4\uff09\u4e0d\u91cd\u542f"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"on-failure[:n]"}),"\uff1a\u5728\u5bb9\u5668\u975e\u6b63\u5e38\u9000\u51fa\u65f6\u91cd\u542f","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"n"}),"\uff1a\u91cd\u542f\u6b21\u6570"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"always"}),"\uff1a\u53ea\u8981\u5bb9\u5668\u9000\u51fa\u5c31\u91cd\u542f"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"unless-stopped"}),"\uff1a\u9664\u4e86\u901a\u8fc7 ",(0,i.jsx)(e.code,{children:"docker stop"})," \u6216 ",(0,i.jsx)(e.code,{children:"docker kill"})," \u547d\u4ee4\u9000\u51fa\uff0c\u5176\u4ed6\u60c5\u51b5\u53ea\u8981\u5bb9\u5668\u9000\u51fa\u5c31\u91cd\u542f"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"112-https",children:"11.2 HTTPS"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u901a\u8fc7SSL/TLS\u4e3a\u6570\u636e\u52a0\u5bc6\uff1a\u4e0e\u4f20\u8f93\u5c42\u7684SSL/TLS\u8fdb\u884c\u901a\u4fe1\uff0c\u518d\u7531SSL/TLS\u4e0eTCP\u8fdb\u884c\u901a\u4fe1","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"SSL\uff08Secure Sockets Layer\uff09\uff1a\u5b89\u5168\u5957\u63a5\u5b57\u534f\u8bae"}),"\n",(0,i.jsx)(e.li,{children:"TLS\uff08Transport Layer Security\uff09\uff1a\u4f20\u8f93\u5c42\u5b89\u5168\u534f\u8bae"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u8eab\u4efd\u9a8c\u8bc1\uff1a",(0,i.jsx)(e.strong,{children:"\u975e\u5bf9\u79f0\u52a0\u5bc6"})," \u9a8c\u8bc1\u65b9\u5f0f\uff08\u52a0\u5bc6\u548c\u89e3\u5bc6\u7684\u5bc6\u94a5\u4e0d\u540c\uff0c\u5305\u542b\u56e0\u5b50\u5206\u89e3\u3001\u79bb\u6563\u5bf9\u6570\u3001\u692d\u5706\u66f2\u7ebf\u4e09\u79cd\u7b97\u6cd5\uff09","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u4e00\u5bf9\u5bc6\u94a5\uff1a\u4e00\u4e2a\u7528\u4e8e\u52a0\u5bc6\uff0c\u4e00\u4e2a\u7528\u4e8e\u89e3\u5bc6","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u516c\u94a5\uff1a\u53ef\u516c\u5f00\u7684\u5bc6\u94a5\uff0c\u53d1\u653e\u7ed9\u5176\u4ed6\u4eba"}),"\n",(0,i.jsx)(e.li,{children:"\u79c1\u94a5\uff1a\u975e\u516c\u5f00\u7684\u5bc6\u94a5\uff0c\u53ea\u6709\u52a0\u5bc6\u8005\u81ea\u5df1\u4fdd\u5b58"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u7528\u9014\uff1a","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u4fe1\u606f\u52a0\u89e3\u5bc6\uff1a\u516c\u94a5\u52a0\u5bc6\u3001\u79c1\u94a5\u89e3\u5bc6"}),"\n",(0,i.jsx)(e.li,{children:"\u6570\u5b57\u7b7e\u540d\u4e0e\u8ba4\u8bc1\uff1a\u79c1\u94a5\u52a0\u5bc6\u3001\u516c\u94a5\u89e3\u5bc6"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u4f20\u8f93\u52a0\u5bc6\uff1a",(0,i.jsx)(e.strong,{children:"\u5bf9\u79f0\u52a0\u5bc6"})," \u9a8c\u8bc1\u65b9\u5f0f\uff08\u52a0\u5bc6\u548c\u89e3\u5bc6\u7684\u5bc6\u94a5\u76f8\u540c\uff09"]}),"\n",(0,i.jsxs)(e.li,{children:["\u539f\u7406\u56fe\uff1a","\n",(0,i.jsx)(e.mermaid,{value:"sequenceDiagram\nparticipant \u5ba2\u6237\u7aef\nparticipant \u670d\u52a1\u7aef\nparticipant \u8bc1\u4e66\u4e2d\u5fc3CA\nalt \u8eab\u4efd\u9a8c\u8bc1\n    autonumber\n    alt \u6784\u5efa\u901a\u4fe1\u57fa\u7840 = \u83b7\u53d6\u6570\u5b57\u8bc1\u4e66\n        \u670d\u52a1\u7aef->>\u670d\u52a1\u7aef: \u751f\u6210\u516c\u79c1\u94a5\n        \u670d\u52a1\u7aef->>\u8bc1\u4e66\u4e2d\u5fc3CA: \u53d1\u9001\u670d\u52a1\u7aef\u4fe1\u606f\u548c\u516c\u94a5\n        \u8bc1\u4e66\u4e2d\u5fc3CA->>\u8bc1\u4e66\u4e2d\u5fc3CA: \u7528CA\u79c1\u94a5\u5bf9\u670d\u52a1\u7aef\u7684\u4fe1\u606f\u548c\u516c\u94a5\u8fdb\u884c\u52a0\u5bc6\uff0c\u5f62\u6210\u6570\u5b57\u8bc1\u4e66\n        \u8bc1\u4e66\u4e2d\u5fc3CA--\x3e>\u670d\u52a1\u7aef: \u53d1\u9001\u6570\u5b57\u8bc1\u4e66\u548cCA\u516c\u94a5\n        \u670d\u52a1\u7aef->>\u670d\u52a1\u7aef: \u4fdd\u5b58\u6570\u5b57\u8bc1\u4e66\u548cCA\u516c\u94a5\n    end\nend\nalt \u4f20\u8f93\u52a0\u5bc6\n    autonumber 1\n    alt \u5efa\u7acb\u901a\u4fe1\u5173\u7cfb\n        \u5ba2\u6237\u7aef->>\u670d\u52a1\u7aef: \u7533\u8bf7\u5efa\u7acb\u901a\u4fe1\u5173\u7cfb\n        \u670d\u52a1\u7aef--\x3e>\u5ba2\u6237\u7aef: \u53d1\u9001\u6570\u5b57\u8bc1\u4e66\u548cCA\u516c\u94a5\n        \u5ba2\u6237\u7aef->>\u5ba2\u6237\u7aef: \u7528CA\u516c\u94a5\u89e3\u5bc6\u6570\u5b57\u8bc1\u4e66\n        \u5ba2\u6237\u7aef->>\u5ba2\u6237\u7aef: \u4fdd\u5b58\u670d\u52a1\u7aef\u7684\u4fe1\u606f\u548c\u516c\u94a5\u3001CA\u516c\u94a5\n        \u5ba2\u6237\u7aef->>\u5ba2\u6237\u7aef: \u751f\u6210\u4e00\u4e2a\u968f\u673a\u6570\u4f5c\u4e3a\u5bc6\u94a5\uff0c\u5e76\u7528\u670d\u52a1\u7aef\u7684\u516c\u94a5\u52a0\u5bc6\u5bc6\u94a5\n        \u5ba2\u6237\u7aef->>\u670d\u52a1\u7aef: \u53d1\u9001 \u52a0\u5bc6\u540e\u7684 \u5bc6\u94a5\n        \u670d\u52a1\u7aef->>\u670d\u52a1\u7aef: \u7528\u79c1\u94a5\u89e3\u5bc6\u5bc6\u94a5\u5e76\u4fdd\u5b58\n    end\n    autonumber 1\n    alt \u63e1\u624b\n        \u5ba2\u6237\u7aef->>\u670d\u52a1\u7aef: \u7533\u8bf7\u5efa\u7acb\u901a\u4fe1\u8fde\u63a5\n        \u670d\u52a1\u7aef--\x3e>\u5ba2\u6237\u7aef: \u53d1\u9001\u6570\u5b57\u8bc1\u4e66\n        \u5ba2\u6237\u7aef->>\u5ba2\u6237\u7aef: \u7528\u672c\u5730\u4fdd\u5b58\u7684CA\u516c\u94a5\u89e3\u5bc6\u6570\u5b57\u8bc1\u4e66\n        \u5ba2\u6237\u7aef->>\u5ba2\u6237\u7aef: \u5c06\u7ed3\u679c\u4e0e\u672c\u5730\u4fdd\u5b58\u7684\u4fe1\u606f\u5bf9\u6bd4\uff0c\u9a8c\u8bc1\u901a\u4fe1\u5bf9\u65b9\u7684\u8eab\u4efd\n    else \u901a\u4fe1\n        \u5ba2\u6237\u7aef->>\u5ba2\u6237\u7aef: \u7528\u5bc6\u94a5\u52a0\u5bc6\u8bf7\u6c42\n        \u5ba2\u6237\u7aef->>\u670d\u52a1\u7aef: \u53d1\u9001 \u52a0\u5bc6\u540e\u7684 \u8bf7\u6c42\n        \u670d\u52a1\u7aef->>\u670d\u52a1\u7aef: \u7528\u5bc6\u94a5\u89e3\u5bc6\u8bf7\u6c42\n        \u670d\u52a1\u7aef->>\u670d\u52a1\u7aef: \u6309\u7167\u8bf7\u6c42\u64cd\u4f5c\n        \u670d\u52a1\u7aef->>\u670d\u52a1\u7aef: \u7528\u5bc6\u94a5\u52a0\u5bc6\u54cd\u5e94\uff0c\u5f62\u6210\u5bc6\u6587\n        \u670d\u52a1\u7aef--\x3e>\u5ba2\u6237\u7aef: \u8fd4\u56de \u643a\u5e26\u5bc6\u6587\u7684 \u54cd\u5e94\n        \u5ba2\u6237\u7aef->>+\u5ba2\u6237\u7aef: \u7528\u5bc6\u94a5\u89e3\u5bc6\u5bc6\u6587\n        \u5ba2\u6237\u7aef->>-\u5ba2\u6237\u7aef: \u5c06\u7ed3\u679c\u4e0e\u54cd\u5e94\u660e\u6587\u5bf9\u6bd4\uff0c\u67e5\u770b\u54cd\u5e94\u662f\u5426\u88ab\u7be1\u6539\n    end\nend"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u91cd\u8981\u6982\u5ff5\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u6570\u5b57\u8bc1\u4e66\uff08SSL/TLS\u8bc1\u4e66\uff09\uff1a\u7531\u8bc1\u4e66\u4e2d\u5fc3CA\uff08Certificate Authority\uff09\u9881\u53d1\u7684\u4e00\u79cd\u8eab\u4efd\u8bc1\u660e\uff0c\u5305\u542b\u901a\u8baf\u65b9\u7684\u516c\u94a5\u3001\u8bc1\u4e66\u6709\u6548\u671f\u3001\u57df\u540d\u4ee5\u53caCA\u7684\u6570\u5b57\u7b7e\u540d","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u53ef\u81ea\u5df1\u751f\u6210\uff0c\u4f46\u9700\u8981\u5728\u901a\u8baf\u5ba2\u6237\u7aef\u5b89\u88c5\u6570\u5b57\u8bc1\u4e66\uff0c\u5e76\u6dfb\u52a0\u4fe1\u4efb\u72b6\u6001\u624d\u53ef\u901a\u8baf"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.li,{children:"\u6839\u8bc1\u4e66\uff1a\u7528\u6765\u89e3\u5bc6\u6570\u5b57\u8bc1\u4e66\u7684CA\u516c\u94a5"}),"\n",(0,i.jsxs)(e.li,{children:["\u6570\u5b57\u6458\u8981\uff1a\u5229\u7528Hash\u51fd\u6570\u7684\u5355\u5411\u6027\uff0c\u5c06\u4efb\u610f\u957f\u5ea6\u7684\u6d88\u606f\u53d8\u6210\u56fa\u5b9a\u957f\u5ea6\u7684\u77ed\u6d88\u606f","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u4e0d\u540c\u660e\u6587\u7684\u6458\u8981\u4e00\u5b9a\u4e0d\u540c\uff0c\u76f8\u540c\u660e\u6587\u7684\u6458\u8981\u4e00\u5b9a\u76f8\u540c"}),"\n",(0,i.jsx)(e.li,{children:"\u65e0\u6cd5\u901a\u8fc7\u6458\u8981\u8ba1\u7b97\u51fa\u539f\u59cb\u660e\u6587"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.li,{children:"\u6570\u5b57\u7b7e\u540d\uff1a\u7531\u53d1\u9001\u65b9\u4ea7\u751f\u7684\u522b\u4eba\u65e0\u6cd5\u4f2a\u9020\u7684\u4e00\u6bb5\u6570\u5b57\u4e32\uff0c\u901a\u5e38\u4f7f\u7528\u975e\u5bf9\u79f0\u5bc6\u94a5\u548c\u6570\u5b57\u6458\u8981\u6280\u672f"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"113-distribution\u79c1\u6709\u955c\u50cf\u4e2d\u5fc3",children:"11.3 distribution\u79c1\u6709\u955c\u50cf\u4e2d\u5fc3"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u642d\u5efa\u79c1\u6709\u955c\u50cf\u4e2d\u5fc3\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u5b89\u88c5 ",(0,i.jsx)(e.code,{children:"docker-distribution"}),"\uff1a",(0,i.jsx)(e.code,{children:"yum install -y docker-distribution"})]}),"\n",(0,i.jsxs)(e.li,{children:["\u67e5\u770b\u5b89\u88c5\u7684\u6587\u4ef6\uff1a",(0,i.jsx)(e.code,{children:"rpm -ql docker-distribution"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"/etc/docker-distribution/registry/config.yml"}),"\uff1a\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"/usr/bin/registry"}),"\uff1a",(0,i.jsx)(e.code,{children:"registry"})," \u547d\u4ee4"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"/usr/lib/systemd/system/docker-distribution.service"}),"\uff1a\u8868\u793a ",(0,i.jsx)(e.code,{children:"docker-distribution"})," \u662f\u670d\u52a1"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"/usr/share/doc/*"}),"\uff1a\u6240\u6709\u6587\u6863"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"/var/lib/registry"}),"\uff1a\u955c\u50cf\u7684\u4fdd\u5b58\u76ee\u5f55"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u542f\u52a8\u79c1\u6709\u955c\u50cf\u4e2d\u5fc3\uff1a",(0,i.jsx)(e.code,{children:"systemctl start docker-distribution"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["docker\u5ba2\u6237\u7aef\u7684 ",(0,i.jsx)(e.strong,{children:"\u63a8\u9001"})," \u64cd\u4f5c\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u4fee\u6539 ",(0,i.jsx)(e.code,{children:"daemon.json"})," \u6587\u4ef6\uff08\u2190 docker\u5ba2\u6237\u7aef\u91c7\u7528HTTPS\u53d1\u9001\u8bf7\u6c42\uff0c\u800c\u79c1\u6709\u955c\u50cf\u4e2d\u5fc3\u9ed8\u8ba4\u4e0d\u652f\u6301HTTPS\u534f\u8bae\uff09\uff1a\u6dfb\u52a0 ",(0,i.jsx)(e.code,{children:'"insecure-registries": [<ip>:<port>]'})]}),"\n",(0,i.jsxs)(e.li,{children:["\u767b\u5f55\u79c1\u6709\u955c\u50cf\u4e2d\u5fc3\uff1a",(0,i.jsx)(e.code,{children:"docker login <ip>:<port>"})]}),"\n",(0,i.jsx)(e.li,{children:"\u5bf9\u955c\u50cf\u91cd\u547d\u540d\uff0c\u5e76\u63a8\u9001\u81f3\u79c1\u6709\u955c\u50cf\u4e2d\u5fc3"}),"\n",(0,i.jsxs)(e.li,{children:["\u67e5\u770b\u955c\u50cf\u4e2d\u5fc3\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u67e5\u770b\u4ed3\u5e93\u5217\u8868\uff1a",(0,i.jsx)(e.code,{children:"curl -XGET http://<ip>:<port>/v2/_catalog"})]}),"\n",(0,i.jsxs)(e.li,{children:["\u67e5\u770b\u6307\u5b9a\u4ed3\u5e93\u7684tag\u5217\u8868\uff1a",(0,i.jsx)(e.code,{children:"curl -XGET http://<ip>:<port>/v2/<repository>/tags/list"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u767b\u51fa\u79c1\u6709\u955c\u50cf\u4e2d\u5fc3\uff1a",(0,i.jsx)(e.code,{children:"docker logout <ip>:<port>"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["docker\u5ba2\u6237\u7aef\u7684 ",(0,i.jsx)(e.strong,{children:"\u5220\u9664"})," \u64cd\u4f5c\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u4fee\u6539\u914d\u7f6e\u6587\u4ef6 ",(0,i.jsx)(e.code,{children:"config.yml"}),"\uff1a\u6dfb\u52a0 ",(0,i.jsx)(e.code,{children:"storage.delete.enabled=true"})]}),"\n",(0,i.jsxs)(e.li,{children:["\u83b7\u53d6\u955c\u50cfdigest\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"\u4e0b\u8f7d\u955c\u50cf\u5230\u672c\u5730\uff0c\u518d\u901a\u8fc7\u547d\u4ee4\u83b7\u53d6"}),"\n",(0,i.jsxs)(e.li,{children:["\u901a\u8fc7HTTP\u8bf7\u6c42\u8bbf\u95ee\u955c\u50cf\u4e2d\u5fc3\u83b7\u53d6\uff1a","\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",metastring:"showLineNumbers",children:'curl --header "Accept:application/vnd.docker.distribution.manifest.v2+json"\n-I -XGET http://<ip>:<port>/v2/<repository>/manifests/<tag>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u5220\u9664\u955c\u50cf\uff1a",(0,i.jsx)(e.code,{children:"curl -I -XDELETE http://<ip>:<port>/v2/<repository>/manifests/<image-digest>"})]}),"\n",(0,i.jsxs)(e.li,{children:["\u6e05\u7406\u5df2\u88ab\u5220\u9664\u7684\u955c\u50cf\u5269\u4e0b\u7684\u5783\u573e\u6570\u636e\uff1a",(0,i.jsx)(e.code,{children:"registry garbage-collect /etc/docker-distribution/registry/config.yml"})]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"114-registry\u79c1\u6709\u955c\u50cf\u4e2d\u5fc3",children:"11.4 registry\u79c1\u6709\u955c\u50cf\u4e2d\u5fc3"}),"\n",(0,i.jsx)(e.h4,{id:"1141-http",children:"11.4.1 HTTP"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u642d\u5efa\u79c1\u6709\u955c\u50cf\u4e2d\u5fc3\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u62c9\u53d6\u955c\u50cf\uff1a",(0,i.jsx)(e.code,{children:"docker pull registry"})]}),"\n",(0,i.jsxs)(e.li,{children:["\u4f7f\u7528 ",(0,i.jsx)(e.code,{children:"htpasswd"})," \u547d\u4ee4\u521b\u5efa\u7528\u6237\u540d\u4e0e\u5bc6\u7801"]}),"\n",(0,i.jsxs)(e.li,{children:["\u542f\u52a8\u79c1\u6709\u955c\u50cf\u4e2d\u5fc3\uff1a","\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",metastring:"showLineNumbers",children:'docker run --name <image-name> \\\n--restart always \\\n-V /var/lib/registry:/var/lib/registry \\\n-V /usr/local/auth:/auth \\\n-e "REGISTRY_AUTH=htpasswd" \\\n-e "REGISTRY_AUTH_HTPASSWD_REALM=Registry Realm" \\\n-e "REGISTRY_AUTH_HTPASSWD_PATH=/auth/htpasswd.user" \\\n-dp 5000:5000 registry\n'})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["docker\u5ba2\u6237\u7aef\u7684\u63a8\u9001\u3001\u5220\u9664\u64cd\u4f5c\uff1a\u540c ",(0,i.jsx)(e.a,{href:"#113-distribution%E7%A7%81%E6%9C%89%E9%95%9C%E5%83%8F%E4%B8%AD%E5%BF%83",children:"distribution\u79c1\u6709\u955c\u50cf\u4e2d\u5fc3"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"\u767b\u5f55\u65f6\u9700\u8981\u8f93\u5165\u7528\u6237\u540d\u548c\u5bc6\u7801"}),"\n",(0,i.jsxs)(e.li,{children:["\u53d1\u9001HTTP\u8bf7\u6c42\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"\u6d4f\u89c8\u5668\u8bbf\u95ee\uff1a\u51fa\u73b0\u767b\u5f55\u5f39\u7a97\uff0c\u8f93\u5165\u7528\u6237\u540d\u548c\u5bc6\u7801\u5373\u53ef"}),"\n",(0,i.jsxs)(e.li,{children:["curl\u8bf7\u6c42\uff1a\u6dfb\u52a0 ",(0,i.jsx)(e.code,{children:"-u <username>:<password>"})]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h4,{id:"1142-https",children:"11.4.2 HTTPS"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["OpenSSL\u751f\u6210\u8bc1\u4e66\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u5b89\u88c5OpenSSL\uff1a",(0,i.jsx)(e.code,{children:"yum install -y openssl-devel"})]}),"\n",(0,i.jsx)(e.li,{children:"\u521b\u5efa\u8bc1\u4e66\u76ee\u5f55"}),"\n",(0,i.jsxs)(e.li,{children:["\u521b\u5efa\u8bc1\u4e66\u4e2d\u5fc3\u7684CA\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u521b\u5efaCA\u7684 ",(0,i.jsx)(e.strong,{children:"\u79c1\u94a5"}),"\uff1a",(0,i.jsx)(e.code,{children:"openssl genrsa -out <key-file> <rsa-bit>"})]}),"\n",(0,i.jsxs)(e.li,{children:["\u521b\u5efaCA\u7684 ",(0,i.jsx)(e.strong,{children:"\u8bc1\u4e66"}),"\uff1a","\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",metastring:"showLineNumbers",children:'openssl req -x509 -new -nodes -sha512 -days <day> \\\n-subj "/C=CN/ST=Beijing/L=Beijing/O=CA/OU=CAUnit/CN=cacn.com" \\\n-key <key-file> \\\n-out <crt-file>\n'})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"-x509"}),"\uff1a\u751f\u6210\u4e00\u4e2a\u81ea\u7b7e\u540d\u7684X.509\u8bc1\u4e66"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"-new"}),"\uff1a\u751f\u6210\u4e00\u4e2a\u65b0\u7684\u8bc1\u4e66\u8bf7\u6c42"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"-nodes"}),"\uff1a\u5728\u751f\u6210\u79c1\u94a5\u65f6\u4e0d\u52a0\u5bc6"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"-sha512"}),"\uff1a\u4f7f\u7528 ",(0,i.jsx)(e.code,{children:"SHA-512"})," \u52a0\u5bc6\u7b97\u6cd5"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"-days"}),"\uff1a\u6307\u5b9a\u8bc1\u4e66\u7684\u6709\u6548\u671f"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"-subj"}),"\uff1a\u6307\u5b9a\u8bc1\u4e66\u7684\u4e3b\u9898\uff0c\u5305\u542b\u56fd\u5bb6Country\uff08C\uff09\u3001\u7701\u4efdState\uff08ST\uff09\u3001\u57ce\u5e02Locality\uff08L\uff09\u3001\u7ec4\u7ec7Organization\uff08O\uff09\u3001\u7ec4\u7ec7\u5355\u4f4dOrganizational Unit\uff08OU\uff09\u3001\u901a\u7528\u540d\u79f0Common Name\uff08CN\uff09"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u521b\u5efa\u7533\u8bf7\u8005\u8bc1\u4e66\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u751f\u6210\u7533\u8bf7\u8005\u8bc1\u4e66\u7684 ",(0,i.jsx)(e.strong,{children:"\u79c1\u94a5"})]}),"\n",(0,i.jsxs)(e.li,{children:["\u751f\u6210\u8bf7\u6c42\u6587\u4ef6\uff08\u5373\u8bc1\u4e66\u4e2d\u7684\u7533\u8bf7\u8005\u4fe1\u606f\uff09\uff1a",(0,i.jsx)(e.code,{children:"openssl req -new -sha512 -key <key-file> -out <csr-file>"})]}),"\n",(0,i.jsxs)(e.li,{children:["\u751f\u6210 ",(0,i.jsx)(e.code,{children:"v3.ext"})," \u6587\u4ef6\uff1a","\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",metastring:"showLineNumbers",children:"cat > v3.ext <<-EOF\nauthorityKeyIdentifier=keyid, issuer\nbasicConstraints=CA:FALSE\nkeyUsage=digitalSignature, nonRepudiation, keyEncipherment, dataEncipherment\nextendedKeyUsage=serverAuth\nsubjectAltName=IP: 192.168.192.111\n\n[alt_names]\nDNS.1=xxx.com\nDNS.2=xxx.cn\nEOF\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u751f\u6210\u7533\u8bf7\u8005 ",(0,i.jsx)(e.strong,{children:"\u8bc1\u4e66"}),"\uff1a","\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",metastring:"showLineNumbers",children:"openssl x509 -req -sha512 -days <day> \\\n-extfile v3.ext \\\n-CA <ca-crt-file> -CAkey <ca-key-file> -CAcreateserial \\\n-in <csr-file> \\\n-out <cert-file>\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u91cd\u547d\u540d\u7533\u8bf7\u8005\u8bc1\u4e66\uff1a",(0,i.jsx)(e.code,{children:"openssl x509 -inform PEM -in <old-cert-file> -out <new-cert-file>"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["docker\u5c06 ",(0,i.jsx)(e.code,{children:".crt"})," \u6587\u4ef6\u8bc6\u522b\u6210CA\u8bc1\u4e66"]}),"\n",(0,i.jsxs)(e.li,{children:["docker\u5c06 ",(0,i.jsx)(e.code,{children:".cert"})," \u6587\u4ef6\u8bc6\u522b\u6210\u7533\u8bf7\u8005\u8bc1\u4e66"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u914d\u7f6e\u4e3b\u673a\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u590d\u5236\u7533\u8bf7\u8005\u8bc1\u4e66\u548c\u79c1\u94a5\uff1a\u63d0\u524d\u521b\u5efa ",(0,i.jsx)(e.code,{children:"/etc/docker/certs.d/<domain-name>"})," \u76ee\u5f55"]}),"\n",(0,i.jsx)(e.li,{children:"\u590d\u5236CA\u8bc1\u4e66"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.li,{children:"\u91cd\u542fdocker"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u642d\u5efa\u79c1\u6709\u955c\u50cf\u4e2d\u5fc3\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u62c9\u53d6\u955c\u50cf\uff1a",(0,i.jsx)(e.code,{children:"docker pull registry"})]}),"\n",(0,i.jsxs)(e.li,{children:["\u4f7f\u7528 ",(0,i.jsx)(e.code,{children:"htpasswd"})," \u547d\u4ee4\u521b\u5efa\u7528\u6237\u540d\u4e0e\u5bc6\u7801"]}),"\n",(0,i.jsxs)(e.li,{children:["\u542f\u52a8\u79c1\u6709\u955c\u50cf\u4e2d\u5fc3\uff1a","\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",metastring:"showLineNumbers",children:'docker run --name <image-name> \\\n--restart always \\\n-v /etc/docker/certs.d/xxx.com:/cert \\\n-V /var/lib/registry:/var/lib/registry \\\n-V /usr/local/auth:/auth \\\n-e "REGISTRY_HTTP_TLS_CERTIFICATE=/cert/xxx.com.cert" \\\n-e "REGISTRY_HTTP_TLS_KEY=/cert/xxx.com.key" \\\n-e "REGISTRY_AUTH=htpasswd" \\\n-e "REGISTRY_AUTH_HTPASSWD_REALM=Registry Realm" \\\n-e "REGISTRY_AUTH_HTPASSWD_PATH=/auth/htpasswd.user" \\\n-dp 5000:5000 registry\n'})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["docker\u5ba2\u6237\u7aef\u7684\u63a8\u9001\u3001\u5220\u9664\u64cd\u4f5c\uff1a\u540c ",(0,i.jsx)(e.a,{href:"#1141-http",children:"registry\u79c1\u6709\u955c\u50cf\u4e2d\u5fc3\u7684HTTP\u8bf7\u6c42"})]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"115-harbor\u79c1\u6709\u955c\u50cf\u4e2d\u5fc3",children:"11.5 harbor\u79c1\u6709\u955c\u50cf\u4e2d\u5fc3"}),"\n",(0,i.jsx)(e.h4,{id:"1151-\u6982\u8ff0",children:"11.5.1 \u6982\u8ff0"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["Harbor\uff1aRegistry Server\u5f00\u6e90\u9879\u76ee\uff0c\u5728Docker Registry\u7684\u57fa\u7840\u4e4b\u4e0a\u8fdb\u884c\u4e86\u4e8c\u6b21\u5c01\u88c5","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"\u786c\u4ef6\u8981\u6c42\uff1a2\u6838\u30014G\u5185\u5b58\u300140G\u78c1\u76d8\u7a7a\u95f4"}),"\n",(0,i.jsx)(e.li,{children:"\u8f6f\u4ef6\u8981\u6c42\uff1aDocker CE\u5f15\u64ce\u3001Docker Compose\u3001OpenSSL"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u67b6\u6784\u6a21\u5757\uff1a",(0,i.jsx)(e.img,{alt:"Harbor Architecture",src:s(4454).A+"",width:"2312",height:"1162"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"Proxy\uff1a\u53cd\u5411\u4ee3\u7406\u670d\u52a1\u5668\uff08\u91c7\u7528Nginx\uff09\uff0c\u63a5\u6536\u5e76\u5c06\u4e0d\u540c\u7684\u8bf7\u6c42\u8f6c\u53d1\u81f3Core\u6216Registry\u6a21\u5757"}),"\n",(0,i.jsxs)(e.li,{children:["Core\uff1a\u6838\u5fc3\u6a21\u5757","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"Notification Manager\uff1a\u901a\u8fc7webhook\u5b9e\u73b0\u7684\u6d88\u606f\u7ba1\u7406\uff0c\u4f1a\u5c06registry\u4e2d\u7684\u955c\u50cf\u53d8\u5316\u901a\u77e5\u5230web\u9875\u9762"}),"\n",(0,i.jsxs)(e.li,{children:["API Server\uff1a\u63a5\u6536\u6765\u81eaProxy\u6a21\u5757\u7684\u8bf7\u6c42\uff0c\u5e76\u5f3a\u5236\u5bf9\u8bf7\u6c42\u8fdb\u884c\u6743\u9650\u63a7\u5236","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"AUTH\u6a21\u5757\uff1a\u901a\u8fc7token service\u5b9e\u73b0\u7528\u6237\u8ba4\u8bc1\uff0c\u9700\u8981\u8bf7\u6c42\u5148\u4ece\u672c\u6a21\u5757\u83b7\u53d6\u5230\u4e0d\u540c\u8eab\u4efd\u7684\u6709\u6548token"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.li,{children:"GC Collector\uff1a\u5783\u573e\u56de\u6536\u7ba1\u7406"}),"\n",(0,i.jsx)(e.li,{children:"Chart Museum\uff1aHelm\u7684\u4ed3\u5e93"}),"\n",(0,i.jsx)(e.li,{children:"Notary\uff1a\u6570\u636e\u6743\u9650\u63a7\u5236\u5668"}),"\n",(0,i.jsx)(e.li,{children:"Log Collector\uff1a\u65e5\u5fd7\u6c47\u603b"}),"\n",(0,i.jsx)(e.li,{children:"Job Service\uff1a\u955c\u50cf\u590d\u5236\uff08\u5728Harbor\u96c6\u7fa4\u4e2d\uff0c\u5c06\u672c\u5730\u955c\u50cf\u540c\u6b65\u5230\u8fdc\u7a0b\u5b9e\u4f8b\u4e0a\uff09"}),"\n",(0,i.jsx)(e.li,{children:"Distribution\uff1a\u955c\u50cf\u4e2d\u5fc3"}),"\n",(0,i.jsx)(e.li,{children:"k-v storage\uff1a\u4e3aJob Service\u6a21\u5757\u63d0\u4f9b\u7f13\u5b58\u670d\u52a1\uff08\u91c7\u7528Redis\uff09"}),"\n",(0,i.jsx)(e.li,{children:"Local/Remote Storage\uff1a\u5c06\u6570\u636e\u5b58\u653e\u5728\u5185\u5b58\u5757\u3001\u6587\u4ef6\u6216\u6301\u4e45\u5316\u5bf9\u8c61\u4e2d"}),"\n",(0,i.jsx)(e.li,{children:"SQL Database\uff1a\u5b58\u653e\u5de5\u7a0b\u5143\u6570\u636e\u3001\u7528\u6237\u6570\u636e\u3001\u89d2\u8272\u6570\u636e\u3001\u540c\u6b65\u7b56\u7565\u4ee5\u53ca\u955c\u50cf\u5143\u6570\u636e\u7b49\uff08\u91c7\u7528PostgreSQL\uff09"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker login"})," \u547d\u4ee4\u6267\u884c\u6d41\u7a0b\uff1a","\n",(0,i.jsx)(e.mermaid,{value:"sequenceDiagram\nactor user as \u7528\u6237\nparticipant docker as Docker\u5ba2\u6237\u7aef\nparticipant proxy as Harbor<br/>Proxy\u6a21\u5757\nparticipant core as Harbor<br/>Core\u6a21\u5757/registry\u5bb9\u5668\nparticipant token as Harbor<br/>Core\u6a21\u5757\u7684token service\n\nuser->>docker: \u8f93\u5165 docker login \u547d\u4ee4\ndocker->>proxy: \u53d1\u9001\u767b\u5f55\u8bf7\u6c42\nproxy->>core: \u8f6c\u53d1\u8bf7\u6c42\ncore--\x3e>docker: \u8fd4\u56de\u5305\u542b401\u72b6\u6001\u7801\u7684\u54cd\u5e94<br/>\u643a\u5e26\u7740token service\u7684url\u548cHarbor\u516c\u94a5\ndocker--\x3e>user: \u51fa\u73b0\u7528\u6237\u540d\u548c\u5bc6\u7801\u7684\u4ea4\u4e92\u8f93\u5165\u6846\nuser->>docker: \u8f93\u5165\u7528\u6237\u540d\u548c\u5bc6\u7801\ndocker->>proxy: \u7528Harbor\u516c\u94a5\u5bf9\u7528\u6237\u540d\u548c\u5bc6\u7801\u52a0\u5bc6<br/>\u5e76\u5411\u6307\u5b9aurl\uff08token service\uff09\u53d1\u9001\u8bf7\u6c42\nproxy->>token: \u8f6c\u53d1\u8bf7\u6c42\ntoken->>token: \u7528Harbor\u79c1\u94a5\u5bf9\u7528\u6237\u540d\u548c\u5bc6\u7801\u89e3\u5bc6<br/>\u5b8c\u6210\u7528\u6237\u8ba4\u8bc1\ntoken--\x3e>docker: \u8fd4\u56de\u5305\u542b\u8ba4\u8bc1\u6210\u529f\u72b6\u6001\u7801\u7684\u54cd\u5e94<br/>\u643a\u5e26\u7740\u7528Harbor\u79c1\u94a5\u6570\u5b57\u7b7e\u540d\u540e\u7684token\ndocker->>docker: \u7528Harbor\u516c\u94a5\u5bf9token\u8fdb\u884c\u7b7e\u540d\u9a8c\u8bc1\nalt \u9a8c\u8bc1\u901a\u8fc7\n    docker--\x3e>user: \u8fd4\u56de\u767b\u5f55\u7ed3\u679c\nend\nalt \u767b\u5f55\u6210\u529f\n    docker->>docker: \u7528Harbor\u516c\u94a5\u5bf9\u7528\u6237\u540d\u548c\u5bc6\u7801\u52a0\u5bc6\u540e\uff0c\u4fdd\u5b58\u5230\u9690\u85cf\u6587\u4ef6\u4e2d\nend"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker push"})," \u547d\u4ee4\u6267\u884c\u6d41\u7a0b\uff1a","\n",(0,i.jsx)(e.mermaid,{value:"sequenceDiagram\nactor user as \u7528\u6237\nparticipant docker as Docker\u5ba2\u6237\u7aef\nparticipant proxy as Harbor<br/>Proxy\u6a21\u5757\nparticipant core as Harbor<br/>Core\u6a21\u5757/registry\u5bb9\u5668\nparticipant token as Harbor<br/>Core\u6a21\u5757\u7684token service\n\nuser->>docker: \u8f93\u5165 docker push \u547d\u4ee4\ndocker->>proxy: \u53d1\u9001push\u8bf7\u6c42\nproxy->>core: \u8f6c\u53d1\u8bf7\u6c42\ncore--\x3e>docker: \u8fd4\u56de\u5305\u542b401\u72b6\u6001\u7801\u7684\u54cd\u5e94<br/>\u643a\u5e26\u7740token service\u7684url\u548cHarbor\u516c\u94a5\ndocker->>proxy: \u643a\u5e26\u7740\u4ece\u9690\u85cf\u6587\u4ef6\u4e2d\u8bfb\u53d6\u5230\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801\u3001push\u64cd\u4f5c\u6570\u636e<br/>\u5e76\u5411\u6307\u5b9aurl\uff08token service\uff09\u53d1\u9001\u8bf7\u6c42\nproxy->>token: \u8f6c\u53d1\u8bf7\u6c42\ntoken->>token: \u7528Harbor\u79c1\u94a5\u5bf9\u7528\u6237\u540d\u548c\u5bc6\u7801\u89e3\u5bc6<br/>\u786e\u8ba4\u7528\u6237\u7684\u89d2\u8272\u548c\u6743\u9650\nalt \u7528\u6237\u5177\u5907\u5bf9\u64cd\u4f5c\u4ed3\u5e93\u7684push\u6743\u9650\n    token--\x3e>docker: \u8fd4\u56de\u54cd\u5e94<br/>\u643a\u5e26\u7740\u5305\u542bpush\u64cd\u4f5c\u6570\u636e\u548c\u6570\u5b57\u7b7e\u540d\u7684token\nend\ndocker->>proxy: \u643a\u5e26\u7740token\u518d\u6b21\u53d1\u9001\u8bf7\u6c42\nproxy->>core: \u8f6c\u53d1\u8bf7\u6c42\ncore->>core: \u7528Harbor\u516c\u94a5\u5bf9token\u8fdb\u884c\u7b7e\u540d\u9a8c\u8bc1\nalt \u9a8c\u8bc1\u901a\u8fc7\n    core--\x3e>docker: \u5f00\u59cb\u4f20\u8f93\u955c\u50cf\u6570\u636e\nend"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h4,{id:"1152-http",children:"11.5.2 HTTP"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u642d\u5efa\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"\u4e0b\u8f7d\u5e76\u89e3\u538b"}),"\n",(0,i.jsxs)(e.li,{children:["\u4fee\u6539 ",(0,i.jsx)(e.code,{children:"harbor.yml"})," \u914d\u7f6e\u6587\u4ef6\uff1a\u590d\u5236\u5e76\u91cd\u547d\u540d ",(0,i.jsx)(e.code,{children:"harbor.yml.tmpl"})," \u6587\u4ef6","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:"hostname: <ip>"})}),"\n",(0,i.jsxs)(e.li,{children:["\u6ce8\u91ca\u4e0e ",(0,i.jsx)(e.code,{children:"https"})," \u76f8\u5173\u7684\u6240\u6709\u914d\u7f6e"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"harbor_admin_password: <password>"}),"\uff1a\u8bb0\u4f4f\u6216\u4fee\u6539\u5bc6\u7801"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"http.port: 80"}),"\uff1a\u9ed8\u8ba4\u7aef\u53e3\u4e3a80"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u8fd0\u884c ",(0,i.jsx)(e.code,{children:"./prepare"})," \u547d\u4ee4\uff1a\u62c9\u53d6prepare\u955c\u50cf\u5e76\u751f\u6210\u914d\u7f6e\u6587\u4ef6"]}),"\n",(0,i.jsxs)(e.li,{children:["\u8fd0\u884c ",(0,i.jsx)(e.code,{children:"./install.sh"})," \u547d\u4ee4\uff1a\u81ea\u52a8\u5b8c\u6210\u5b89\u88c5\uff0c\u5e76\u542f\u52a8\u7531docker-compose\u7f16\u6392\u7ba1\u7406\u7684\u5bb9\u5668\uff08\u540e\u7eed\u5747\u7528 ",(0,i.jsx)(e.code,{children:"docker-compose"})," \u547d\u4ee4\u6765\u542f\u505c\u5bb9\u5668\uff09"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["docker\u5ba2\u6237\u7aef\u7684\u63a8\u9001\u3001\u5220\u9664\u64cd\u4f5c\uff1a\u540c ",(0,i.jsx)(e.a,{href:"#1141-http",children:"registry\u79c1\u6709\u955c\u50cf\u4e2d\u5fc3\u7684HTTP\u8bf7\u6c42"})]}),"\n"]}),"\n",(0,i.jsx)(e.h4,{id:"1153-https",children:"11.5.3 HTTPS"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u963f\u91cc\u4e91\u7533\u8bf7SSL\u8bc1\u4e66\uff1a\u7533\u8bf7\u6210\u529f\u540e\uff0c\u53ef\u6839\u636e\u670d\u52a1\u5668\u7684\u7c7b\u578b\u8fdb\u884c\u4e0b\u8f7d\u8bc1\u4e66\u538b\u7f29\u5305\uff08\u5305\u542b ",(0,i.jsx)(e.code,{children:".pem"})," \u8bc1\u4e66\u6587\u4ef6\u548c ",(0,i.jsx)(e.code,{children:".key"})," \u79c1\u94a5\u6587\u4ef6\uff09"]}),"\n",(0,i.jsxs)(e.li,{children:["\u642d\u5efa\uff1a\u540c ",(0,i.jsx)(e.a,{href:"#1152-http",children:"harbor\u79c1\u6709\u955c\u50cf\u4e2d\u5fc3\u7684\u642d\u5efa\u8fc7\u7a0b"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u4fee\u6539 ",(0,i.jsx)(e.code,{children:"harbor.yml"})," \u914d\u7f6e\u6587\u4ef6\uff1a\u4fee\u6539 ",(0,i.jsx)(e.code,{children:"https"})," \u7684\u76f8\u5173\u914d\u7f6e","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:"https.certificate: <pem-file>"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:"https.private_key: <key-file>"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["docker\u5ba2\u6237\u7aef\u7684\u63a8\u9001\u3001\u5220\u9664\u64cd\u4f5c\uff1a\u540c ",(0,i.jsx)(e.a,{href:"#1141-http",children:"registry\u79c1\u6709\u955c\u50cf\u4e2d\u5fc3\u7684HTTP\u8bf7\u6c42"})]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"12-docker-swarm",children:"12 Docker Swarm"}),"\n",(0,i.jsx)(e.h3,{id:"121-\u6982\u8ff0",children:"12.1 \u6982\u8ff0"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"Docker Swarm\uff1aDocker\u539f\u751f\u96c6\u7fa4\u7ba1\u7406\u7cfb\u7edf\uff0c\u4f1a\u5c06\u591a\u4e2aDocker\u4e3b\u673a\uff08\u7269\u7406\uff09\u7ec4\u7ec7\u6210\u4e00\u4e2aDocker\u4e3b\u673a\uff08\u865a\u62df\uff09\uff0c\u901a\u8fc7API\u4e0e\u96c6\u7fa4\u901a\u4fe1"}),"\n",(0,i.jsxs)(e.li,{children:["\u8282\u70b9\u67b6\u6784\uff1a",(0,i.jsx)(e.img,{alt:"How swarm node works",src:s(6139).A+"",width:"1527",height:"560"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["Swarm Node\uff1a\u91c7\u7528Swarm\u6a21\u5f0f\u8fd0\u884c\u7684Docker Engine\u4e3b\u673a","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u4e00\u4e2anode\u5bf9\u5e94\u4e00\u4e2a\u4e3b\u673a\uff0c\u4e00\u4e2a\u4e3b\u673a\u53ef\u5bf9\u5e94 ",(0,i.jsx)(e.strong,{children:"\u591a\u4e2anode"})]}),"\n",(0,i.jsxs)(e.li,{children:["\u7c7b\u578b\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"Manager\uff1a\u7ef4\u62a4\u96c6\u7fa4\u72b6\u6001\u3001\u8c03\u8bd5service\u3001\u5904\u7406\u96c6\u7fa4\u7ba1\u7406\u4efb\u52a1\uff0c\u901a\u8fc7Raft\u7b97\u6cd5\u7ef4\u62a4\u4e00\u81f4\u6027"}),"\n",(0,i.jsx)(e.li,{children:"Worker\uff1a\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u89d2\u8272\u8f6c\u6362\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"\u8282\u70b9\u964d\u7ea7\uff1aManager \u2192 Worker"}),"\n",(0,i.jsx)(e.li,{children:"\u8282\u70b9\u5347\u7ea7\uff1aWorker \u2192 Manager"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u670d\u52a1\u67b6\u6784\uff1a",(0,i.jsx)(e.code,{children:"service"})," \u901a\u8fc7 ",(0,i.jsx)(e.code,{children:"task"})," \u7684\u5f62\u5f0f\u90e8\u7f72\u5728swarm\u7684\u5404\u4e2anode\u4e2d\uff0c\u800c ",(0,i.jsx)(e.code,{children:"task"})," \u53c8\u901a\u8fc7\u8fd0\u884c\u7740\u5e94\u7528\u8fdb\u7a0b\u7684 ",(0,i.jsx)(e.code,{children:"container"})," \u5bf9\u5916\u63d0\u4f9b\u670d\u52a1",(0,i.jsx)(e.br,{}),"\n",(0,i.jsx)(e.img,{alt:"How services work",src:s(3188).A+"",width:"775",height:"592"}),"\n",(0,i.jsx)(e.img,{alt:"Service Lifecycle",src:s(1010).A+"",width:"905",height:"750"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u7f16\u6392\u5668 ",(0,i.jsx)(e.code,{children:"orchestrator"}),"\uff1a\u7ba1\u7406\u526f\u672c\u4efb\u52a1\u7684\u521b\u5efa\u548c\u505c\u6b62","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u521b\u5efa ",(0,i.jsx)(e.code,{children:"task"}),"\uff1a\u5206\u914d ",(0,i.jsx)(e.code,{children:"taskID"}),"\uff0c\u5e76\u901a\u8fc7\u5206\u914d\u5668\u6765\u5206\u914d\u865a\u62dfIP\uff0c\u518d\u5c06\u5176\u6ce8\u518c\u5230\u5185\u7f6eDNS\u4e2d"]}),"\n",(0,i.jsxs)(e.li,{children:["\u505c\u6b62 ",(0,i.jsx)(e.code,{children:"task"}),"\uff1a\u5728\u5185\u7f6eDNS\u4e2d\u6ce8\u9500"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u5206\u914d\u5668 ",(0,i.jsx)(e.code,{children:"allocator"}),"\uff1a\u8c03\u5ea6\u3001\u76d1\u542c\u526f\u672c\u4efb\u52a1\uff1b\u82e5\u5bb9\u5668\u5904\u4e8e\u4e0d\u53ef\u7528\u6216\u7ec8\u6b62\u72b6\u6001\uff0c\u5219\u7531\u7f16\u6392\u5668\u5148\u5220\u540e\u589e\uff0c\u4fdd\u6301\u526f\u672c\u4efb\u52a1\u6570\u91cf","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u8c03\u5ea6\uff1a\u5728\u96c6\u7fa4\u7684\u8282\u70b9\u4e2d\u627e\u5230 ",(0,i.jsx)(e.code,{children:"available node"}),"\uff0c\u5e76\u5c06 ",(0,i.jsx)(e.code,{children:"task"})," \u5206\u914d\u7ed9 ",(0,i.jsx)(e.code,{children:"node"}),"\uff0c\u540c\u65f6\u4f1a\u7ed9 ",(0,i.jsx)(e.code,{children:"task"})," \u5206\u914d\u4e00\u4e2a\u5bb9\u5668"]}),"\n",(0,i.jsx)(e.li,{children:"\u76d1\u542c\uff1a\u76d1\u6d4b\u5bb9\u5668\u7684\u8fd0\u884c\u72b6\u6001"}),"\n",(0,i.jsx)(e.li,{children:"\u5bf9\u8bf7\u6c42\u8d1f\u8f7d\u5747\u8861"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u670d\u52a1\u90e8\u7f72\u6a21\u5f0f\uff1a",(0,i.jsx)(e.img,{alt:"Replicated VS Global",src:s(4228).A+"",width:"775",height:"552"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"replicated"})," \u526f\u672c\u6a21\u5f0f\uff1a\uff08\u9ed8\u8ba4\u90e8\u7f72\u6a21\u5f0f\uff09\u6307\u5b9a ",(0,i.jsx)(e.code,{children:"task"})," \u6570\u91cf\uff0c\u4e3a ",(0,i.jsx)(e.code,{children:"available node"})," \u5206\u914d ",(0,i.jsx)(e.strong,{children:"\u4e00\u4e2a\u6216\u591a\u4e2a"})," ",(0,i.jsx)(e.code,{children:"task"})]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"global"})," \u5168\u5c40\u6a21\u5f0f\uff1a\u4e0d\u80fd\u6307\u5b9a ",(0,i.jsx)(e.code,{children:"task"})," \u6570\u91cf\uff0c\u9ed8\u8ba4\u4e3a\u6bcf\u4e2a ",(0,i.jsx)(e.code,{children:"node"})," \u5206\u914d ",(0,i.jsx)(e.strong,{children:"\u4e00\u4e2a"})," ",(0,i.jsx)(e.code,{children:"task"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["Raft\u7b97\u6cd5\uff1a",(0,i.jsx)(e.a,{href:"https://thesecretlivesofdata.com/raft/",children:"\u52a8\u753b\u6f14\u793a"})]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"122-\u64cd\u4f5cswarm\u96c6\u7fa4",children:"12.2 \u64cd\u4f5cSwarm\u96c6\u7fa4"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u642d\u5efa\u96c6\u7fa4\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"Swarm: inactive/active"}),"\uff1a\u7528 ",(0,i.jsx)(e.code,{children:"docker info"})," \u547d\u4ee4\u67e5\u770bdocker\u7684swarm\u6fc0\u6d3b\u72b6\u6001"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker swarm init"}),"\uff1a\u521d\u59cb\u5316swarm\u96c6\u7fa4\uff0c\u4f1a\u63d0\u4f9b\u6dfb\u52a0worker/manager\u8282\u70b9\u7684\u547d\u4ee4","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker swarm join --token <worker/manager-token> <leader-manager-ip>:<leader-manager-port>"}),"\uff1a\u6dfb\u52a0\u8282\u70b9"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker swarm join-token worker/manager"}),"\uff1a\u83b7\u53d6\u6dfb\u52a0\u8282\u70b9\u7684 ",(0,i.jsx)(e.strong,{children:"token"})]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker node ls"}),"\uff1a\u67e5\u770b\u5f53\u524dswarm\u96c6\u7fa4\u7684\u8282\u70b9\u72b6\u6001\u4fe1\u606f\uff0c\u4ec5manager\u8282\u70b9\u53ef\u7528"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u7ef4\u62a4\u96c6\u7fa4\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u8282\u70b9\u9000\u51fa\u96c6\u7fa4\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"worker"})," \u8282\u70b9\uff1a",(0,i.jsx)(e.code,{children:"docker swarm leave"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u8282\u70b9\u7684\u72b6\u6001 ",(0,i.jsx)(e.code,{children:"STATUS"})," \u4f1a\u53d8\u4e3a ",(0,i.jsx)(e.code,{children:"Down"})]}),"\n",(0,i.jsxs)(e.li,{children:["\u91cd\u65b0\u52a0\u5165\u96c6\u7fa4\u540e\uff0c\u4f1a\u65b0\u589e\u4e00\u4e2a\u65b0\u7684 ",(0,i.jsx)(e.code,{children:"worker"})," \u8282\u70b9\uff0c\u800c\u539f\u8282\u70b9\u4ecd\u5b58\u5728"]}),"\n",(0,i.jsxs)(e.li,{children:["\u5220\u9664Down\u72b6\u6001\u7684 ",(0,i.jsx)(e.code,{children:"worker"})," \u8282\u70b9\uff1a",(0,i.jsx)(e.code,{children:"docker node rm <node-id>"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"manager"})," \u8282\u70b9\uff1a",(0,i.jsx)(e.code,{children:"docker swarm leave --force"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u9000\u51fa\u96c6\u7fa4\u4f1a\u5bfc\u81f4swarm\u96c6\u7fa4\u7684\u4e00\u81f4\u6027\u53d7\u5230\u635f\u574f"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u81ea\u52a8\u9501\u5b9a\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker swarm update --autolock=true"}),"\uff1a\u5f00\u542f\u96c6\u7fa4\u7684\u81ea\u52a8\u9501\u5b9a\u529f\u80fd \u2192 \u542f\u7528TLS\u52a0\u5bc6 ",(0,i.jsx)(e.code,{children:"manager"})," \u95f4\u7684\u901a\u4fe1\uff0c\u907f\u514d\u7ef4\u62a4 ",(0,i.jsx)(e.code,{children:"manager"})," \u6570\u636e\u4e00\u81f4\u6027\u7684Raft\u65e5\u5fd7\u6709\u88ab\u653b\u51fb\u7684\u98ce\u9669"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker swarm unlock-key"}),"\uff1a\u67e5\u770b\u89e3\u9501\u5bc6\u94a5\uff08\u5bc6\u94a5\u5747\u7ef4\u62a4\u5728\u8282\u70b9\u7684docker\u7f13\u5b58\u4e2d\uff1b\u4e00\u65e6\u8282\u70b9\u7684docker\u91cd\u542f\uff0c\u5219\u5bc6\u94a5\u4f1a\u4e22\u5931\uff09"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker swarm unlock"})," \u5e76\u8f93\u5165\u89e3\u9501\u5bc6\u94a5\uff1a\u89e3\u9501swarm\uff0c\u91cd\u542f\u7684node\u624d\u80fd\u91cd\u65b0\u52a0\u5165swarm\u96c6\u7fa4"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u7ef4\u62a4\u8282\u70b9\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u89d2\u8272\u8f6c\u6362\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"worker"})," \u5347\u7ea7\u4e3a ",(0,i.jsx)(e.code,{children:"manager"}),"\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:"docker node promote <node-id>"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:"docker node update --role manager <node-id/hostname>"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"manager"})," \u964d\u7ea7\u4e3a ",(0,i.jsx)(e.code,{children:"worker"}),"\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:"docker node demote <node-id>"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:"docker node update --role worker <node-id/hostname>"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u8282\u70b9\u6807\u7b7e\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker node update --label-add <key>=<value>"}),"\uff1a\u6dfb\u52a0/\u4fee\u6539\u6807\u7b7e"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker node update --label-rm <key>"}),"\uff1a\u5220\u9664\u6807\u7b7e"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u5220\u9664\u8282\u70b9\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u82e5\u4e3a ",(0,i.jsx)(e.code,{children:"manager"})," \u8282\u70b9\uff0c\u5219\u9700\u5148\u964d\u7ea7\u4e3a ",(0,i.jsx)(e.code,{children:"worker"})," \u8282\u70b9"]}),"\n",(0,i.jsxs)(e.li,{children:["\u5173\u95ed\u8282\u70b9\u7684docker \u2192 \u8282\u70b9\u53d8\u4e3a ",(0,i.jsx)(e.code,{children:"Down"}),"\u72b6\u6001"]}),"\n",(0,i.jsxs)(e.li,{children:["\u6267\u884c ",(0,i.jsx)(e.code,{children:"docker node rm <node-id>"})," \u547d\u4ee4\u5220\u9664\u8282\u70b9"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u5220\u9664\u8282\u70b9\u548c\u9000\u51fa\u96c6\u7fa4\u7684\u533a\u522b\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker node rm -f"}),"\uff1a\u4f7f\u8282\u70b9\u5f3a\u5236\u9000\u7fa4"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker swarm leave"}),"\uff1a\u4f7fdocker\u4e3b\u673a\u5173\u95edswarm\u6a21\u5f0f"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u516c\u94a5\u57fa\u7840\u8bbe\u65bdPKI\uff08Public Key Infrastructure\uff09\uff1a\u4fdd\u969c\u8282\u70b9\u7684\u5b89\u5168","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["TLS\uff1a\u4fdd\u969c\u8282\u70b9\u95f4\u6388\u6743\u548c\u901a\u4fe1\u7684\u5b89\u5168","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u8282\u70b9\u52a0\u5165swarm\u96c6\u7fa4\uff1a","\n",(0,i.jsx)(e.mermaid,{value:"sequenceDiagram\nparticipant node as \u8981\u52a0\u5165\u96c6\u7fa4\u7684worker/manager\u8282\u70b9\nparticipant manager\nautonumber\nmanager--\x3e>node: \u751f\u6210\u5305\u542bCA\u6839\u8bc1\u4e66\u7684digest\u548c\u968f\u673a\u5bc6\u94a5\u7684token\nnode->>node: \u89e3\u6790token\u83b7\u5f97CA\u6839\u8bc1\u4e66\u7684digest\u548c\u968f\u673a\u5bc6\u94a5\nnode->>node: \u751f\u6210\u8282\u70b9ID\nnode->>node: \u4f7f\u7528\u968f\u673a\u5bc6\u94a5\u52a0\u5bc6\u8282\u70b9ID\nnode->>manager: \u53d1\u9001\u8bf7\u6c42<br/>\u5305\u542b\uff1a\u8282\u70b9ID\uff08\u660e\u6587+\u5bc6\u6587\uff09\u3001\u8282\u70b9\u89d2\u8272\u3001CA\u6839\u8bc1\u4e66\u7684digest\nmanager->>manager: \u6839\u636eCA\u6839\u8bc1\u4e66\u7684digest\u9a8c\u8bc1\u7528\u6237\u5408\u6cd5\u6027\nmanager->>manager: \u4f7f\u7528\u672c\u5730\u7684\u8282\u70b9\u89d2\u8272\u5bf9\u5e94\u7684\u5bc6\u94a5\u5bf9\u8282\u70b9ID\u5bc6\u6587\u89e3\u5bc6\nmanager->>manager: \u5bf9\u6bd4\u89e3\u5bc6\u7ed3\u679c\u548c\u8282\u70b9ID\u660e\u6587\uff0c\u5224\u65ad\u4fe1\u606f\u662f\u5426\u5b89\u5168\nalt \u4fe1\u606f\u5b89\u5168\n    manager->>manager: \u5c06\u8282\u70b9\u52a0\u5165\u96c6\u7fa4\n    manager--\x3e>node: \u53d1\u9001\u52a0\u5165\u6210\u529f\u7684\u901a\u77e5\n    node->>node: \u63a5\u6536\u5e76\u89e3\u6790\u901a\u77e5\uff0c\u4fee\u6539\u8282\u70b9\u4fe1\u606f\nend"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u8282\u70b9\u901a\u4fe1\uff1a","\n",(0,i.jsx)(e.mermaid,{value:"sequenceDiagram\nparticipant nodeA\nparticipant nodeB\nautonumber\nnodeA->>nodeB: \u53d1\u9001 \u5efa\u7acb\u8fde\u63a5 \u8bf7\u6c42<br/>\u643a\u5e26\u8282\u70b9ID\nnodeB->>nodeB: \u4fdd\u5b58\u8282\u70b9\u5730\u5740\u548cID\nnodeB--\x3e>nodeA: \u8fd4\u56de CA\u6839\u8bc1\u4e66\u7684digest \u54cd\u5e94\nnodeA->>nodeA: \u5bf9\u6bd4\u672c\u5730\u548c\u54cd\u5e94\u7684digest\uff0c\u5224\u65ad\u901a\u4fe1\u5bf9\u65b9\u7684\u5408\u6cd5\u6027\nalt \u5408\u6cd5\u7684\u901a\u4fe1\u5bf9\u65b9\n    nodeA->>nodeA: \u4f7f\u7528\u968f\u673a\u5bc6\u94a5\u52a0\u5bc6\u6570\u636e\n    nodeA->>nodeB: \u53d1\u9001\u8bf7\u6c42<br/>\u5305\u542b\uff1a\u6570\u636e\uff08\u660e\u6587+\u5bc6\u6587\uff09\n    nodeB->>nodeB: \u4f7f\u7528\u968f\u673a\u5bc6\u94a5\u89e3\u5bc6\u6570\u636e\u5bc6\u6587\n    nodeB->>nodeB: \u5bf9\u6bd4\u89e3\u5bc6\u7ed3\u679c\u548c\u6570\u636e\u660e\u6587\uff0c\u5224\u65ad\u4fe1\u606f\u662f\u5426\u5b89\u5168\n    alt \u4fe1\u606f\u5b89\u5168\n        nodeB->>nodeB: \u5904\u7406\u6570\u636e\n    end\nend"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["CA\u6570\u5b57\u8bc1\u4e66\u8f6e\u8f6c\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker swarm ca --cert-expiry <duration>"}),"\uff1a\u6307\u5b9a\u8f6e\u6362\u5468\u671f\uff0c\u9ed8\u8ba490\u5929"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker swarm ca --external-ca <ca-file>"}),"\uff1a\u6307\u5b9a\u5916\u90e8CA\u6570\u5b57\u8bc1\u4e66"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker swarm ca --rotate"}),"\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["docker\u751f\u6210\u4e00\u4e2a\u8fc7\u6e21\u6027\u7684 ",(0,i.jsx)(e.strong,{children:"\u4ea4\u53c9\u7b7e\u540d\uff08cross-signed\uff09\u6839\u8bc1\u4e66"}),"\uff0c\u5373\u65b0\u6839\u8bc1\u4e66\u7531\u65e7\u6839\u8bc1\u4e66\u7b7e\u7f72\u751f\u6210"]}),"\n",(0,i.jsx)(e.li,{children:"docker\u901a\u77e5\u6240\u6709\u8282\u70b9\u66f4\u65b0\u6839\u8bc1\u4e66"}),"\n",(0,i.jsx)(e.li,{children:"\u5728\u6240\u6709\u8282\u70b9\u5747\u66f4\u65b0\u5b8c\u6839\u8bc1\u4e66\u540e\uff0cmanager\u4f1a\u901a\u77e5\u6240\u6709\u8282\u70b9\u4ec5\u4fe1\u4efb\u65b0\u6839\u8bc1\u4e66\uff08\u4e0d\u518d\u4fe1\u4efb\u65e7\u6839\u8bc1\u4e66\u548c\u4ea4\u53c9\u7b7e\u540d\u6839\u8bc1\u4e66\uff09"}),"\n",(0,i.jsx)(e.li,{children:"\u6240\u6709\u8282\u70b9\u7528\u65b0\u6839\u8bc1\u4e66\u7b7e\u53d1\u81ea\u5df1\u8282\u70b9\u7684\u6570\u5b57\u8bc1\u4e66"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u96c6\u7fa4\u5bb9\u707e\uff1a","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u91c7\u7528 ",(0,i.jsx)(e.strong,{children:"\u70ed\u5907"})," \u5bb9\u707e\u65b9\u5f0f\uff1a\u5373manager\u96c6\u7fa4\u4e2d\u53ea\u6709\u4e00\u4e2a ",(0,i.jsx)(e.code,{children:"leader"})," \u8282\u70b9\uff0c\u5176\u5b83manager\u5904\u4e8e\u70ed\u5907\u72b6\u6001\uff1b\u82e5 ",(0,i.jsx)(e.code,{children:"leader"})," \u5b95\u673a\uff0c\u5219manager\u96c6\u7fa4\u4e2d\u81ea\u52a8\u53d1\u8d77leader\u9009\u4e3e"]}),"\n",(0,i.jsxs)(e.li,{children:["\u91c7\u7528 ",(0,i.jsx)(e.strong,{children:"Raft\u7b97\u6cd5"})," \u6765\u8fdb\u884cleader\u9009\u4e3e\uff1a\u6240\u6709\u53ef\u7528\u7684manager\u8282\u70b9\u5747\u5177\u6709\u9009\u4e3e\u6743\u548c\u88ab\u9009\u4e3e\u6743\uff0c\u83b7\u5f97\u8fc7\u534a\u9009\u7968\u7684manager\u8282\u70b9\u6210\u4e3a\u65b0\u7684 ",(0,i.jsx)(e.code,{children:"leader"}),"\uff08\u63a8\u8350\u90e8\u7f72\u5947\u6570\u4e2amanager\uff09"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"123-service",children:"12.3 service"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"service\u53ea\u80fd\u4f9d\u9644\u4e8eswarm\u96c6\u7fa4"}),"\n",(0,i.jsxs)(e.li,{children:["\u521b\u5efaservice\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker service create --name <service-name> --replicas <task-number> -p <host-port>:<container-port> <image-name>"}),"\uff1a\u7531manager\u6267\u884c"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker service ls"}),"\uff1a\u67e5\u770b\u5f53\u524dswarm\u96c6\u7fa4\u4e2d\u6b63\u5728\u8fd0\u884c\u7684service\u4fe1\u606f"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker service inspect <service-id|service-name>"}),"\uff1a\u67e5\u770b\u6307\u5b9aservice\u7684\u8be6\u60c5"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker service ps <service-id|service-name>"}),"\uff1a\u67e5\u770b\u6307\u5b9aservice\u7684\u5404\u4e2atask\u5206\u914d\u7684\u8282\u70b9\u4fe1\u606f"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker node ps <node-name>"}),"\uff1a\u67e5\u770b\u6307\u5b9a\u8282\u70b9\u4e2d\u6b63\u5728\u8fd0\u884c\u7684task\u4fe1\u606f"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker service logs <service-id|service-name|task-id>"}),"\uff1a\u67e5\u770bservice/task\u65e5\u5fd7"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u8d1f\u8f7d\u5747\u8861\uff1aservice\u4e2d\u5305\u542b\u591a\u4e2atask\u65f6\uff0c\u4f1a\u901a\u8fc7 ",(0,i.jsx)(e.strong,{children:"\u8f6e\u8be2"})," \u7b56\u7565\uff08\u53ef\u901a\u8fc7Nginx\u3001HAProxy\u7b49\u53d8\u66f4\uff09\u7684\u8d1f\u8f7d\u5747\u8861\u65b9\u5f0f\u8f6c\u53d1\u7ed9\u5404\u4e2atask\u5904\u7406"]}),"\n",(0,i.jsxs)(e.li,{children:["\u64cd\u4f5c\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["task\u4f38\u7f29\uff1a\u6839\u636e\u8bbf\u95ee\u91cf\uff0c\u5728\u4e0d\u505c\u6b62\u670d\u52a1\u7684\u524d\u63d0\u4e0b\u5bf9\u670d\u52a1\u7684task\u8fdb\u884c\u6269\u5bb9/\u7f29\u5bb9","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u53d8\u66f4\u6307\u5b9a\u670d\u52a1\u7684task\u6570\u91cf\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:"docker service update --replicas <task-number> <service-name>"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:"docker service scale <service-name>=<task-number>"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u6682\u505c\u5bf9\u8282\u70b9\u5206\u914dtask\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker node update --availability pause <node-name>"}),"\uff1a\u4fee\u6539\u8282\u70b9\u7684\u53ef\u7528\u6027 \u2192 \u8282\u70b9\u4e2d\u7684task\u6570\u91cf\u4fdd\u6301\u4e0d\u53d8"]}),"\n",(0,i.jsx)(e.li,{children:"\u6269\u5bb9task\u6570\u91cf"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u6e05\u7a7atask\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker node update --availability drain <node-name>"}),"\uff1a\u4fee\u6539\u8282\u70b9\u7684\u53ef\u7528\u6027 \u2192 \u6e05\u7a7a\u8282\u70b9\u4e2d\u7684task"]}),"\n",(0,i.jsx)(e.li,{children:"\u4e0d\u5f71\u54cd\u670d\u52a1\u7684task\u603b\u6570\uff0c\u88ab\u6e05\u7a7a\u7684task\u5c06\u88ab\u5206\u914d\u5668\u5206\u914d\u5230\u5176\u4ed6\u53ef\u7528\u8282\u70b9\u4e0a"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.li,{children:"task\u5bb9\u9519\uff1a\u5f53task\u6240\u5728\u7684\u5bb9\u5668\u51fa\u73b0\u95ee\u9898\u65f6\uff0c\u7f16\u6392\u5668\u4f1a\u81ea\u52a8\u65b0\u5efa\u540c\u6837\u7684task\uff0c\u518d\u7531\u5206\u914d\u5668\u5206\u914d\u5230\u53ef\u7528\u8282\u70b9\u4e0a"}),"\n",(0,i.jsxs)(e.li,{children:["\u5220\u9664\u670d\u52a1\uff1a",(0,i.jsx)(e.code,{children:"docker service rm <service-id|service-name>"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5220\u9664\u6240\u6709\u5173\u8054\u7684task"}),"\n",(0,i.jsx)(e.li,{children:"\u5220\u9664task\u76f8\u5173\u7684\u5bb9\u5668"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u6eda\u52a8\u66f4\u65b0\uff1a\u66f4\u65b0\u548c\u56de\u6eda\u64cd\u4f5c\u5747\u4f1a\u65b0\u5efatask\uff0c\u66f4\u65b0\u65f6task\u4f1a\u5206\u914d\u56de\u539f\u8282\u70b9\u3001\u56de\u6eda\u65f6task\u4f1a\u88ab\u91cd\u65b0\u5206\u914d","\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",metastring:"showLineNumbers",children:"docker service create \\\n...\n--update-parallelism <parallelism-update-task-number> \\\n--update-delay <update-delay-time> \\\n--update-max-failure-ratio <max-failure-ratio> \\\n--update-failure-action <update-failure-action> \\\n--rollback-parallelism <parallelism-rollback-task-number> \\\n--rollback-delay <rollback-delay-time> \\\n--rollback-max-failure-ratio <max-failure-ratio> \\\n--rollback-failure-action <rollback-failure-action> \\\n"})}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u5347\u7ea7\u955c\u50cf\uff1a",(0,i.jsx)(e.code,{children:"docker service update --image <image-name> <service-name>"})]}),"\n",(0,i.jsxs)(e.li,{children:["\u6bcf\u6b21\u66f4\u65b0 ",(0,i.jsx)(e.code,{children:"<parallelism-update-task-number>"})," \u4e2atask\uff0c\u66f4\u65b0\u95f4\u9694\u4e3a ",(0,i.jsx)(e.code,{children:"<update-delay-time>"}),"\uff0c\u66f4\u65b0\u5931\u8d25\u65f6\u6267\u884c ",(0,i.jsx)(e.code,{children:"<update-failure-action>"})]}),"\n",(0,i.jsxs)(e.li,{children:["\u66f4\u65b0\u56de\u6eda\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"\u6309\u7167\u8bbe\u5b9a\u7684\u56de\u6eda\u7b56\u7565\u81ea\u52a8\u56de\u6eda"}),"\n",(0,i.jsxs)(e.li,{children:["\u624b\u52a8\u56de\u6eda\uff1a",(0,i.jsx)(e.code,{children:"docker service update --rollback <service-name>"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u6bcf\u6b21\u56de\u6eda ",(0,i.jsx)(e.code,{children:"<parallelism-rollback-task-number>"})," \u4e2atask\uff0c\u56de\u6eda\u95f4\u9694\u4e3a ",(0,i.jsx)(e.code,{children:"<rollback-delay-time>"})]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u5168\u5c40\u90e8\u7f72\u6a21\u5f0f\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u521b\u5efa\u670d\u52a1\uff1a",(0,i.jsx)(e.code,{children:"docker service create --name <service-name> --mode global <image-name>"})]}),"\n",(0,i.jsx)(e.li,{children:"task\u4f38\u7f29\uff1a\u6539\u53d8service\u6240\u4f9d\u9644\u7684swarm\u96c6\u7fa4\u4e2d\u7684\u8282\u70b9\u6570\u91cf \u2192 \u8282\u70b9\u4e2d\u7684task\u6570\u91cf\u4f1a\u81ea\u52a8\u6269\u5bb9/\u7f29\u5bb9"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"124-overlay\u7f51\u7edc",children:"12.4 overlay\u7f51\u7edc"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"overlay\u7f51\u7edc/\u91cd\u53e0\u7f51\u7edc/\u8986\u76d6\u7f51\u7edc\uff1a\u6784\u5efa\u5728underlay\u7f51\u7edc\u4e0a\u7684\u903b\u8f91\u865a\u62df\u7f51\u7edc\uff0c\u5373\u5728\u7269\u7406\u7f51\u7edc\u7684\u57fa\u7840\u4e0a\uff0c\u901a\u8fc7\u8282\u70b9\u95f4\u7684\u5355\u64ad\u96a7\u9053\u673a\u5236\u5c06\u4e3b\u673a\u4e24\u4e24\u76f8\u8fde"}),"\n",(0,i.jsxs)(e.li,{children:["swarm\u96c6\u7fa4\u7684overlay\u7f51\u7edc\u6a21\u578b\uff1a",(0,i.jsx)(e.img,{alt:"overlay",src:s(1567).A+"",width:"1086",height:"579"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u7ed3\u6784\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker_gwbridge"})," \u7f51\u7edc\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"\u7f51\u5173\uff1a\u4f4d\u4e8e\u5bbf\u4e3b\u673a\u4e0a\uff0c\u4e14\u540c\u540d"}),"\n",(0,i.jsx)(e.li,{children:"task\u5bb9\u5668"}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"ingress-sbox"})," \u5bb9\u5668\uff1a\u7531overlay\u7f51\u7edc\u865a\u62df\u51fa\u6765\u7684\u5bb9\u5668\uff0c\u65e0\u6cd5\u901a\u8fc7 ",(0,i.jsx)(e.code,{children:"docker ps"})," \u547d\u4ee4\u67e5\u770b","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"nsenter --net=/var/run/docker/netns/ingress_sbox ip a"}),"\uff1a\u8fdb\u5165\u7f51\u7edc\u547d\u540d\u7a7a\u95f4\uff0c\u67e5\u770b ",(0,i.jsx)(e.code,{children:"ingress-sbox"})," \u5bb9\u5668\u7684\u63a5\u53e3\u60c5\u51b5"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"ingress"})," \u7f51\u7edc\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"br0"})," \u7f51\u5173\uff1a\u4f4d\u4e8e\u5bbf\u4e3b\u673a\u4e0a","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"nsenter --net=/var/run/docker/netns/<br0-network-name> ip a"}),"\uff1a\u8fdb\u5165\u7f51\u7edc\u547d\u540d\u7a7a\u95f4\uff0c\u67e5\u770b\u5bb9\u5668\u7684\u63a5\u53e3\u60c5\u51b5"]}),"\n",(0,i.jsxs)(e.li,{children:["\u4e0e ",(0,i.jsx)(e.code,{children:"docker_gwbridge"})," \u7f51\u5173\u7684\u63a5\u53e3\u60c5\u51b5\u76f8\u6bd4\uff0c\u591a\u51fa\u4e86 ",(0,i.jsx)(e.code,{children:"vxlan0"})," \u63a5\u53e3"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["task\u5bb9\u5668\uff1a\u548c ",(0,i.jsx)(e.code,{children:"docker_gwbridge"})," \u7f51\u7edc\u4e2d\u7684\u5bb9\u5668\u76f8\u540c"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"ingress-sbox"})," \u5bb9\u5668\uff1a\u548c ",(0,i.jsx)(e.code,{children:"docker_gwbridge"})," \u7f51\u7edc\u4e2d\u7684\u5bb9\u5668\u76f8\u540c"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u8fd0\u884c\u6d41\u7a0b\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u8bf7\u6c42\u5148\u5230\u8fbe ",(0,i.jsx)(e.strong,{children:"docker_gwbridge\u7f51\u5173"}),"\uff08\u5bbf\u4e3b\u673a\u7684NAT\uff09","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"ip route"}),"\uff1a\u67e5\u770b\u5bbf\u4e3b\u673a\u7684\u9759\u6001\u8def\u7531\u4fe1\u606f"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"iptables -nvL -t nat"}),"\uff1a\u67e5\u770b\u5bbf\u4e3b\u673a\u4e2d\u7684\u7f51\u7edc\u5730\u5740\u8f6c\u53d1\u8868\uff08",(0,i.jsx)(e.strong,{children:"NAT"}),"\uff1a\u6839\u636e\u89c4\u5219\u8fdb\u884c\u5730\u5740\u6620\u5c04\u3001\u7aef\u53e3\u6620\u5c04 \u2192 \u5b8c\u6210\u5730\u5740\u8f6c\u6362\uff09\u4e2d\u7684\u8f6c\u53d1\u89c4\u5219"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u8df3\u8f6c\u81f3 ",(0,i.jsx)(e.strong,{children:"ingress-sbox\u5bb9\u5668"}),"\uff08\u5177\u6709\u5f53\u524dservice\u4e0b\u7684\u6240\u6709\u5bb9\u5668IP\uff09\uff0c\u901a\u8fc7\u8f6e\u8be2\u7b56\u7565\u7684\u8d1f\u8f7d\u5747\u8861\u65b9\u5f0f\u9009\u62e9\u4e00\u4e2a\u5bb9\u5668IP\u4f5c\u4e3a\u76ee\u6807\u5730\u5740","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"nsenter --net=/var/run/docker/netns/ingress_sbox iptables -nvL -t mangle"}),"\uff1a\u67e5\u770b ",(0,i.jsx)(e.code,{children:"ingress-sbox"})," \u5bb9\u5668\u7684mangle\u8868\uff08\u6839\u636e\u89c4\u5219\u4fee\u6539\u6570\u636e\u5305\u7684\u6807\u5fd7\u4f4d\uff09"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"nsenter --net=/var/run/docker/netns/ingress_sbox ipvsadm"}),"\uff1a\u67e5\u770b ",(0,i.jsx)(e.code,{children:"ingress-sbox"})," \u5bb9\u5668\u7684\u8d1f\u8f7d\u5747\u8861\u89c4\u5219","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"FWM <symbol> rr"}),"\uff1a\u9632\u706b\u5899\u6807\u8bc6\uff08Fire Wall Mark\uff09\uff0c\u5e76\u91c7\u53d6\u8f6e\u8be2\u7b56\u7565\uff08Round Robin\uff09"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u8df3\u8f6c\u81f3 ",(0,i.jsx)(e.strong,{children:"br0\u7f51\u5173"}),"\uff0c\u5224\u65ad\u76ee\u6807\u5730\u5740\u7684\u6240\u5728\u4e3b\u673a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"\u82e5\u76ee\u6807\u5730\u5740\u4e3a\u672c\u5730\u5bb9\u5668IP\uff0c\u5219\u76f4\u63a5\u5c06\u8bf7\u6c42\u8f6c\u53d1\u7ed9\u76ee\u6807\u5bb9\u5668\u5904\u7406\u5373\u53ef"}),"\n",(0,i.jsxs)(e.li,{children:["\u82e5\u76ee\u6807\u5730\u5740\u4e3a\u8fdc\u7a0b\u5bb9\u5668IP\uff0c\u5219\u5c06\u8bf7\u6c42\u7ecf\u7531 ",(0,i.jsx)(e.strong,{children:"vxlan\u63a5\u53e3"})," \u3001\u901a\u8fc7vxlan\u96a7\u9053\u6280\u672f\u8f6c\u53d1\u81f3\u76ee\u6807\u4e3b\u673a\u7684 ",(0,i.jsx)(e.strong,{children:"br0\u7f51\u5173"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"tcpdump -i <interface> port <host-port>"}),"\uff1a\u76d1\u542c\u6307\u5b9a\u63a5\u53e3"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["VXLAN\u96a7\u9053\u6280\u672f\uff1a\u91cd\u65b0\u5c01\u88c5\u4e0d\u540c\u534f\u8bae\u7684\u6570\u636e\u5305\u540e\u518d\u53d1\u9001","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u96a7\u9053\uff1a\u88ab\u5c01\u88c5\u7684\u6570\u636e\u5305\u5728\u516c\u5171\u4e92\u8054\u7f51\u4e0a\u4f20\u9012\u65f6\u7ecf\u8fc7\u7684\u903b\u8f91\u8def\u5f84"}),"\n",(0,i.jsx)(e.li,{children:"\u88ab\u5c01\u88c5\u7684\u6570\u636e\u5305\u5305\u542b\u8def\u7531\u4fe1\u606f\uff0c\u901a\u8fc7\u96a7\u9053\u5230\u8fbe\u7ec8\u70b9\u540e\uff0c\u4f1a\u5bf9\u6570\u636e\u89e3\u5305\u5e76\u8f6c\u53d1\u5230\u6700\u7ec8\u76ee\u7684\u5730"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"13-cicd\u4e0ejenkins",children:"13 CI/CD\u4e0eJenkins"}),"\n",(0,i.jsx)(e.h3,{id:"131-\u6982\u8ff0",children:"13.1 \u6982\u8ff0"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["CI/CD\uff1a",(0,i.jsx)(e.img,{alt:"CI/CD",src:s(2071).A+"",width:"582",height:"283"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"CI\uff08Continuous Integration\uff09"}),"\uff1a\u6301\u7eed\u96c6\u6210\uff0c\u5373\u6301\u7eed\u4e0d\u65ad\u5730\u5c06\u66f4\u65b0\u7684\u4ee3\u7801\u7ecf\u6784\u5efa\u3001\u6d4b\u8bd5\u540e\u96c6\u6210\u5230\u9879\u76ee\u4e3b\u7ebf"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"CD\uff08Continuous Delivery/Deployment\uff09"}),"\uff1a\u6301\u7eed\u4ea4\u4ed8/\u90e8\u7f72\uff0c\u5373\u6301\u7eed\u4e0d\u65ad\u5730\u5c06\u65b0\u7248\u672c\u4ea4\u4ed8\u5230\u7c7b\u751f\u4ea7\u73af\u5883/\u90e8\u7f72\u81f3\u751f\u4ea7\u73af\u5883"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"DevOps\uff08Development & Operations\uff09"}),"\uff1a\u4e00\u79cd\u7ba1\u7406\u6a21\u5f0f\u3001\u6267\u884c\u89c4\u8303\u4e0e\u6807\u51c6\uff0c\u4e3b\u8981\u7528\u4e8e\u4fc3\u8fdb\u5f00\u53d1\u3001\u6d4b\u8bd5\u4e0e\u8fd0\u7ef4\u90e8\u95e8\u95f4\u7684\u6c9f\u901a\u3001\u534f\u4f5c\u4e0e\u6574\u5408\n",(0,i.jsx)(e.img,{alt:"Devops",src:s(3170).A+"",width:"1242",height:"639"})]}),"\n",(0,i.jsx)(e.li,{children:"CI/CD\u4e0eDevOps\u7684\u5173\u7cfb\uff1aCI/CD\u662f\u76ee\u6807\uff0cDevOps\u662f\u624b\u6bb5"}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"132-\u5e94\u7528\u5b9e\u73b0",children:"13.2 \u5e94\u7528\u5b9e\u73b0"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u7cfb\u7edf\u7ed3\u6784\u56fe\uff1a",(0,i.jsx)(e.img,{alt:"CI/CD Structure",src:s(4346).A+"",width:"883",height:"352"})]}),"\n",(0,i.jsxs)(e.li,{children:["\u5de5\u5177\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"Git\uff1a\u5f00\u6e90\u7684\u5206\u5e03\u5f0f\u7248\u672c\u63a7\u5236\u7cfb\u7edf"}),"\n",(0,i.jsx)(e.li,{children:"GitLab\uff1a\u5f00\u6e90\u7684\u6e90\u7801\u6258\u7ba1\u5de5\u5177"}),"\n",(0,i.jsx)(e.li,{children:"SonarQube\uff1a\u5f00\u6e90\u7684\u4ee3\u7801\u626b\u63cf\u4e0e\u5206\u6790\u5e73\u53f0"}),"\n",(0,i.jsx)(e.li,{children:"Harbor\uff1a\u5f00\u6e90\u7684\u955c\u50cf\u4ed3\u5e93"}),"\n",(0,i.jsx)(e.li,{children:"Jenkins\uff1a\u5f00\u6e90\u7684\u6301\u7eed\u96c6\u6210\u5de5\u5177"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u96c6\u6210\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"SonarScanner\uff1aSonarQube\u7684\u4ee3\u7801\u626b\u63cf\u5de5\u5177\uff0c\u7528\u4e8eJenkins\u96c6\u6210SonarQube"}),"\n",(0,i.jsxs)(e.li,{children:["\u914d\u7f6e ",(0,i.jsx)(e.code,{children:"SSH Server"}),"\uff1a\u7528\u4e8eJenkins\u96c6\u6210\u76ee\u6807\u670d\u52a1\u5668"]}),"\n",(0,i.jsxs)(e.li,{children:["\u4fee\u6539\u670d\u52a1\u5668\u7684 ",(0,i.jsx)(e.code,{children:"daemon.json"})," \u6587\u4ef6\uff1a\u652f\u6301\u955c\u50cf\u4e2d\u5fc3\u4e0e\u5ba2\u6237\u7aef\u7684HTTP\u901a\u4fe1"]}),"\n",(0,i.jsxs)(e.li,{children:["Jenkins\u5bb9\u5668\u5316\uff1a\u2192 \u80fd\u5728Jenkins\u4e2d\u6784\u5efa\u955c\u50cf","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"DinD\uff08Docker-in-Docker\uff09\uff1a\u5bb9\u5668\u5185\u5b89\u88c5Docker\u5f15\u64ce"}),"\n",(0,i.jsxs)(e.li,{children:["DooD\uff08Docker-outside-of-Docker\uff09\uff1a\u4e0e\u5bbf\u4e3b\u673a\u5171\u4eabDocker\u5f15\u64ce \u2190 \u4fee\u6539 ",(0,i.jsx)(e.code,{children:"docker.sock"})," \u6587\u4ef6\u7684\u8bfb\u5199\u6743\u9650\uff0c\u5e76\u6620\u5c04\u5230\u5bbf\u4e3b\u673a\u4e0a"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.li,{children:"\u9489\u9489\uff1a\u914d\u7f6ewebhook\u5730\u5740\uff0c\u7528\u4e8eJenkins\u96c6\u6210\u9489\u9489\u673a\u5668\u4eba"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u4efb\u52a1\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u81ea\u7531\u98ce\u683c\u7684\u8f6f\u4ef6\u9879\u76ee\uff1a\u7ed3\u5408Jenkins\u529f\u80fd\u7684\u57fa\u7840\u7248\u4efb\u52a1","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["CI\u64cd\u4f5c\u6b65\u9aa4\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"\u5f00\u53d1\u8005\u63d0\u4ea4\u4ee3\u7801\u5230\u8fdc\u7a0b\u7684GitLab\u4ed3\u5e93\u65f6\uff0c\u89e6\u53d1Jenkins\u4efb\u52a1"}),"\n",(0,i.jsx)(e.li,{children:"\u4eceGitLab\u4ed3\u5e93\u62c9\u53d6\u4ee3\u7801"}),"\n",(0,i.jsx)(e.li,{children:"\u8c03\u7528mvn\u547d\u4ee4\u6253jar\u5305"}),"\n",(0,i.jsx)(e.li,{children:"\u8c03\u7528SonarScanner\u8fdb\u884c\u4ee3\u7801\u8d28\u91cf\u68c0\u6d4b"}),"\n",(0,i.jsx)(e.li,{children:"\u6784\u5efa\u955c\u50cf\uff0c\u63a8\u9001\u5230Harbor\u955c\u50cf\u4e2d\u5fc3"}),"\n",(0,i.jsx)(e.li,{children:"\u6267\u884c\u76ee\u6807\u670d\u52a1\u5668\u7684\u90e8\u7f72\u811a\u672c\uff0c\u542f\u52a8\u5bb9\u5668"}),"\n",(0,i.jsx)(e.li,{children:"\u901a\u77e5\u9489\u9489"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.li,{children:"CD\u64cd\u4f5c\uff1a\u6839\u636etag\u6784\u5efa\u5bf9\u5e94\u7684\u9879\u76ee"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u6d41\u6c34\u7ebf\uff1a\u7ec4\u7ec7\u591a\u4e2a\u8282\u70b9\u7684\u8fdb\u9636\u7248\u4efb\u52a1","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u7ef4\u62a4\u811a\u672c\u7684\u65b9\u5f0f\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"\u672c\u5730\u65b9\u5f0f\uff1a\u5728Jenkins\u4e2d\u7ef4\u62a4\u811a\u672c"}),"\n",(0,i.jsxs)(e.li,{children:["SCM\uff08Source Code Management\uff09\u65b9\u5f0f\uff1a","\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u5728\u9879\u76ee\u6839\u76ee\u5f55\u4e0b\u8ffd\u52a0 ",(0,i.jsx)(e.code,{children:"Jenkinsfile"})," \u6587\u4ef6"]}),"\n",(0,i.jsx)(e.li,{children:"Jenkins\u4e2d\u914d\u7f6eSCM\u65b9\u5f0f\u7684\u6d41\u6c34\u7ebf\u811a\u672c"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.li,{children:"\u6d41\u6c34\u7ebf\u8bed\u6cd5\uff1a\u811a\u672c\u8bed\u6cd5\u7279\u6b8a\uff0c\u53ef\u901a\u8fc7Jenkins\u63d0\u4f9b\u7684\u5de5\u5177\u81ea\u52a8\u751f\u6210\u811a\u672c\u8bed\u53e5"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]})]})}function j(n={}){const{wrapper:e}={...(0,l.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(x,{...n})}):x(n)}},3170:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/11.1.devops-1f1cc34d4e6b357f89f6919c8ea3da25.webp"},4454:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/11.10.harbor_architecture-1d1c12129815f93dcbae1f1b8c29b219.png"},6139:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/11.11.how_swarm_node_works-5f567dd000e9aff31e560f32c695b6d9.webp"},3188:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/11.12.how_services_work-bc8a40b325a1bf259b2ec64c7347d291.webp"},1010:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/11.13.service_lifecycle-12de11b4d9dec80867dec7171e8af373.webp"},4228:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/11.14.replicated_vs_global-d5534a3dc5d1e6cbfe1af95d11ba940e.webp"},1567:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/11.15.overlay-53927bf8aa82df6f4ade8ed5ae8df983.jpg"},2071:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/11.16.CICD-73f6a9c25336d7ec7bd2e00a60d96c0a.jpg"},4346:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/11.17.CICD_structure-f195b1340cfbf78371484d9649c968ac.jpg"},2151:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/11.2.apps_run_on_different_system-78652b896f3d49f8beedaf74f30cdeda.jpg"},2205:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/11.3.windows-3b7353041781bdb5c46eb30a059d401f.jpg"},4068:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/11.4.docker_structure-9e263875703c804cd2ea34bd18618fd7.webp"},4387:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/11.5.docker_engine_structure-daa72cb6c6b9956e9d0aede7947f07f2.jpg"},7810:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/11.6.image_layer-2471f8cfaaab1dad09f0d779431e27ca.jpg"},5724:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/11.7.network_namespace-21c35ff280bb8e340e35cd31dad1347a.jpg"},5519:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/11.8.driver-3714e2ecf5c4467172bf7b1cf00d8120.jpg"},4954:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/11.9.docker0_bridge-e52045b00c9b8852bdc3feb8bdbd28c6.jpg"},8453:(n,e,s)=>{s.d(e,{R:()=>c,x:()=>d});var i=s(6540);const l={},r=i.createContext(l);function c(n){const e=i.useContext(r);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function d(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(l):n.components||l:c(n.components),i.createElement(r.Provider,{value:e},n.children)}}}]);